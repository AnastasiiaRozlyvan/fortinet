{
  "workflow": {
    "unique_name": "definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W",
    "name": "Fortinet  - FortiGate - Block URL, IP or Domain",
    "title": "Fortinet  - FortiGate - Block URL, IP or Domain",
    "type": "generic.workflow",
    "base_type": "workflow",
    "variables": [
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Policy Name",
          "type": "datatype.string",
          "description": "Name of the Firewall Policy. Leave this value empty if you want to create a new Firewall Policy.",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01QXHR8UGUKKV3PzLWDz5cd9wfGxZ0M0WBc",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Web Filter Name",
          "type": "datatype.string",
          "description": "The Name of the Web Filter. Leave this value empty if you want to create a new Web Filter.",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01QENLZHPIVVI28kd2INwi2zuZncQeryxQr",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "input",
          "name": "observable_type",
          "type": "datatype.string",
          "description": "Type of object to block.\nThis workflow supports url, ip and domain types.",
          "is_required": true,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01QDUWPO1WE3738QmwiLwBJbXce3agNJ7Kk",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.boolean",
        "properties": {
          "value": false,
          "scope": "local",
          "name": "Web Filter Exists",
          "type": "datatype.boolean",
          "description": "Boolean variable which indicates if a given Web Filter already exists. This will be populated automatically.",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01QXHDTN38KYA2fVPGaarP7pEMBlwNgVqpK",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.secure_string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Access Token",
          "type": "datatype.secure_string",
          "description": "Access Token for FortiGate API.",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01QVNBNH9JTYK3NfHWwhAzXMl4rzC8QLGvm",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "URL Filter MKey",
          "type": "datatype.string",
          "description": "The MKey of the URL Filter. This will be populated automatically.",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01QXHDCQAJHNJ0v4PZklkjvjjbTrjGiY9Bi",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "input",
          "name": "observable_value",
          "type": "datatype.string",
          "description": "The value of the observable to block.",
          "is_required": true,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01QDUWWV8OOA64LdyclajeziyBPSXN0JFIC",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Address Name",
          "type": "datatype.string",
          "description": "The name of the Address. This will be populated automatically.",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01QXEW7YBXKOA67nOxzUyeafXXO7sWUTTyr",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "SXo",
          "scope": "local",
          "name": "Name Prefix",
          "type": "datatype.string",
          "description": "Name Prefix for names of the objects which will be created automatically.",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01QXI76U3FI367PUsYmsAFxcPCIQeY3UVws",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.boolean",
        "properties": {
          "value": false,
          "scope": "local",
          "name": "Wrong Policy Action",
          "type": "datatype.boolean",
          "description": "Indicates if the provided Policy contains the wrong action. This will be populated automatically.",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01QZNHEJDR7FC4pDu5xtcEhXqjDYuHgYhUt",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Address Group Name",
          "type": "datatype.string",
          "description": "The Name of the Address Group to be updated with the provided observable value. Leave this value empty if you want to create a new Address Group.",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01QENMB1Z1RQH358zoMEikzjGBvYRvrdvlA",
        "object_type": "variable_workflow"
      }
    ],
    "properties": {
      "atomic": {
        "is_atomic": false
      },
      "delete_workflow_instance": false,
      "description": "This is a response workflow that:\n- accepts a URL, IP, Domain observables as input\n   For IP and Domain:\n          - creates an Address and Address Group (or reuses existing one if the name was provided)  in FortiGate Firewall\n          - creates a blocking Policy and adds the Address Group to it\n For URL:\n          - creates a Web Filter (or reuses existing one if the name was provided) and URL Filter in FortiGate Firewall\n          - creates a new accepting Policy or reuses the Policy whose name was provided and adds the Web Filter to it\n\nTarget Group: Default TargetGroup\n\nTargets:  FortiGate, Microsoft Teams\n\nSteps: \n[] Generate UUIDs to create unique names\n[] Validate observable type\n[] Creates an Address and Address Group (if IP/Domain)\n[] Creates a Web Filter and URL Filter (if URL)\n[] Create or update Firewall Policy\n[] Move Policy on top of the Policies list\n[] Post message to Microsoft Teams\n\nMore information about this API:  [placeholder]",
      "display_name": "Fortinet  - FortiGate - Block URL, IP or Domain",
      "runtime_user": {
        "target_default": true
      },
      "target": {
        "execute_on_target_group": true,
        "target_group": {
          "target_group_id": "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH",
          "run_on_all_targets": false,
          "selected_target_types": [
            "web-service.endpoint"
          ],
          "use_criteria": {
            "choose_target_using_algorithm": "choose_first_with_matching_criteria",
            "conditions": [
              {
                "operator": "eqi",
                "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                "right_operand": "FortiGate_API"
              }
            ]
          }
        }
      }
    },
    "object_type": "definition_workflow",
    "actions": [
      {
        "unique_name": "definition_activity_01QXI1GGQNAGM5d6nsdblV5UELRhItEnps4",
        "name": "Execute Python Script",
        "title": "Generate UUIDs to create unique names",
        "type": "python3.script",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "continue_on_failure": false,
          "display_name": "Generate UUIDs to create unique names",
          "script": "from sys import argv\nfrom uuid import uuid4\nprefix = argv[1]\naddress_name = f\"{prefix}-Address-{uuid4()}\"\nweb_filter_name = f\"{prefix}-WebFilter-{str(uuid4())[:21]}\"\nurl_filter_name = f\"{prefix}-URLFilter-{str(uuid4())[:21]}\"\npolicy_name = f\"{prefix}-Policy-{str(uuid4())[:23]}\"\naddress_group_name = f\"{prefix}-AddressGroup-{uuid4()}\"",
          "script_arguments": [
            "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QXI76U3FI367PUsYmsAFxcPCIQeY3UVws$"
          ],
          "script_queries": [
            {
              "script_query": "address_name",
              "script_query_name": "Address Name",
              "script_query_type": "string"
            },
            {
              "script_query": "web_filter_name",
              "script_query_name": "Web Filter Name",
              "script_query_type": "string"
            },
            {
              "script_query": "url_filter_name",
              "script_query_name": "URL Filter Name",
              "script_query_type": "string"
            },
            {
              "script_query": "policy_name",
              "script_query_name": "Policy Name",
              "script_query_type": "string"
            },
            {
              "script_query": "address_group_name",
              "script_query_name": "Address Group Name ",
              "script_query_type": "string"
            }
          ],
          "skip_execution": false
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_01RIOAECX3AJW4hO4brPL8stca1aM8otrbw",
        "name": "Execute Python Script",
        "title": "Defang observable",
        "type": "python3.script",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "continue_on_failure": false,
          "display_name": "Defang observable",
          "script": "import sys\nimport json\nobservable_value = sys.argv[1].replace(\".\", \"[.]\")\nobservable_value = observable_value.replace(\"http\", \"hxxp\")",
          "script_arguments": [
            "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWWV8OOA64LdyclajeziyBPSXN0JFIC$"
          ],
          "script_queries": [
            {
              "script_query": "observable_value",
              "script_query_name": "observable_value",
              "script_query_type": "string"
            }
          ],
          "skip_execution": false
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_01QVND6FHZRGU6n8dHiDchlc7ZTfsYGLyqn",
        "name": "Condition Block",
        "title": "Which observable type provided?",
        "type": "logic.if_else",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Which observable type provided?",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "blocks": [
          {
            "unique_name": "definition_activity_01QVND6JB8RMQ12hwBW8jieIaneO0tmO3OA",
            "name": "Condition Branch",
            "title": "IP/Domain",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": {
                  "left_operand": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWPO1WE3738QmwiLwBJbXce3agNJ7Kk$",
                  "operator": "eq",
                  "right_operand": "ip"
                },
                "operator": "or",
                "right_operand": {
                  "left_operand": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWPO1WE3738QmwiLwBJbXce3agNJ7Kk$",
                  "operator": "eq",
                  "right_operand": "domain"
                }
              },
              "continue_on_failure": false,
              "display_name": "IP/Domain",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01QWIFJR9H1MD7kO2icg1PakEesM1SbQCM7",
                "name": "Fortinet - FortiGate - Search for Address by Value",
                "title": "Fortinet - FortiGate - Search for Address by Value",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": true,
                  "display_name": "Fortinet - FortiGate - Search for Address by Value",
                  "input": {
                    "variable_workflow_01QJMY7E7Z0IB2Ed7caVA90mExOvR277l2a": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWWV8OOA64LdyclajeziyBPSXN0JFIC$",
                    "variable_workflow_01QJMY7E7Z34Y31xJWhl8psuGJq9nSwAGQA": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QVNBNH9JTYK3NfHWwhAzXMl4rzC8QLGvm$",
                    "variable_workflow_01QJNP94KKPAD0OwFo8IB6b8carKE0VVqpl": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWPO1WE3738QmwiLwBJbXce3agNJ7Kk$",
                    "variable_workflow_01QJQEPSZM3BE1GcmTTNciS5QqSczLq11G7": "root"
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "use_workflow_target_group": true
                  },
                  "workflow_id": "definition_workflow_01QJMY7EFE9EB0dUuvozT00neDnloTNQN05"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01QXEL2V5S0J54LwkxxJZhMznMjL8qMr98L",
                "name": "Condition Block",
                "title": "Address Found?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Address Found?",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01QXEL30NNUL434Tma8iM7ebL42W0ytKMsL",
                    "name": "Condition Branch",
                    "title": "Yes",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01QWIFJR9H1MD7kO2icg1PakEesM1SbQCM7.output.succeeded$",
                        "operator": "eq",
                        "right_operand": true
                      },
                      "continue_on_failure": false,
                      "display_name": "Yes",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01QXEX9MZ18DV0TovkJV6wIHoBtmhoOI4EI",
                        "name": "Set Variables",
                        "title": "Set Variable Address Name",
                        "type": "core.set_multiple_variables",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Set Variable Address Name",
                          "skip_execution": false,
                          "variables_to_update": [
                            {
                              "variable_to_update": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QXEW7YBXKOA67nOxzUyeafXXO7sWUTTyr$",
                              "variable_value_new": "$activity.definition_activity_01QWIFJR9H1MD7kO2icg1PakEesM1SbQCM7.output.variable_workflow_01QJMY7E7YVSH6zkv5YqG2E3Dy29Ng7fQJP$"
                            }
                          ]
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  },
                  {
                    "unique_name": "definition_activity_01QXEWVOTIA3V4j1xAh7og3kFTXjhadYteM",
                    "name": "Condition Branch",
                    "title": "No",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01QWIFJR9H1MD7kO2icg1PakEesM1SbQCM7.output.succeeded$",
                        "operator": "eq",
                        "right_operand": false
                      },
                      "continue_on_failure": false,
                      "display_name": "No",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01RHZQGMW7KDV3S5DnUarzwth9eF5uWDsXY",
                        "name": "Condition Block",
                        "title": "Critical Error Occurred?",
                        "type": "logic.if_else",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Critical Error Occurred?",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "blocks": [
                          {
                            "unique_name": "definition_activity_01RHZQGU9VCPU7Xu0f9bnx0l3qQCy4xLFVp",
                            "name": "Condition Branch",
                            "title": "Yes",
                            "type": "logic.condition_block",
                            "base_type": "activity",
                            "properties": {
                              "condition": {
                                "left_operand": "$activity.definition_activity_01QWIFJR9H1MD7kO2icg1PakEesM1SbQCM7.output.error.message$",
                                "operator": "mw",
                                "right_operand": "Status Code:"
                              },
                              "continue_on_failure": false,
                              "display_name": "Yes",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01RHZQGV5J7I25K3DwuwIRa4WuPYPRpkzJo",
                                "name": "Microsoft Teams - Post Message via Webhook",
                                "title": "Microsoft Teams - Post Message via Webhook",
                                "type": "workflow.atomic_workflow",
                                "base_type": "subworkflow",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Microsoft Teams - Post Message via Webhook",
                                  "input": {
                                    "variable_workflow_01MRIK9PFIH9457K2ZY1x7rEJvOPzYOE6eO": "MESSAGE FROM Fortinet - FortiGate - Block URL, IP or Domain",
                                    "variable_workflow_01MRIKICJKVS16L5nynmibtyxbFIqwxBhOV": "**\"$activity.definition_activity_01RIOAECX3AJW4hO4brPL8stca1aM8otrbw.output.script_queries.observable_value$\" observable handling failed.**\n\u003cbr/\u003e\n$activity.definition_activity_01QWIFJR9H1MD7kO2icg1PakEesM1SbQCM7.output.error.message$",
                                    "variable_workflow_01MRIL2TKZ8FM1EvIZeO4VFV9ITFhG3vSlI": ""
                                  },
                                  "runtime_user": {
                                    "target_default": true
                                  },
                                  "skip_execution": false,
                                  "target": {
                                    "override_workflow_target_group_criteria": true,
                                    "target_group": {
                                      "run_on_all_targets": false,
                                      "use_criteria": {
                                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                        "conditions": [
                                          {
                                            "left_operand": "$targetgroup.target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH.common.display_name$",
                                            "operator": "eqi",
                                            "right_operand": "Microsoft Teams Webhook"
                                          }
                                        ]
                                      }
                                    }
                                  },
                                  "workflow_id": "definition_workflow_01MRIE3B3DNNQ3cdFSoyGkg1RnVsYA9VdZr"
                                },
                                "object_type": "definition_activity"
                              },
                              {
                                "unique_name": "definition_activity_01RHZQH429Y3U4ov1TR3kLHXipBFCqxNSYr",
                                "name": "Completed",
                                "title": "Failed",
                                "type": "logic.completed",
                                "base_type": "activity",
                                "properties": {
                                  "completion_type": "failed-completed",
                                  "continue_on_failure": false,
                                  "display_name": "Failed",
                                  "result_message": "\"$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWWV8OOA64LdyclajeziyBPSXN0JFIC$\" observable handling failed.\n$activity.definition_activity_01QWIFJR9H1MD7kO2icg1PakEesM1SbQCM7.output.error.message$\n",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity"
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "unique_name": "definition_activity_01QXEWVPSZFV76Fis7RxBKD2jtRhqhyYpic",
                        "name": "Fortinet - FortiGate - Create Address",
                        "title": "Fortinet - FortiGate - Create Address",
                        "type": "workflow.atomic_workflow",
                        "base_type": "subworkflow",
                        "properties": {
                          "continue_on_failure": true,
                          "display_name": "Fortinet - FortiGate - Create Address",
                          "input": {
                            "variable_workflow_01Q8Q3G8HFBBV4bCgPNxr8tNZAdaRIhTchP": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWPO1WE3738QmwiLwBJbXce3agNJ7Kk$",
                            "variable_workflow_01Q8QAOJCFJFX2aDEaoWMl8JIaBJeUoywL6": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWWV8OOA64LdyclajeziyBPSXN0JFIC$",
                            "variable_workflow_01QCRJI0NZEMB0Pm8zeCVQJSI6QGrjOyakn": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QVNBNH9JTYK3NfHWwhAzXMl4rzC8QLGvm$",
                            "variable_workflow_01QYDQME2SLKW7lJPgDsK0aMFMMODvnejqs": "$activity.definition_activity_01QXI1GGQNAGM5d6nsdblV5UELRhItEnps4.output.script_queries.Address Name$",
                            "variable_workflow_01QYE15IBF6Q74dRiYe9StNFoRQ1cIEul1M": "root"
                          },
                          "runtime_user": {
                            "target_default": true
                          },
                          "skip_execution": false,
                          "target": {
                            "use_workflow_target_group": true
                          },
                          "workflow_id": "definition_workflow_01Q2H2423CNMQ55zxmxIlndVdm1FyYI9WvB"
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01RHYPCG7PY3J2otR1hFvT63KliXca2sSof",
                        "name": "Condition Block",
                        "title": "Critical Error Occurred?",
                        "type": "logic.if_else",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Critical Error Occurred?",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "blocks": [
                          {
                            "unique_name": "definition_activity_01RHYPCMVF7EF5aKOOWYGwPjMWp5TsMD9EV",
                            "name": "Condition Branch",
                            "title": "Yes",
                            "type": "logic.condition_block",
                            "base_type": "activity",
                            "properties": {
                              "condition": {
                                "left_operand": "$activity.definition_activity_01QXEWVPSZFV76Fis7RxBKD2jtRhqhyYpic.output.succeeded$",
                                "operator": "eq",
                                "right_operand": false
                              },
                              "continue_on_failure": false,
                              "display_name": "Yes",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01RHYPCNN9AYS1bR9LWGUB3vN5rrcnLJQCO",
                                "name": "Microsoft Teams - Post Message via Webhook",
                                "title": "Microsoft Teams - Post Message via Webhook",
                                "type": "workflow.atomic_workflow",
                                "base_type": "subworkflow",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Microsoft Teams - Post Message via Webhook",
                                  "input": {
                                    "variable_workflow_01MRIK9PFIH9457K2ZY1x7rEJvOPzYOE6eO": "MESSAGE FROM Fortinet - FortiGate - Block URL, IP or Domain",
                                    "variable_workflow_01MRIKICJKVS16L5nynmibtyxbFIqwxBhOV": "**\"$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWWV8OOA64LdyclajeziyBPSXN0JFIC$\" observable handling failed.**\n\u003cbr/\u003e\n$activity.definition_activity_01QXEWVPSZFV76Fis7RxBKD2jtRhqhyYpic.output.error.message$",
                                    "variable_workflow_01MRIL2TKZ8FM1EvIZeO4VFV9ITFhG3vSlI": ""
                                  },
                                  "runtime_user": {
                                    "target_default": true
                                  },
                                  "skip_execution": false,
                                  "target": {
                                    "override_workflow_target_group_criteria": true,
                                    "target_group": {
                                      "run_on_all_targets": false,
                                      "use_criteria": {
                                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                        "conditions": [
                                          {
                                            "left_operand": "$targetgroup.target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH.common.display_name$",
                                            "operator": "eqi",
                                            "right_operand": "Microsoft Teams Webhook"
                                          }
                                        ]
                                      }
                                    }
                                  },
                                  "workflow_id": "definition_workflow_01MRIE3B3DNNQ3cdFSoyGkg1RnVsYA9VdZr"
                                },
                                "object_type": "definition_activity"
                              },
                              {
                                "unique_name": "definition_activity_01RHYPCTWVDZ46WzMBkFUILDmTCoNAFMplU",
                                "name": "Completed",
                                "title": "Failed",
                                "type": "logic.completed",
                                "base_type": "activity",
                                "properties": {
                                  "completion_type": "failed-completed",
                                  "continue_on_failure": false,
                                  "display_name": "Failed",
                                  "result_message": "\"$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWWV8OOA64LdyclajeziyBPSXN0JFIC$\" observable handling failed.\n$activity.definition_activity_01QXEWVPSZFV76Fis7RxBKD2jtRhqhyYpic.output.error.message$",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity"
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "unique_name": "definition_activity_01RHOTSDSCNLE5JTIVnMUgktNV95FBfModC",
                        "name": "Set Variables",
                        "title": "Set Variable Address Name",
                        "type": "core.set_multiple_variables",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Set Variable Address Name",
                          "skip_execution": false,
                          "variables_to_update": [
                            {
                              "variable_to_update": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QXEW7YBXKOA67nOxzUyeafXXO7sWUTTyr$",
                              "variable_value_new": "$activity.definition_activity_01QXEWVPSZFV76Fis7RxBKD2jtRhqhyYpic.output.variable_workflow_01QC9LIOV6YU17SrgFzUqifOESxFzg5ss7d$"
                            }
                          ]
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01QXESWS5MMM34TLZgndSuAWl7JX9q2ZOC8",
                "name": "Condition Block",
                "title": "Address Group Name provided?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": true,
                  "display_name": "Address Group Name provided?",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01QXESWW1NC9L4wwIjB6YF7n6aFq4w1VHeS",
                    "name": "Condition Branch",
                    "title": "Yes",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QENMB1Z1RQH358zoMEikzjGBvYRvrdvlA$",
                        "operator": "ne",
                        "right_operand": ""
                      },
                      "continue_on_failure": false,
                      "display_name": "Yes",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01QXEVAP1OYCX7SC8Rf3fXt0JpGTT0PVNl0",
                        "name": "Fortinet - FortiGate - Add Address to Group",
                        "title": "Fortinet - FortiGate - Add Address to Group",
                        "type": "workflow.atomic_workflow",
                        "base_type": "subworkflow",
                        "properties": {
                          "continue_on_failure": true,
                          "display_name": "Fortinet - FortiGate - Add Address to Group",
                          "input": {
                            "variable_workflow_01QKJSE0EFJ2W31BeDVMJrs1CFizp43DKQr": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QVNBNH9JTYK3NfHWwhAzXMl4rzC8QLGvm$",
                            "variable_workflow_01QKJSE0EFMPQ4ZousJqguiEM0z7cVkN0z4": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QXEW7YBXKOA67nOxzUyeafXXO7sWUTTyr$",
                            "variable_workflow_01QKJSE0EFQL61FRB1WLGyXTIRetH2ohsE4": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QENMB1Z1RQH358zoMEikzjGBvYRvrdvlA$",
                            "variable_workflow_01QKM1ZUG7X301PG75jm0VEKR1SrG6holTq": "root"
                          },
                          "runtime_user": {
                            "target_default": true
                          },
                          "skip_execution": false,
                          "target": {
                            "use_workflow_target_group": true
                          },
                          "workflow_id": "definition_workflow_01QKJSE0LURMP1XIO79isiyUAXKTDDZeCGV"
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01RHPVTIZADMW2fDt3QN3tT6TPh9bDHNIg9",
                        "name": "Condition Block",
                        "title": "Address Group Name found?",
                        "type": "logic.if_else",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Address Group Name found?",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "blocks": [
                          {
                            "unique_name": "definition_activity_01RHPVTMOKDM61T9L6CTYiPZEkh0tSAI2QO",
                            "name": "Condition Branch",
                            "title": "No",
                            "type": "logic.condition_block",
                            "base_type": "activity",
                            "properties": {
                              "condition": {
                                "left_operand": "$activity.definition_activity_01QXEVAP1OYCX7SC8Rf3fXt0JpGTT0PVNl0.output.succeeded$",
                                "operator": "eq",
                                "right_operand": false
                              },
                              "continue_on_failure": false,
                              "display_name": "No",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01RHYQYUI5RPE3aSb3DsYbZUC1Vgv30xNxG",
                                "name": "Condition Block",
                                "title": "Critical Error Occurred?",
                                "type": "logic.if_else",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Critical Error Occurred?",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "blocks": [
                                  {
                                    "unique_name": "definition_activity_01RHYQZ0Z0YXZ2rNW9GARTedmAG25jW2hoh",
                                    "name": "Condition Branch",
                                    "title": "Yes",
                                    "type": "logic.condition_block",
                                    "base_type": "activity",
                                    "properties": {
                                      "condition": {
                                        "left_operand": "$activity.definition_activity_01QXEVAP1OYCX7SC8Rf3fXt0JpGTT0PVNl0.output.error.message$",
                                        "operator": "nmw",
                                        "right_operand": "Status Code:  404"
                                      },
                                      "continue_on_failure": false,
                                      "display_name": "Yes",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "actions": [
                                      {
                                        "unique_name": "definition_activity_01RHYQZ1QJAZH03pAEuAF0uKtUFpJfPffwJ",
                                        "name": "Microsoft Teams - Post Message via Webhook",
                                        "title": "Microsoft Teams - Post Message via Webhook",
                                        "type": "workflow.atomic_workflow",
                                        "base_type": "subworkflow",
                                        "properties": {
                                          "continue_on_failure": false,
                                          "display_name": "Microsoft Teams - Post Message via Webhook",
                                          "input": {
                                            "variable_workflow_01MRIK9PFIH9457K2ZY1x7rEJvOPzYOE6eO": "MESSAGE FROM Fortinet - FortiGate - Block URL, IP or Domain",
                                            "variable_workflow_01MRIKICJKVS16L5nynmibtyxbFIqwxBhOV": "**\"$activity.definition_activity_01RIOAECX3AJW4hO4brPL8stca1aM8otrbw.output.script_queries.observable_value$\" observable handling failed.**\n\u003cbr/\u003e\n$activity.definition_activity_01QXEVAP1OYCX7SC8Rf3fXt0JpGTT0PVNl0.output.error.message$",
                                            "variable_workflow_01MRIL2TKZ8FM1EvIZeO4VFV9ITFhG3vSlI": ""
                                          },
                                          "runtime_user": {
                                            "target_default": true
                                          },
                                          "skip_execution": false,
                                          "target": {
                                            "override_workflow_target_group_criteria": true,
                                            "target_group": {
                                              "run_on_all_targets": false,
                                              "use_criteria": {
                                                "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                                "conditions": [
                                                  {
                                                    "left_operand": "$targetgroup.target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH.common.display_name$",
                                                    "operator": "eqi",
                                                    "right_operand": "Microsoft Teams Webhook"
                                                  }
                                                ]
                                              }
                                            }
                                          },
                                          "workflow_id": "definition_workflow_01MRIE3B3DNNQ3cdFSoyGkg1RnVsYA9VdZr"
                                        },
                                        "object_type": "definition_activity"
                                      },
                                      {
                                        "unique_name": "definition_activity_01RHYQZ7XTSOY54KheGyzWuXDI64d7L5emq",
                                        "name": "Completed",
                                        "title": "Failed",
                                        "type": "logic.completed",
                                        "base_type": "activity",
                                        "properties": {
                                          "completion_type": "failed-completed",
                                          "continue_on_failure": false,
                                          "display_name": "Failed",
                                          "result_message": "\"$activity.definition_activity_01RIOAECX3AJW4hO4brPL8stca1aM8otrbw.output.script_queries.observable_value$\" observable handling failed.\n$activity.definition_activity_01QWIFJR9H1MD7kO2icg1PakEesM1SbQCM7.output.error.message$",
                                          "skip_execution": false
                                        },
                                        "object_type": "definition_activity"
                                      }
                                    ]
                                  }
                                ]
                              },
                              {
                                "unique_name": "definition_activity_01RHPY89478Q86azKrnRFZBBrrNafZIGtIO",
                                "name": "Fortinet - Create Address Group",
                                "title": "Fortinet - Create Address Group",
                                "type": "workflow.atomic_workflow",
                                "base_type": "subworkflow",
                                "properties": {
                                  "continue_on_failure": true,
                                  "display_name": "Fortinet - Create Address Group",
                                  "input": {
                                    "variable_workflow_01QCYG8UMC62K3m6m1L8dsnlM5t4unEJ0n0": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QVNBNH9JTYK3NfHWwhAzXMl4rzC8QLGvm$",
                                    "variable_workflow_01QFDWH91N2T04DPadLeuWLn0hPQBEdxbgZ": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QXEW7YBXKOA67nOxzUyeafXXO7sWUTTyr$",
                                    "variable_workflow_01QHUHPCHZCRG19cgEY94aieokgUxEMtzaZ": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QENMB1Z1RQH358zoMEikzjGBvYRvrdvlA$",
                                    "variable_workflow_01QZ6HUP59C8K4nUVPojPIE79ofWxLKG3Bp": "root"
                                  },
                                  "runtime_user": {
                                    "target_default": true
                                  },
                                  "skip_execution": false,
                                  "target": {
                                    "use_workflow_target_group": true
                                  },
                                  "workflow_id": "definition_workflow_01QCYG8UTYAXE2w8zM3Mn9RTBQXaMPNNl6e"
                                },
                                "object_type": "definition_activity"
                              },
                              {
                                "unique_name": "definition_activity_01RHYSJBY8H0A4UOBS3y3PZ9D1jMFuk9ilj",
                                "name": "Condition Block",
                                "title": "Critical Error Occurred?",
                                "type": "logic.if_else",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Critical Error Occurred?",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "blocks": [
                                  {
                                    "unique_name": "definition_activity_01RHYSJJMQA8N2GRc5ne9DoCRDzA13n2xRf",
                                    "name": "Condition Branch",
                                    "title": "Yes",
                                    "type": "logic.condition_block",
                                    "base_type": "activity",
                                    "properties": {
                                      "condition": {
                                        "left_operand": "$activity.definition_activity_01RHPY89478Q86azKrnRFZBBrrNafZIGtIO.output.succeeded$",
                                        "operator": "eq",
                                        "right_operand": false
                                      },
                                      "continue_on_failure": false,
                                      "display_name": "Yes",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "actions": [
                                      {
                                        "unique_name": "definition_activity_01RHYSJKAU4720nlOm4eUcDwU9b31KvWo2u",
                                        "name": "Microsoft Teams - Post Message via Webhook",
                                        "title": "Microsoft Teams - Post Message via Webhook",
                                        "type": "workflow.atomic_workflow",
                                        "base_type": "subworkflow",
                                        "properties": {
                                          "continue_on_failure": false,
                                          "display_name": "Microsoft Teams - Post Message via Webhook",
                                          "input": {
                                            "variable_workflow_01MRIK9PFIH9457K2ZY1x7rEJvOPzYOE6eO": "MESSAGE FROM Fortinet - FortiGate - Block URL, IP or Domain",
                                            "variable_workflow_01MRIKICJKVS16L5nynmibtyxbFIqwxBhOV": "**\"$activity.definition_activity_01RIOAECX3AJW4hO4brPL8stca1aM8otrbw.output.script_queries.observable_value$\" observable handling failed.**\n\u003cbr/\u003e\n$activity.definition_activity_01RHPY89478Q86azKrnRFZBBrrNafZIGtIO.output.error.message$",
                                            "variable_workflow_01MRIL2TKZ8FM1EvIZeO4VFV9ITFhG3vSlI": ""
                                          },
                                          "runtime_user": {
                                            "target_default": true
                                          },
                                          "skip_execution": false,
                                          "target": {
                                            "override_workflow_target_group_criteria": true,
                                            "target_group": {
                                              "run_on_all_targets": false,
                                              "use_criteria": {
                                                "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                                "conditions": [
                                                  {
                                                    "left_operand": "$targetgroup.target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH.common.display_name$",
                                                    "operator": "eqi",
                                                    "right_operand": "Microsoft Teams Webhook"
                                                  }
                                                ]
                                              }
                                            }
                                          },
                                          "workflow_id": "definition_workflow_01MRIE3B3DNNQ3cdFSoyGkg1RnVsYA9VdZr"
                                        },
                                        "object_type": "definition_activity"
                                      },
                                      {
                                        "unique_name": "definition_activity_01RHYSJRSSQDL63k3YU9OUBTvdh7S4IbNAT",
                                        "name": "Completed",
                                        "title": "Failed",
                                        "type": "logic.completed",
                                        "base_type": "activity",
                                        "properties": {
                                          "completion_type": "failed-completed",
                                          "continue_on_failure": false,
                                          "display_name": "Failed",
                                          "result_message": " \"$activity.definition_activity_01RIOAECX3AJW4hO4brPL8stca1aM8otrbw.output.script_queries.observable_value$\" observable handling failed.\n$activity.definition_activity_01RHPY89478Q86azKrnRFZBBrrNafZIGtIO.output.error.message$",
                                          "skip_execution": false
                                        },
                                        "object_type": "definition_activity"
                                      }
                                    ]
                                  }
                                ]
                              },
                              {
                                "unique_name": "definition_activity_01RID9XV4YDGP7XP5ZDIBjKG7TWr8BiXebH",
                                "name": "Microsoft Teams - Post Message via Webhook",
                                "title": "Microsoft Teams - Post Message via Webhook",
                                "type": "workflow.atomic_workflow",
                                "base_type": "subworkflow",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Microsoft Teams - Post Message via Webhook",
                                  "input": {
                                    "variable_workflow_01MRIK9PFIH9457K2ZY1x7rEJvOPzYOE6eO": "MESSAGE FROM Fortinet - FortiGate - Block URL, IP or Domain",
                                    "variable_workflow_01MRIKICJKVS16L5nynmibtyxbFIqwxBhOV": "Address Group \"$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QENMB1Z1RQH358zoMEikzjGBvYRvrdvlA$\" was not found, but a new Address Group with the name \"$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QENMB1Z1RQH358zoMEikzjGBvYRvrdvlA$\" was created instead.",
                                    "variable_workflow_01MRIL2TKZ8FM1EvIZeO4VFV9ITFhG3vSlI": ""
                                  },
                                  "runtime_user": {
                                    "target_default": true
                                  },
                                  "skip_execution": false,
                                  "target": {
                                    "override_workflow_target_group_criteria": true,
                                    "target_group": {
                                      "run_on_all_targets": false,
                                      "use_criteria": {
                                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                        "conditions": [
                                          {
                                            "left_operand": "$targetgroup.target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH.common.display_name$",
                                            "operator": "eqi",
                                            "right_operand": "Microsoft Teams Webhook"
                                          }
                                        ]
                                      }
                                    }
                                  },
                                  "workflow_id": "definition_workflow_01MRIE3B3DNNQ3cdFSoyGkg1RnVsYA9VdZr"
                                },
                                "object_type": "definition_activity"
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01QXJ52IGZDT34ZaynO80SH0pbY2jIFeEao",
                "name": "Condition Block",
                "title": "Address Group Name not provided?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Address Group Name not provided?",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01QXETP563QW30UfotFiCdDxneL6ct73XD7",
                    "name": "Condition Branch",
                    "title": "No",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QENMB1Z1RQH358zoMEikzjGBvYRvrdvlA$",
                        "operator": "eq",
                        "right_operand": ""
                      },
                      "continue_on_failure": false,
                      "display_name": "No",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01QXF023TQU424uU0YiSobLo2EoLPFeUktH",
                        "name": "Fortinet - Create Address Group",
                        "title": "Fortinet - Create Address Group",
                        "type": "workflow.atomic_workflow",
                        "base_type": "subworkflow",
                        "properties": {
                          "continue_on_failure": true,
                          "display_name": "Fortinet - Create Address Group",
                          "input": {
                            "variable_workflow_01QCYG8UMC62K3m6m1L8dsnlM5t4unEJ0n0": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QVNBNH9JTYK3NfHWwhAzXMl4rzC8QLGvm$",
                            "variable_workflow_01QFDWH91N2T04DPadLeuWLn0hPQBEdxbgZ": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QXEW7YBXKOA67nOxzUyeafXXO7sWUTTyr$",
                            "variable_workflow_01QHUHPCHZCRG19cgEY94aieokgUxEMtzaZ": "$activity.definition_activity_01QXI1GGQNAGM5d6nsdblV5UELRhItEnps4.output.script_queries.Address Group Name $",
                            "variable_workflow_01QZ6HUP59C8K4nUVPojPIE79ofWxLKG3Bp": "root"
                          },
                          "runtime_user": {
                            "target_default": true
                          },
                          "skip_execution": false,
                          "target": {
                            "use_workflow_target_group": true
                          },
                          "workflow_id": "definition_workflow_01QCYG8UTYAXE2w8zM3Mn9RTBQXaMPNNl6e"
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01RHYUB4EEAKJ0MvNsUt28xbYqXKE49McYC",
                        "name": "Condition Block",
                        "title": "Critical Error Occurred?",
                        "type": "logic.if_else",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Critical Error Occurred?",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "blocks": [
                          {
                            "unique_name": "definition_activity_01RHYUB82KAH97HT8z3I7xICEwz59Ak4Ydz",
                            "name": "Condition Branch",
                            "title": "Yes",
                            "type": "logic.condition_block",
                            "base_type": "activity",
                            "properties": {
                              "condition": {
                                "left_operand": "$activity.definition_activity_01QXF023TQU424uU0YiSobLo2EoLPFeUktH.output.succeeded$",
                                "operator": "eq",
                                "right_operand": false
                              },
                              "continue_on_failure": false,
                              "display_name": "Yes",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01RHYUB8TFOVZ0WkAeU7XN62Qi3t1LltN0z",
                                "name": "Microsoft Teams - Post Message via Webhook",
                                "title": "Microsoft Teams - Post Message via Webhook",
                                "type": "workflow.atomic_workflow",
                                "base_type": "subworkflow",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Microsoft Teams - Post Message via Webhook",
                                  "input": {
                                    "variable_workflow_01MRIK9PFIH9457K2ZY1x7rEJvOPzYOE6eO": "MESSAGE FROM Fortinet - FortiGate - Block URL, IP or Domain",
                                    "variable_workflow_01MRIKICJKVS16L5nynmibtyxbFIqwxBhOV": "**\"$activity.definition_activity_01RIOAECX3AJW4hO4brPL8stca1aM8otrbw.output.script_queries.observable_value$\" observable handling failed.**\n\u003cbr/\u003e\n$activity.definition_activity_01QXF023TQU424uU0YiSobLo2EoLPFeUktH.output.error.message$",
                                    "variable_workflow_01MRIL2TKZ8FM1EvIZeO4VFV9ITFhG3vSlI": ""
                                  },
                                  "runtime_user": {
                                    "target_default": true
                                  },
                                  "skip_execution": false,
                                  "target": {
                                    "override_workflow_target_group_criteria": true,
                                    "target_group": {
                                      "run_on_all_targets": false,
                                      "use_criteria": {
                                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                        "conditions": [
                                          {
                                            "left_operand": "$targetgroup.target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH.common.display_name$",
                                            "operator": "eqi",
                                            "right_operand": "Microsoft Teams Webhook"
                                          }
                                        ]
                                      }
                                    }
                                  },
                                  "workflow_id": "definition_workflow_01MRIE3B3DNNQ3cdFSoyGkg1RnVsYA9VdZr"
                                },
                                "object_type": "definition_activity"
                              },
                              {
                                "unique_name": "definition_activity_01RHYUBF5066R3Jp2nbAD7Cfeh6f0awyHKf",
                                "name": "Completed",
                                "title": "Failed",
                                "type": "logic.completed",
                                "base_type": "activity",
                                "properties": {
                                  "completion_type": "failed-completed",
                                  "continue_on_failure": false,
                                  "display_name": "Failed",
                                  "result_message": "\"$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWWV8OOA64LdyclajeziyBPSXN0JFIC$\" observable handling failed.\n$activity.definition_activity_01QXF023TQU424uU0YiSobLo2EoLPFeUktH.output.error.message$",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity"
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "unique_name": "definition_activity_01QYFU9JD2L9C6nIiOPSZyttUM9pO98xoQb",
                        "name": "Set Variables",
                        "title": "Set Variable Address Group Name",
                        "type": "core.set_multiple_variables",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Set Variable Address Group Name",
                          "skip_execution": false,
                          "variables_to_update": [
                            {
                              "variable_to_update": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QENMB1Z1RQH358zoMEikzjGBvYRvrdvlA$",
                              "variable_value_new": "$activity.definition_activity_01QXF023TQU424uU0YiSobLo2EoLPFeUktH.output.variable_workflow_01QCYG8UMCCS05YeDk3P1pt3OOXGHM55hi3$"
                            }
                          ]
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01QYE5WFSJBFT3hcwqqCKWmVU78Xlx38dIu",
                "name": "Set Variables",
                "title": "Clear extra inputs if present",
                "type": "core.set_multiple_variables",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Clear extra inputs if present",
                  "skip_execution": false,
                  "variables_to_update": [
                    {
                      "variable_to_update": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QENLZHPIVVI28kd2INwi2zuZncQeryxQr$",
                      "variable_value_new": ""
                    }
                  ]
                },
                "object_type": "definition_activity"
              }
            ]
          },
          {
            "unique_name": "definition_activity_01QVND6K0W0L66rdhyShNZEZPLZiJ1GB3vl",
            "name": "Condition Branch",
            "title": "URL",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWPO1WE3738QmwiLwBJbXce3agNJ7Kk$",
                "operator": "eq",
                "right_operand": "url"
              },
              "continue_on_failure": false,
              "display_name": "URL",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01QWIGB3XB54H5w0BTeaSAyUxRFbhI8DbGY",
                "name": "Condition Block",
                "title": "Web Filter Name Provided?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Web Filter Name Provided?",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01QWIGB8M10EQ6zDFI3u3V3UYEwDjCRy9Qc",
                    "name": "Condition Branch",
                    "title": "Yes",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QENLZHPIVVI28kd2INwi2zuZncQeryxQr$",
                        "operator": "ne",
                        "right_operand": ""
                      },
                      "continue_on_failure": false,
                      "display_name": "Yes",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01QWIR9KUPHWJ0ZeoGn1hYeCJM8evhCOPLK",
                        "name": "Fortinet - FortiGate - Search for Web Filter by Name",
                        "title": "Fortinet - FortiGate - Search for Web Filter by Name",
                        "type": "workflow.atomic_workflow",
                        "base_type": "subworkflow",
                        "properties": {
                          "continue_on_failure": true,
                          "display_name": "Fortinet - FortiGate - Search for Web Filter by Name",
                          "input": {
                            "variable_workflow_01QTSQI5AOIDP1UVa3tdeyCoxgF8uWnJoc4": "root",
                            "variable_workflow_01QTSQI5AOJY03c8ShvFxa6WGyMzlo9AxMo": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QENLZHPIVVI28kd2INwi2zuZncQeryxQr$",
                            "variable_workflow_01QTSQI5AOMZU4SbT4ozhFODZqKw3438YcU": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QVNBNH9JTYK3NfHWwhAzXMl4rzC8QLGvm$"
                          },
                          "runtime_user": {
                            "target_default": true
                          },
                          "skip_execution": false,
                          "target": {
                            "use_workflow_target_group": true
                          },
                          "workflow_id": "definition_workflow_01QTSQI5IY61E0eT05l4mbwyexR2rwtaSYl"
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01QWIZ6AGSDJP5f3BJAiaoLl9GgGjOIgBNQ",
                        "name": "Condition Block",
                        "title": "Web Filter Name found?",
                        "type": "logic.if_else",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Web Filter Name found?",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "blocks": [
                          {
                            "unique_name": "definition_activity_01QWIZ6EU4ZAW1XStWv7z7mPlMrOUn4ihdn",
                            "name": "Condition Branch",
                            "title": "Yes",
                            "type": "logic.condition_block",
                            "base_type": "activity",
                            "properties": {
                              "condition": {
                                "left_operand": "$activity.definition_activity_01QWIR9KUPHWJ0ZeoGn1hYeCJM8evhCOPLK.output.succeeded$",
                                "operator": "eq",
                                "right_operand": true
                              },
                              "continue_on_failure": false,
                              "display_name": "Yes",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01QZMG56S7GIE2PQYHd511ZZBAkWTDREKxn",
                                "name": "Set Variables",
                                "title": "Set Variable Web Filter Exists",
                                "type": "core.set_multiple_variables",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Set Variable Web Filter Exists",
                                  "skip_execution": false,
                                  "variables_to_update": [
                                    {
                                      "variable_to_update": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QXHDTN38KYA2fVPGaarP7pEMBlwNgVqpK$",
                                      "variable_value_new": true
                                    }
                                  ]
                                },
                                "object_type": "definition_activity"
                              },
                              {
                                "unique_name": "definition_activity_01QWJ0PK7DA774YRtVZvBQ2nLrU9x721YTw",
                                "name": "JSONPath Query",
                                "title": "Extract  URL Filter MKey",
                                "type": "corejava.jsonpathquery",
                                "base_type": "activity",
                                "properties": {
                                  "action_timeout": 180,
                                  "continue_on_failure": true,
                                  "display_name": "Extract  URL Filter MKey",
                                  "input_json": "$activity.definition_activity_01QWIR9KUPHWJ0ZeoGn1hYeCJM8evhCOPLK.output.variable_workflow_01QTSQI5AOLGJ1ICiAZAvpDArlZk6MCG80B$",
                                  "jsonpath_queries": [
                                    {
                                      "jsonpath_query": ".web.urlfilter-table",
                                      "jsonpath_query_name": "URL Filter Table",
                                      "jsonpath_query_type": "string"
                                    }
                                  ],
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity"
                              },
                              {
                                "unique_name": "definition_activity_01QWJ2R4KUIKK1QVe1gdkN3Rau2Gw1jWgsv",
                                "name": "Condition Block",
                                "title": "Extraction sucessfull?",
                                "type": "logic.if_else",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Extraction sucessfull?",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "blocks": [
                                  {
                                    "unique_name": "definition_activity_01QWJ2R87BJEY4inzT6bv9EtJfZZSNwtzTk",
                                    "name": "Condition Branch",
                                    "title": "Yes",
                                    "type": "logic.condition_block",
                                    "base_type": "activity",
                                    "properties": {
                                      "condition": {
                                        "left_operand": {
                                          "left_operand": "$activity.definition_activity_01QWJ0PK7DA774YRtVZvBQ2nLrU9x721YTw.output.succeeded$",
                                          "operator": "eq",
                                          "right_operand": true
                                        },
                                        "operator": "and",
                                        "right_operand": {
                                          "left_operand": "$activity.definition_activity_01QWJ0PK7DA774YRtVZvBQ2nLrU9x721YTw.output.jsonpath_queries.URL Filter Table$",
                                          "operator": "ne",
                                          "right_operand": "0"
                                        }
                                      },
                                      "continue_on_failure": false,
                                      "display_name": "Yes",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "actions": [
                                      {
                                        "unique_name": "definition_activity_01QWJ3W5RLZ172bZzm6fnu5RtMfpU2Zk5rI",
                                        "name": "Fortinet - FortiGate - Add URL to URL Filter",
                                        "title": "Fortinet - FortiGate - Add URL to URL Filter",
                                        "type": "workflow.atomic_workflow",
                                        "base_type": "subworkflow",
                                        "properties": {
                                          "continue_on_failure": true,
                                          "display_name": "Fortinet - FortiGate - Add URL to URL Filter",
                                          "input": {
                                            "variable_workflow_01QTTUMDLM9KF4wEdIf0sL0kYyyPYNhFQI4": "$activity.definition_activity_01QWJ0PK7DA774YRtVZvBQ2nLrU9x721YTw.output.jsonpath_queries.URL Filter Table$",
                                            "variable_workflow_01QTTUMDLMGGS3YaRczu3vU0AVXA5kBFeQq": "root",
                                            "variable_workflow_01QTTUMDLMHVN0vYPl8F6KsDolGDcG4OWKI": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWWV8OOA64LdyclajeziyBPSXN0JFIC$",
                                            "variable_workflow_01QTTUMDLMJ2N4TMVxTti3VMk7rCcjjWHnc": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QVNBNH9JTYK3NfHWwhAzXMl4rzC8QLGvm$"
                                          },
                                          "runtime_user": {
                                            "target_default": true
                                          },
                                          "skip_execution": false,
                                          "target": {
                                            "use_workflow_target_group": true
                                          },
                                          "workflow_id": "definition_workflow_01QTTUMDSUU0L6hykgyzvov9DIbC8YZyISv"
                                        },
                                        "object_type": "definition_activity"
                                      },
                                      {
                                        "unique_name": "definition_activity_01RHZ9DRL7H6C78qFHTpVFSAFlbma77sIO2",
                                        "name": "Condition Block",
                                        "title": "Critical Error Occurred?",
                                        "type": "logic.if_else",
                                        "base_type": "activity",
                                        "properties": {
                                          "continue_on_failure": false,
                                          "display_name": "Critical Error Occurred?",
                                          "skip_execution": false
                                        },
                                        "object_type": "definition_activity",
                                        "blocks": [
                                          {
                                            "unique_name": "definition_activity_01RHZ9DXXH97N4tfQhpCZ8qnIhXSukVqbxT",
                                            "name": "Condition Branch",
                                            "title": "Yes",
                                            "type": "logic.condition_block",
                                            "base_type": "activity",
                                            "properties": {
                                              "condition": {
                                                "left_operand": "$activity.definition_activity_01QWJ3W5RLZ172bZzm6fnu5RtMfpU2Zk5rI.output.succeeded$",
                                                "operator": "eq",
                                                "right_operand": false
                                              },
                                              "continue_on_failure": false,
                                              "display_name": "Yes",
                                              "skip_execution": false
                                            },
                                            "object_type": "definition_activity",
                                            "actions": [
                                              {
                                                "unique_name": "definition_activity_01RHZ9DYNCQJQ4mXwdLzs6DRQb9qMfcsNhw",
                                                "name": "Microsoft Teams - Post Message via Webhook",
                                                "title": "Microsoft Teams - Post Message via Webhook",
                                                "type": "workflow.atomic_workflow",
                                                "base_type": "subworkflow",
                                                "properties": {
                                                  "continue_on_failure": false,
                                                  "display_name": "Microsoft Teams - Post Message via Webhook",
                                                  "input": {
                                                    "variable_workflow_01MRIK9PFIH9457K2ZY1x7rEJvOPzYOE6eO": "MESSAGE FROM Fortinet - FortiGate - Block URL, IP or Domain",
                                                    "variable_workflow_01MRIKICJKVS16L5nynmibtyxbFIqwxBhOV": "**\"$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWWV8OOA64LdyclajeziyBPSXN0JFIC$\" observable handling failed.**\n\u003cbr/\u003e\n$activity.definition_activity_01QWJ3W5RLZ172bZzm6fnu5RtMfpU2Zk5rI.output.error.message$",
                                                    "variable_workflow_01MRIL2TKZ8FM1EvIZeO4VFV9ITFhG3vSlI": ""
                                                  },
                                                  "runtime_user": {
                                                    "target_default": true
                                                  },
                                                  "skip_execution": false,
                                                  "target": {
                                                    "override_workflow_target_group_criteria": true,
                                                    "target_group": {
                                                      "run_on_all_targets": false,
                                                      "use_criteria": {
                                                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                                        "conditions": [
                                                          {
                                                            "left_operand": "$targetgroup.target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH.common.display_name$",
                                                            "operator": "eqi",
                                                            "right_operand": "Microsoft Teams Webhook"
                                                          }
                                                        ]
                                                      }
                                                    }
                                                  },
                                                  "workflow_id": "definition_workflow_01MRIE3B3DNNQ3cdFSoyGkg1RnVsYA9VdZr"
                                                },
                                                "object_type": "definition_activity"
                                              },
                                              {
                                                "unique_name": "definition_activity_01RHZ9E4S2GGM4n4PGCt3GPOlQqrCAqTBIs",
                                                "name": "Completed",
                                                "title": "Failed",
                                                "type": "logic.completed",
                                                "base_type": "activity",
                                                "properties": {
                                                  "completion_type": "failed-completed",
                                                  "continue_on_failure": false,
                                                  "display_name": "Failed",
                                                  "result_message": "\"$activity.definition_activity_01RIOAECX3AJW4hO4brPL8stca1aM8otrbw.output.script_queries.observable_value$\" observable handling failed.\n \n$activity.definition_activity_01QWJ3W5RLZ172bZzm6fnu5RtMfpU2Zk5rI.output.error.message$",
                                                  "skip_execution": false
                                                },
                                                "object_type": "definition_activity"
                                              }
                                            ]
                                          }
                                        ]
                                      }
                                    ]
                                  },
                                  {
                                    "unique_name": "definition_activity_01QZM89Z2XBTK7bttaq590MQ6EbLhxFjDbT",
                                    "name": "Condition Branch",
                                    "title": "No",
                                    "type": "logic.condition_block",
                                    "base_type": "activity",
                                    "properties": {
                                      "condition": {
                                        "left_operand": {
                                          "left_operand": "$activity.definition_activity_01QWJ0PK7DA774YRtVZvBQ2nLrU9x721YTw.output.succeeded$",
                                          "operator": "eq",
                                          "right_operand": false
                                        },
                                        "operator": "or",
                                        "right_operand": {
                                          "left_operand": "$activity.definition_activity_01QWJ0PK7DA774YRtVZvBQ2nLrU9x721YTw.output.jsonpath_queries.URL Filter Table$",
                                          "operator": "eq",
                                          "right_operand": "0"
                                        }
                                      },
                                      "continue_on_failure": false,
                                      "display_name": "No",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "actions": [
                                      {
                                        "unique_name": "definition_activity_01QZM9AV6ZLA01eBcuPkP0dGeQLQqFOeafS",
                                        "name": "Fortinet - FortiGate - Create URL Filter",
                                        "title": "Fortinet - FortiGate - Create URL Filter",
                                        "type": "workflow.atomic_workflow",
                                        "base_type": "subworkflow",
                                        "properties": {
                                          "continue_on_failure": true,
                                          "display_name": "Fortinet - FortiGate - Create URL Filter",
                                          "input": {
                                            "variable_workflow_01QPJN9OQP82D67vM88JbpApXHH2HruIR44": "root",
                                            "variable_workflow_01QPJN9OQP9XZ7FTwvYnhHFIa5MA8hboqMm": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QVNBNH9JTYK3NfHWwhAzXMl4rzC8QLGvm$",
                                            "variable_workflow_01QPJN9OQPBZ41CQ3IjmqYxxy7u0ltmYktz": "$activity.definition_activity_01QXI1GGQNAGM5d6nsdblV5UELRhItEnps4.output.script_queries.URL Filter Name$",
                                            "variable_workflow_01QPKTY4TNQW91qT9tlWoF4rRvNteWdZJHD": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWWV8OOA64LdyclajeziyBPSXN0JFIC$"
                                          },
                                          "runtime_user": {
                                            "target_default": true
                                          },
                                          "skip_execution": false,
                                          "target": {
                                            "use_workflow_target_group": true
                                          },
                                          "workflow_id": "definition_workflow_01QPJN9P092ZK4B1nv7D0yaTHqYWenXdVIb"
                                        },
                                        "object_type": "definition_activity"
                                      },
                                      {
                                        "unique_name": "definition_activity_01RHZE20V3IVU1O5dwqr7hwjRDUpwId8jIt",
                                        "name": "Condition Block",
                                        "title": "Critical Error Occurred?",
                                        "type": "logic.if_else",
                                        "base_type": "activity",
                                        "properties": {
                                          "continue_on_failure": false,
                                          "display_name": "Critical Error Occurred?",
                                          "skip_execution": false
                                        },
                                        "object_type": "definition_activity",
                                        "blocks": [
                                          {
                                            "unique_name": "definition_activity_01RHZE24EO2FY2oHOl28QGFsOXgM0PXPKS0",
                                            "name": "Condition Branch",
                                            "title": "Yes",
                                            "type": "logic.condition_block",
                                            "base_type": "activity",
                                            "properties": {
                                              "condition": {
                                                "left_operand": "$activity.definition_activity_01QZM9AV6ZLA01eBcuPkP0dGeQLQqFOeafS.output.succeeded$",
                                                "operator": "eq",
                                                "right_operand": false
                                              },
                                              "continue_on_failure": false,
                                              "display_name": "Yes",
                                              "skip_execution": false
                                            },
                                            "object_type": "definition_activity",
                                            "actions": [
                                              {
                                                "unique_name": "definition_activity_01RHZE2553IFE5hMLuFsziMfum442U42L6b",
                                                "name": "Microsoft Teams - Post Message via Webhook",
                                                "title": "Microsoft Teams - Post Message via Webhook",
                                                "type": "workflow.atomic_workflow",
                                                "base_type": "subworkflow",
                                                "properties": {
                                                  "continue_on_failure": false,
                                                  "display_name": "Microsoft Teams - Post Message via Webhook",
                                                  "input": {
                                                    "variable_workflow_01MRIK9PFIH9457K2ZY1x7rEJvOPzYOE6eO": "MESSAGE FROM Fortinet - FortiGate - Block URL, IP or Domain",
                                                    "variable_workflow_01MRIKICJKVS16L5nynmibtyxbFIqwxBhOV": "**\"$activity.definition_activity_01RIOAECX3AJW4hO4brPL8stca1aM8otrbw.output.script_queries.observable_value$\" observable handling failed.**\n\u003cbr/\u003e\n$activity.definition_activity_01QZM9AV6ZLA01eBcuPkP0dGeQLQqFOeafS.output.error.message$\n",
                                                    "variable_workflow_01MRIL2TKZ8FM1EvIZeO4VFV9ITFhG3vSlI": ""
                                                  },
                                                  "runtime_user": {
                                                    "target_default": true
                                                  },
                                                  "skip_execution": false,
                                                  "target": {
                                                    "override_workflow_target_group_criteria": true,
                                                    "target_group": {
                                                      "run_on_all_targets": false,
                                                      "use_criteria": {
                                                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                                        "conditions": [
                                                          {
                                                            "left_operand": "$targetgroup.target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH.common.display_name$",
                                                            "operator": "eqi",
                                                            "right_operand": "Microsoft Teams Webhook"
                                                          }
                                                        ]
                                                      }
                                                    }
                                                  },
                                                  "workflow_id": "definition_workflow_01MRIE3B3DNNQ3cdFSoyGkg1RnVsYA9VdZr"
                                                },
                                                "object_type": "definition_activity"
                                              },
                                              {
                                                "unique_name": "definition_activity_01RHZE2BGAWX36PQhC3mwEr0LNKe8H6bn3k",
                                                "name": "Completed",
                                                "title": "Failed",
                                                "type": "logic.completed",
                                                "base_type": "activity",
                                                "properties": {
                                                  "completion_type": "failed-completed",
                                                  "continue_on_failure": false,
                                                  "display_name": "Failed",
                                                  "result_message": "\"$activity.definition_activity_01RIOAECX3AJW4hO4brPL8stca1aM8otrbw.output.script_queries.observable_value$\" observable handling failed.\n \n$activity.definition_activity_01QZM9AV6ZLA01eBcuPkP0dGeQLQqFOeafS.output.error.message$",
                                                  "skip_execution": false
                                                },
                                                "object_type": "definition_activity"
                                              }
                                            ]
                                          }
                                        ]
                                      },
                                      {
                                        "unique_name": "definition_activity_01QXHGUDKGHUO1qYFB6ijbv97rqNEqV71FL",
                                        "name": "Fortinet - FortiGate - Add Entry to Web Filter",
                                        "title": "Fortinet - FortiGate - Add Entry to Web Filter",
                                        "type": "workflow.atomic_workflow",
                                        "base_type": "subworkflow",
                                        "properties": {
                                          "continue_on_failure": true,
                                          "display_name": "Fortinet - FortiGate - Add Entry to Web Filter",
                                          "input": {
                                            "variable_workflow_01QDU1FYPFRCK220HdGrQT5E8q5rHtzPQn2": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QVNBNH9JTYK3NfHWwhAzXMl4rzC8QLGvm$",
                                            "variable_workflow_01QDU3BHG0FYX1YM6UUwzdhIYZFTDSLi8At": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QENLZHPIVVI28kd2INwi2zuZncQeryxQr$",
                                            "variable_workflow_01QDUQU3ZBY9N7jboIgNoKcZdgUAQi1BtCD": "$activity.definition_activity_01QZM9AV6ZLA01eBcuPkP0dGeQLQqFOeafS.output.variable_workflow_01QPJN9OQP3VF5AvZlRFEVyXuoNnuHRGrTI$"
                                          },
                                          "runtime_user": {
                                            "target_default": true
                                          },
                                          "skip_execution": false,
                                          "target": {
                                            "use_workflow_target_group": true
                                          },
                                          "workflow_id": "definition_workflow_01QDU1FYX531C0rakrXzq8h6BHdjcTDqqu6"
                                        },
                                        "object_type": "definition_activity"
                                      },
                                      {
                                        "unique_name": "definition_activity_01RHZJVIZ46K27NpAS97mSK9jPtmVpqxzAO",
                                        "name": "Condition Block",
                                        "title": "Critical Error Occurred?",
                                        "type": "logic.if_else",
                                        "base_type": "activity",
                                        "properties": {
                                          "continue_on_failure": false,
                                          "display_name": "Critical Error Occurred?",
                                          "skip_execution": false
                                        },
                                        "object_type": "definition_activity",
                                        "blocks": [
                                          {
                                            "unique_name": "definition_activity_01RHZJVMJ4I9C01eztKVym0Y0gQRy5pjjqP",
                                            "name": "Condition Branch",
                                            "title": "Yes",
                                            "type": "logic.condition_block",
                                            "base_type": "activity",
                                            "properties": {
                                              "condition": {
                                                "left_operand": "$activity.definition_activity_01QXHGUDKGHUO1qYFB6ijbv97rqNEqV71FL.output.succeeded$",
                                                "operator": "eq",
                                                "right_operand": false
                                              },
                                              "continue_on_failure": false,
                                              "display_name": "Yes",
                                              "skip_execution": false
                                            },
                                            "object_type": "definition_activity",
                                            "actions": [
                                              {
                                                "unique_name": "definition_activity_01RHZJVNG6H270T4fHnblpre7W4TGRtJb4E",
                                                "name": "Microsoft Teams - Post Message via Webhook",
                                                "title": "Microsoft Teams - Post Message via Webhook",
                                                "type": "workflow.atomic_workflow",
                                                "base_type": "subworkflow",
                                                "properties": {
                                                  "continue_on_failure": false,
                                                  "display_name": "Microsoft Teams - Post Message via Webhook",
                                                  "input": {
                                                    "variable_workflow_01MRIK9PFIH9457K2ZY1x7rEJvOPzYOE6eO": "MESSAGE FROM Fortinet - FortiGate - Block URL, IP or Domain",
                                                    "variable_workflow_01MRIKICJKVS16L5nynmibtyxbFIqwxBhOV": "**\"$activity.definition_activity_01RIOAECX3AJW4hO4brPL8stca1aM8otrbw.output.script_queries.observable_value$\" observable handling failed.**\n\u003cbr/\u003e\n$activity.definition_activity_01QXHGUDKGHUO1qYFB6ijbv97rqNEqV71FL.output.error.message$",
                                                    "variable_workflow_01MRIL2TKZ8FM1EvIZeO4VFV9ITFhG3vSlI": ""
                                                  },
                                                  "runtime_user": {
                                                    "target_default": true
                                                  },
                                                  "skip_execution": false,
                                                  "target": {
                                                    "override_workflow_target_group_criteria": true,
                                                    "target_group": {
                                                      "run_on_all_targets": false,
                                                      "use_criteria": {
                                                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                                        "conditions": [
                                                          {
                                                            "left_operand": "$targetgroup.target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH.common.display_name$",
                                                            "operator": "eqi",
                                                            "right_operand": "Microsoft Teams Webhook"
                                                          }
                                                        ]
                                                      }
                                                    }
                                                  },
                                                  "workflow_id": "definition_workflow_01MRIE3B3DNNQ3cdFSoyGkg1RnVsYA9VdZr"
                                                },
                                                "object_type": "definition_activity"
                                              },
                                              {
                                                "unique_name": "definition_activity_01RHZJVTOD2LY1RC3WPzRXyzdvWeiQ9sdNK",
                                                "name": "Completed",
                                                "title": "Failed",
                                                "type": "logic.completed",
                                                "base_type": "activity",
                                                "properties": {
                                                  "completion_type": "failed-completed",
                                                  "continue_on_failure": false,
                                                  "display_name": "Failed",
                                                  "result_message": "\"$activity.definition_activity_01RIOAECX3AJW4hO4brPL8stca1aM8otrbw.output.script_queries.observable_value$\" observable handling failed.\n$activity.definition_activity_01QXHGUDKGHUO1qYFB6ijbv97rqNEqV71FL.output.error.message$",
                                                  "skip_execution": false
                                                },
                                                "object_type": "definition_activity"
                                              }
                                            ]
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "unique_name": "definition_activity_01RHQ456D2SVT4CjPHB2TJTweTfiKIMLs8j",
                            "name": "Condition Branch",
                            "title": "No",
                            "type": "logic.condition_block",
                            "base_type": "activity",
                            "properties": {
                              "condition": {
                                "left_operand": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QXHDTN38KYA2fVPGaarP7pEMBlwNgVqpK$",
                                "operator": "eq",
                                "right_operand": false
                              },
                              "continue_on_failure": false,
                              "display_name": "No",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01RHYCS9619KB4jn677F0REmweuJLJ6J1ds",
                                "name": "Condition Block",
                                "title": "Critical Error Occurred?",
                                "type": "logic.if_else",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Critical Error Occurred?",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "blocks": [
                                  {
                                    "unique_name": "definition_activity_01RHYCSFQWH9N6VAgB6OEFb5MGdKc37DntQ",
                                    "name": "Condition Branch",
                                    "title": "Yes",
                                    "type": "logic.condition_block",
                                    "base_type": "activity",
                                    "properties": {
                                      "condition": {
                                        "left_operand": "$activity.definition_activity_01QWIR9KUPHWJ0ZeoGn1hYeCJM8evhCOPLK.output.error.message$",
                                        "operator": "nmw",
                                        "right_operand": "Status Code:  404"
                                      },
                                      "continue_on_failure": false,
                                      "display_name": "Yes",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "actions": [
                                      {
                                        "unique_name": "definition_activity_01RHYLCEBZ40F4YTvfF5m1JC14MkmZCf0Fb",
                                        "name": "Microsoft Teams - Post Message via Webhook",
                                        "title": "Microsoft Teams - Post Message via Webhook",
                                        "type": "workflow.atomic_workflow",
                                        "base_type": "subworkflow",
                                        "properties": {
                                          "continue_on_failure": false,
                                          "display_name": "Microsoft Teams - Post Message via Webhook",
                                          "input": {
                                            "variable_workflow_01MRIK9PFIH9457K2ZY1x7rEJvOPzYOE6eO": "MESSAGE FROM Fortinet - FortiGate - Block URL, IP or Domain",
                                            "variable_workflow_01MRIKICJKVS16L5nynmibtyxbFIqwxBhOV": "**\"$activity.definition_activity_01RIOAECX3AJW4hO4brPL8stca1aM8otrbw.output.script_queries.observable_value$\" observable handling failed.**\n\u003cbr/\u003e\n$activity.definition_activity_01QWIR9KUPHWJ0ZeoGn1hYeCJM8evhCOPLK.output.error.message$",
                                            "variable_workflow_01MRIL2TKZ8FM1EvIZeO4VFV9ITFhG3vSlI": ""
                                          },
                                          "runtime_user": {
                                            "target_default": true
                                          },
                                          "skip_execution": false,
                                          "target": {
                                            "override_workflow_target_group_criteria": true,
                                            "target_group": {
                                              "run_on_all_targets": false,
                                              "use_criteria": {
                                                "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                                "conditions": [
                                                  {
                                                    "left_operand": "$targetgroup.target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH.common.display_name$",
                                                    "operator": "eqi",
                                                    "right_operand": "Microsoft Teams Webhook"
                                                  }
                                                ]
                                              }
                                            }
                                          },
                                          "workflow_id": "definition_workflow_01MRIE3B3DNNQ3cdFSoyGkg1RnVsYA9VdZr"
                                        },
                                        "object_type": "definition_activity"
                                      },
                                      {
                                        "unique_name": "definition_activity_01RHYD1TLN3YI1xCHVW2UNumK4MgvyKiddQ",
                                        "name": "Completed",
                                        "title": "Failed",
                                        "type": "logic.completed",
                                        "base_type": "activity",
                                        "properties": {
                                          "completion_type": "failed-completed",
                                          "continue_on_failure": false,
                                          "display_name": "Failed",
                                          "result_message": "\"$activity.definition_activity_01RIOAECX3AJW4hO4brPL8stca1aM8otrbw.output.script_queries.observable_value$\" observable handling failed.\n \n$activity.definition_activity_01QWIR9KUPHWJ0ZeoGn1hYeCJM8evhCOPLK.output.error.message$\n",
                                          "skip_execution": false
                                        },
                                        "object_type": "definition_activity"
                                      }
                                    ]
                                  }
                                ]
                              },
                              {
                                "unique_name": "definition_activity_01RHQ457BVXCA4YkT5xnx0yM2S3kUefCUi7",
                                "name": "Fortinet - FortiGate - Create Web Filter",
                                "title": "Fortinet - FortiGate - Create Web Filter",
                                "type": "workflow.atomic_workflow",
                                "base_type": "subworkflow",
                                "properties": {
                                  "continue_on_failure": true,
                                  "display_name": "Fortinet - FortiGate - Create Web Filter",
                                  "input": {
                                    "variable_workflow_01QDTLM4QXG6P1FISycNrsAW3Bpsp5CkK1I": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QVNBNH9JTYK3NfHWwhAzXMl4rzC8QLGvm$",
                                    "variable_workflow_01QOP7FLZ0I667NsWzXGLQW76Pu96E73GyC": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QENLZHPIVVI28kd2INwi2zuZncQeryxQr$",
                                    "variable_workflow_01QOPAYKBF31P0sKTV6uNXMWOJYSXxNsNth": "root"
                                  },
                                  "runtime_user": {
                                    "target_default": true
                                  },
                                  "skip_execution": false,
                                  "target": {
                                    "use_workflow_target_group": true
                                  },
                                  "workflow_id": "definition_workflow_01QDTLM4YSM301c4l0yOFGdfOheLwpbNvjT"
                                },
                                "object_type": "definition_activity"
                              },
                              {
                                "unique_name": "definition_activity_01RHZNR7ONRTU4tMmtUn9kGP4ccK3spGsmb",
                                "name": "Condition Block",
                                "title": "Critical Error Occurred?",
                                "type": "logic.if_else",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Critical Error Occurred?",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "blocks": [
                                  {
                                    "unique_name": "definition_activity_01RHZNRE2SIXE0YKdutOnro6KeSLZaBIrVa",
                                    "name": "Condition Branch",
                                    "title": "Yes",
                                    "type": "logic.condition_block",
                                    "base_type": "activity",
                                    "properties": {
                                      "condition": {
                                        "left_operand": "$activity.definition_activity_01RHQ457BVXCA4YkT5xnx0yM2S3kUefCUi7.output.succeeded$",
                                        "operator": "eq",
                                        "right_operand": false
                                      },
                                      "continue_on_failure": false,
                                      "display_name": "Yes",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "actions": [
                                      {
                                        "unique_name": "definition_activity_01RHZNRES86H65iT0o5JEoS8gI5D6cu4n7f",
                                        "name": "Microsoft Teams - Post Message via Webhook",
                                        "title": "Microsoft Teams - Post Message via Webhook",
                                        "type": "workflow.atomic_workflow",
                                        "base_type": "subworkflow",
                                        "properties": {
                                          "continue_on_failure": false,
                                          "display_name": "Microsoft Teams - Post Message via Webhook",
                                          "input": {
                                            "variable_workflow_01MRIK9PFIH9457K2ZY1x7rEJvOPzYOE6eO": "MESSAGE FROM Fortinet - FortiGate - Block URL, IP or Domain",
                                            "variable_workflow_01MRIKICJKVS16L5nynmibtyxbFIqwxBhOV": "**\"$activity.definition_activity_01RIOAECX3AJW4hO4brPL8stca1aM8otrbw.output.script_queries.observable_value$\" observable handling failed.**\n\u003cbr/\u003e\n$activity.definition_activity_01RHQ457BVXCA4YkT5xnx0yM2S3kUefCUi7.output.error.message$\n",
                                            "variable_workflow_01MRIL2TKZ8FM1EvIZeO4VFV9ITFhG3vSlI": ""
                                          },
                                          "runtime_user": {
                                            "target_default": true
                                          },
                                          "skip_execution": false,
                                          "target": {
                                            "override_workflow_target_group_criteria": true,
                                            "target_group": {
                                              "run_on_all_targets": false,
                                              "use_criteria": {
                                                "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                                "conditions": [
                                                  {
                                                    "left_operand": "$targetgroup.target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH.common.display_name$",
                                                    "operator": "eqi",
                                                    "right_operand": "Microsoft Teams Webhook"
                                                  }
                                                ]
                                              }
                                            }
                                          },
                                          "workflow_id": "definition_workflow_01MRIE3B3DNNQ3cdFSoyGkg1RnVsYA9VdZr"
                                        },
                                        "object_type": "definition_activity"
                                      },
                                      {
                                        "unique_name": "definition_activity_01RHZNRL0TMQO28VSNVLFylC0kFNTo0Xnj0",
                                        "name": "Completed",
                                        "title": "Failed",
                                        "type": "logic.completed",
                                        "base_type": "activity",
                                        "properties": {
                                          "completion_type": "failed-completed",
                                          "continue_on_failure": false,
                                          "display_name": "Failed",
                                          "result_message": "\"$activity.definition_activity_01RIOAECX3AJW4hO4brPL8stca1aM8otrbw.output.script_queries.observable_value$\" observable handling failed.\n \n$activity.definition_activity_01RHQ457BVXCA4YkT5xnx0yM2S3kUefCUi7.output.error.message$",
                                          "skip_execution": false
                                        },
                                        "object_type": "definition_activity"
                                      }
                                    ]
                                  }
                                ]
                              },
                              {
                                "unique_name": "definition_activity_01RHQ45DJOV7K2jAqKpmfu42yEuphFzXlfL",
                                "name": "Fortinet - FortiGate - Create URL Filter",
                                "title": "Fortinet - FortiGate - Create URL Filter",
                                "type": "workflow.atomic_workflow",
                                "base_type": "subworkflow",
                                "properties": {
                                  "continue_on_failure": true,
                                  "display_name": "Fortinet - FortiGate - Create URL Filter",
                                  "input": {
                                    "variable_workflow_01QPJN9OQP82D67vM88JbpApXHH2HruIR44": "root",
                                    "variable_workflow_01QPJN9OQP9XZ7FTwvYnhHFIa5MA8hboqMm": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QVNBNH9JTYK3NfHWwhAzXMl4rzC8QLGvm$",
                                    "variable_workflow_01QPJN9OQPBZ41CQ3IjmqYxxy7u0ltmYktz": "$activity.definition_activity_01QXI1GGQNAGM5d6nsdblV5UELRhItEnps4.output.script_queries.URL Filter Name$",
                                    "variable_workflow_01QPKTY4TNQW91qT9tlWoF4rRvNteWdZJHD": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWWV8OOA64LdyclajeziyBPSXN0JFIC$"
                                  },
                                  "runtime_user": {
                                    "target_default": true
                                  },
                                  "skip_execution": false,
                                  "target": {
                                    "use_workflow_target_group": true
                                  },
                                  "workflow_id": "definition_workflow_01QPJN9P092ZK4B1nv7D0yaTHqYWenXdVIb"
                                },
                                "object_type": "definition_activity"
                              },
                              {
                                "unique_name": "definition_activity_01RHZMNLBE60R4gXL8YPi8CTdArWDABSu0G",
                                "name": "Condition Block",
                                "title": "Critical Error Occurred?",
                                "type": "logic.if_else",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Critical Error Occurred?",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "blocks": [
                                  {
                                    "unique_name": "definition_activity_01RHZMNQYTASP0kjxt5yCqQIWMzcP3kvDvY",
                                    "name": "Condition Branch",
                                    "title": "Yes",
                                    "type": "logic.condition_block",
                                    "base_type": "activity",
                                    "properties": {
                                      "condition": {
                                        "left_operand": "$activity.definition_activity_01RHQ45DJOV7K2jAqKpmfu42yEuphFzXlfL.output.succeeded$",
                                        "operator": "eq",
                                        "right_operand": false
                                      },
                                      "continue_on_failure": false,
                                      "display_name": "Yes",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "actions": [
                                      {
                                        "unique_name": "definition_activity_01RHZMNRQE3LF55BXeEjNWEpXpXBYGCNLRQ",
                                        "name": "Microsoft Teams - Post Message via Webhook",
                                        "title": "Microsoft Teams - Post Message via Webhook",
                                        "type": "workflow.atomic_workflow",
                                        "base_type": "subworkflow",
                                        "properties": {
                                          "continue_on_failure": false,
                                          "display_name": "Microsoft Teams - Post Message via Webhook",
                                          "input": {
                                            "variable_workflow_01MRIK9PFIH9457K2ZY1x7rEJvOPzYOE6eO": "MESSAGE FROM Fortinet - FortiGate - Block URL, IP or Domain",
                                            "variable_workflow_01MRIKICJKVS16L5nynmibtyxbFIqwxBhOV": "**\"$activity.definition_activity_01RIOAECX3AJW4hO4brPL8stca1aM8otrbw.output.script_queries.observable_value$\" observable handling failed.**\n\u003cbr/\u003e\n$activity.definition_activity_01RHQ45DJOV7K2jAqKpmfu42yEuphFzXlfL.output.error.message$",
                                            "variable_workflow_01MRIL2TKZ8FM1EvIZeO4VFV9ITFhG3vSlI": ""
                                          },
                                          "runtime_user": {
                                            "target_default": true
                                          },
                                          "skip_execution": false,
                                          "target": {
                                            "override_workflow_target_group_criteria": true,
                                            "target_group": {
                                              "run_on_all_targets": false,
                                              "use_criteria": {
                                                "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                                "conditions": [
                                                  {
                                                    "left_operand": "$targetgroup.target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH.common.display_name$",
                                                    "operator": "eqi",
                                                    "right_operand": "Microsoft Teams Webhook"
                                                  }
                                                ]
                                              }
                                            }
                                          },
                                          "workflow_id": "definition_workflow_01MRIE3B3DNNQ3cdFSoyGkg1RnVsYA9VdZr"
                                        },
                                        "object_type": "definition_activity"
                                      },
                                      {
                                        "unique_name": "definition_activity_01RHZMNXYOZ7B0XzwfHppsWKLYdK9rJ4plP",
                                        "name": "Completed",
                                        "title": "Failed",
                                        "type": "logic.completed",
                                        "base_type": "activity",
                                        "properties": {
                                          "completion_type": "failed-completed",
                                          "continue_on_failure": false,
                                          "display_name": "Failed",
                                          "result_message": "\"$activity.definition_activity_01RIOAECX3AJW4hO4brPL8stca1aM8otrbw.output.script_queries.observable_value$\" observable handling failed.\n \n$activity.definition_activity_01RHQ45DJOV7K2jAqKpmfu42yEuphFzXlfL.output.error.message$",
                                          "skip_execution": false
                                        },
                                        "object_type": "definition_activity"
                                      }
                                    ]
                                  }
                                ]
                              },
                              {
                                "unique_name": "definition_activity_01RHQ45JRMF2J3w70AIjyV93WxYfM2pYlFX",
                                "name": "Fortinet - FortiGate - Add Entry to Web Filter",
                                "title": "Fortinet - FortiGate - Add Entry to Web Filter",
                                "type": "workflow.atomic_workflow",
                                "base_type": "subworkflow",
                                "properties": {
                                  "continue_on_failure": true,
                                  "display_name": "Fortinet - FortiGate - Add Entry to Web Filter",
                                  "input": {
                                    "variable_workflow_01QDU1FYPFRCK220HdGrQT5E8q5rHtzPQn2": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QVNBNH9JTYK3NfHWwhAzXMl4rzC8QLGvm$",
                                    "variable_workflow_01QDU3BHG0FYX1YM6UUwzdhIYZFTDSLi8At": "$activity.definition_activity_01RHQ457BVXCA4YkT5xnx0yM2S3kUefCUi7.output.variable_workflow_01QDTLM4QXHW12V9W5Xnt87Cv6NZV2byJoP$",
                                    "variable_workflow_01QDUQU3ZBY9N7jboIgNoKcZdgUAQi1BtCD": "$activity.definition_activity_01RHQ45DJOV7K2jAqKpmfu42yEuphFzXlfL.output.variable_workflow_01QPJN9OQP3VF5AvZlRFEVyXuoNnuHRGrTI$"
                                  },
                                  "runtime_user": {
                                    "target_default": true
                                  },
                                  "skip_execution": false,
                                  "target": {
                                    "use_workflow_target_group": true
                                  },
                                  "workflow_id": "definition_workflow_01QDU1FYX531C0rakrXzq8h6BHdjcTDqqu6"
                                },
                                "object_type": "definition_activity"
                              },
                              {
                                "unique_name": "definition_activity_01RHZLIYT6JPB3iCeICdhBZgx5tNFudbT0F",
                                "name": "Condition Block",
                                "title": "Critical Error Occurred?",
                                "type": "logic.if_else",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Critical Error Occurred?",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "blocks": [
                                  {
                                    "unique_name": "definition_activity_01RHZLJ2DHVDD2pcNzyRAQAZCjpVqJr981f",
                                    "name": "Condition Branch",
                                    "title": "Yes",
                                    "type": "logic.condition_block",
                                    "base_type": "activity",
                                    "properties": {
                                      "condition": {
                                        "left_operand": "$activity.definition_activity_01RHQ45JRMF2J3w70AIjyV93WxYfM2pYlFX.output.succeeded$",
                                        "operator": "eq",
                                        "right_operand": false
                                      },
                                      "continue_on_failure": false,
                                      "display_name": "Yes",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "actions": [
                                      {
                                        "unique_name": "definition_activity_01RHZLJ32YWRI7aZfyYekgWScW7tEYuIlAa",
                                        "name": "Microsoft Teams - Post Message via Webhook",
                                        "title": "Microsoft Teams - Post Message via Webhook",
                                        "type": "workflow.atomic_workflow",
                                        "base_type": "subworkflow",
                                        "properties": {
                                          "continue_on_failure": false,
                                          "display_name": "Microsoft Teams - Post Message via Webhook",
                                          "input": {
                                            "variable_workflow_01MRIK9PFIH9457K2ZY1x7rEJvOPzYOE6eO": "MESSAGE FROM Fortinet - FortiGate - Block URL, IP or Domain",
                                            "variable_workflow_01MRIKICJKVS16L5nynmibtyxbFIqwxBhOV": "**\"$activity.definition_activity_01RIOAECX3AJW4hO4brPL8stca1aM8otrbw.output.script_queries.observable_value$\" observable handling failed.**\n\u003cbr/\u003e\n$activity.definition_activity_01RHQ45JRMF2J3w70AIjyV93WxYfM2pYlFX.output.error.message$",
                                            "variable_workflow_01MRIL2TKZ8FM1EvIZeO4VFV9ITFhG3vSlI": ""
                                          },
                                          "runtime_user": {
                                            "target_default": true
                                          },
                                          "skip_execution": false,
                                          "target": {
                                            "override_workflow_target_group_criteria": true,
                                            "target_group": {
                                              "run_on_all_targets": false,
                                              "use_criteria": {
                                                "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                                "conditions": [
                                                  {
                                                    "left_operand": "$targetgroup.target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH.common.display_name$",
                                                    "operator": "eqi",
                                                    "right_operand": "Microsoft Teams Webhook"
                                                  }
                                                ]
                                              }
                                            }
                                          },
                                          "workflow_id": "definition_workflow_01MRIE3B3DNNQ3cdFSoyGkg1RnVsYA9VdZr"
                                        },
                                        "object_type": "definition_activity"
                                      },
                                      {
                                        "unique_name": "definition_activity_01RHZLJ9C02BR7gQHlHZvHYhUzJBZBwL2oz",
                                        "name": "Completed",
                                        "title": "Failed",
                                        "type": "logic.completed",
                                        "base_type": "activity",
                                        "properties": {
                                          "completion_type": "failed-completed",
                                          "continue_on_failure": false,
                                          "display_name": "Failed",
                                          "result_message": "\"$activity.definition_activity_01RIOAECX3AJW4hO4brPL8stca1aM8otrbw.output.script_queries.observable_value$\" observable handling failed.\n \n$activity.definition_activity_01RHQ45JRMF2J3w70AIjyV93WxYfM2pYlFX.output.error.message$",
                                          "skip_execution": false
                                        },
                                        "object_type": "definition_activity"
                                      }
                                    ]
                                  }
                                ]
                              },
                              {
                                "unique_name": "definition_activity_01RIDCFYB4D7H7Sl2j2O1M80wDi2GHu43lO",
                                "name": "Microsoft Teams - Post Message via Webhook",
                                "title": "Microsoft Teams - Post Message via Webhook",
                                "type": "workflow.atomic_workflow",
                                "base_type": "subworkflow",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Microsoft Teams - Post Message via Webhook",
                                  "input": {
                                    "variable_workflow_01MRIK9PFIH9457K2ZY1x7rEJvOPzYOE6eO": "MESSAGE FROM Fortinet - FortiGate - Block URL, IP or Domain",
                                    "variable_workflow_01MRIKICJKVS16L5nynmibtyxbFIqwxBhOV": "Web Filter Name \"$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QENLZHPIVVI28kd2INwi2zuZncQeryxQr$\" was not found, but a new Web Filter with the name \"$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QENLZHPIVVI28kd2INwi2zuZncQeryxQr$\" was created instead.",
                                    "variable_workflow_01MRIL2TKZ8FM1EvIZeO4VFV9ITFhG3vSlI": ""
                                  },
                                  "runtime_user": {
                                    "target_default": true
                                  },
                                  "skip_execution": false,
                                  "target": {
                                    "override_workflow_target_group_criteria": true,
                                    "target_group": {
                                      "run_on_all_targets": false,
                                      "use_criteria": {
                                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                        "conditions": [
                                          {
                                            "left_operand": "$targetgroup.target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH.common.display_name$",
                                            "operator": "eqi",
                                            "right_operand": "Microsoft Teams Webhook"
                                          }
                                        ]
                                      }
                                    }
                                  },
                                  "workflow_id": "definition_workflow_01MRIE3B3DNNQ3cdFSoyGkg1RnVsYA9VdZr"
                                },
                                "object_type": "definition_activity"
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01QZ94V5S5I5H6DlCMIHZfbjUVtwPMRRklo",
                "name": "Condition Block",
                "title": "Web Filter name not provided?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Web Filter name not provided?",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01QZ94VDF8ULF4uWRjEMgpcYdwHYs77GBse",
                    "name": "Condition Branch",
                    "title": "No",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QENLZHPIVVI28kd2INwi2zuZncQeryxQr$",
                        "operator": "eq",
                        "right_operand": ""
                      },
                      "continue_on_failure": false,
                      "display_name": "No",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01QWIP68PRO0264NxkcVELi3LVnfOV56HmE",
                        "name": "Fortinet - FortiGate - Create Web Filter",
                        "title": "Fortinet - FortiGate - Create Web Filter",
                        "type": "workflow.atomic_workflow",
                        "base_type": "subworkflow",
                        "properties": {
                          "continue_on_failure": true,
                          "display_name": "Fortinet - FortiGate - Create Web Filter",
                          "input": {
                            "variable_workflow_01QDTLM4QXG6P1FISycNrsAW3Bpsp5CkK1I": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QVNBNH9JTYK3NfHWwhAzXMl4rzC8QLGvm$",
                            "variable_workflow_01QOP7FLZ0I667NsWzXGLQW76Pu96E73GyC": "$activity.definition_activity_01QXI1GGQNAGM5d6nsdblV5UELRhItEnps4.output.script_queries.Web Filter Name$",
                            "variable_workflow_01QOPAYKBF31P0sKTV6uNXMWOJYSXxNsNth": "root"
                          },
                          "runtime_user": {
                            "target_default": true
                          },
                          "skip_execution": false,
                          "target": {
                            "use_workflow_target_group": true
                          },
                          "workflow_id": "definition_workflow_01QDTLM4YSM301c4l0yOFGdfOheLwpbNvjT"
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01RHYWLV7TAXB3qnj9ftjTV7fWZD8s1vLjC",
                        "name": "Condition Block",
                        "title": "Critical Error Occurred?",
                        "type": "logic.if_else",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Critical Error Occurred?",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "blocks": [
                          {
                            "unique_name": "definition_activity_01RHYWM1TEYBH5dMf8PPyczL1nruVNx3xs3",
                            "name": "Condition Branch",
                            "title": "Yes",
                            "type": "logic.condition_block",
                            "base_type": "activity",
                            "properties": {
                              "condition": {
                                "left_operand": "$activity.definition_activity_01QWIP68PRO0264NxkcVELi3LVnfOV56HmE.output.succeeded$",
                                "operator": "eq",
                                "right_operand": false
                              },
                              "continue_on_failure": false,
                              "display_name": "Yes",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01RHYWM2K66304sGgYnt3D0GHvMgNLwYfdz",
                                "name": "Microsoft Teams - Post Message via Webhook",
                                "title": "Microsoft Teams - Post Message via Webhook",
                                "type": "workflow.atomic_workflow",
                                "base_type": "subworkflow",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Microsoft Teams - Post Message via Webhook",
                                  "input": {
                                    "variable_workflow_01MRIK9PFIH9457K2ZY1x7rEJvOPzYOE6eO": "MESSAGE FROM Fortinet - FortiGate - Block URL, IP or Domain",
                                    "variable_workflow_01MRIKICJKVS16L5nynmibtyxbFIqwxBhOV": "**\"$activity.definition_activity_01RIOAECX3AJW4hO4brPL8stca1aM8otrbw.output.script_queries.observable_value$\" observable handling failed.**\n\u003cbr/\u003e\n$activity.definition_activity_01QWIP68PRO0264NxkcVELi3LVnfOV56HmE.output.error.message$",
                                    "variable_workflow_01MRIL2TKZ8FM1EvIZeO4VFV9ITFhG3vSlI": ""
                                  },
                                  "runtime_user": {
                                    "target_default": true
                                  },
                                  "skip_execution": false,
                                  "target": {
                                    "override_workflow_target_group_criteria": true,
                                    "target_group": {
                                      "run_on_all_targets": false,
                                      "use_criteria": {
                                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                        "conditions": [
                                          {
                                            "left_operand": "$targetgroup.target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH.common.display_name$",
                                            "operator": "eqi",
                                            "right_operand": "Microsoft Teams Webhook"
                                          }
                                        ]
                                      }
                                    }
                                  },
                                  "workflow_id": "definition_workflow_01MRIE3B3DNNQ3cdFSoyGkg1RnVsYA9VdZr"
                                },
                                "object_type": "definition_activity"
                              },
                              {
                                "unique_name": "definition_activity_01RHYWM8Q42X574V2tRlgQBo7qeltzy87EX",
                                "name": "Completed",
                                "title": "Failed",
                                "type": "logic.completed",
                                "base_type": "activity",
                                "properties": {
                                  "completion_type": "failed-completed",
                                  "continue_on_failure": false,
                                  "display_name": "Failed",
                                  "result_message": "\"$activity.definition_activity_01RIOAECX3AJW4hO4brPL8stca1aM8otrbw.output.script_queries.observable_value$\" observable handling failed.\n \n$activity.definition_activity_01QWIP68PRO0264NxkcVELi3LVnfOV56HmE.output.error.message$",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity"
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "unique_name": "definition_activity_01QWIQ6N6CWE72n1dogga9W9j2mLlqUyfR1",
                        "name": "Fortinet - FortiGate - Create URL Filter",
                        "title": "Fortinet - FortiGate - Create URL Filter",
                        "type": "workflow.atomic_workflow",
                        "base_type": "subworkflow",
                        "properties": {
                          "continue_on_failure": true,
                          "display_name": "Fortinet - FortiGate - Create URL Filter",
                          "input": {
                            "variable_workflow_01QPJN9OQP82D67vM88JbpApXHH2HruIR44": "root",
                            "variable_workflow_01QPJN9OQP9XZ7FTwvYnhHFIa5MA8hboqMm": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QVNBNH9JTYK3NfHWwhAzXMl4rzC8QLGvm$",
                            "variable_workflow_01QPJN9OQPBZ41CQ3IjmqYxxy7u0ltmYktz": "$activity.definition_activity_01QXI1GGQNAGM5d6nsdblV5UELRhItEnps4.output.script_queries.URL Filter Name$",
                            "variable_workflow_01QPKTY4TNQW91qT9tlWoF4rRvNteWdZJHD": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWWV8OOA64LdyclajeziyBPSXN0JFIC$"
                          },
                          "runtime_user": {
                            "target_default": true
                          },
                          "skip_execution": false,
                          "target": {
                            "use_workflow_target_group": true
                          },
                          "workflow_id": "definition_workflow_01QPJN9P092ZK4B1nv7D0yaTHqYWenXdVIb"
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01RHYYD56VYS71YnAxTLlw2eQ77W3qPpjjF",
                        "name": "Condition Block",
                        "title": "Critical Error Occurred?",
                        "type": "logic.if_else",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Critical Error Occurred?",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "blocks": [
                          {
                            "unique_name": "definition_activity_01RHYYDBOPT181Nqjj9Q9XVdlME7eL9LvFY",
                            "name": "Condition Branch",
                            "title": "Yes",
                            "type": "logic.condition_block",
                            "base_type": "activity",
                            "properties": {
                              "condition": {
                                "left_operand": "$activity.definition_activity_01QWIQ6N6CWE72n1dogga9W9j2mLlqUyfR1.output.succeeded$",
                                "operator": "eq",
                                "right_operand": false
                              },
                              "continue_on_failure": false,
                              "display_name": "Yes",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01RHYYDCGI1P71pHMi9HvYdal5RJipLSSU0",
                                "name": "Microsoft Teams - Post Message via Webhook",
                                "title": "Microsoft Teams - Post Message via Webhook",
                                "type": "workflow.atomic_workflow",
                                "base_type": "subworkflow",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Microsoft Teams - Post Message via Webhook",
                                  "input": {
                                    "variable_workflow_01MRIK9PFIH9457K2ZY1x7rEJvOPzYOE6eO": "MESSAGE FROM Fortinet - FortiGate - Block URL, IP or Domain",
                                    "variable_workflow_01MRIKICJKVS16L5nynmibtyxbFIqwxBhOV": "**\"$activity.definition_activity_01RIOAECX3AJW4hO4brPL8stca1aM8otrbw.output.script_queries.observable_value$\" observable handling failed.**\n\u003cbr/\u003e\n$activity.definition_activity_01QWIQ6N6CWE72n1dogga9W9j2mLlqUyfR1.output.error.message$",
                                    "variable_workflow_01MRIL2TKZ8FM1EvIZeO4VFV9ITFhG3vSlI": ""
                                  },
                                  "runtime_user": {
                                    "target_default": true
                                  },
                                  "skip_execution": false,
                                  "target": {
                                    "override_workflow_target_group_criteria": true,
                                    "target_group": {
                                      "run_on_all_targets": false,
                                      "use_criteria": {
                                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                        "conditions": [
                                          {
                                            "left_operand": "$targetgroup.target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH.common.display_name$",
                                            "operator": "eqi",
                                            "right_operand": "Microsoft Teams Webhook"
                                          }
                                        ]
                                      }
                                    }
                                  },
                                  "workflow_id": "definition_workflow_01MRIE3B3DNNQ3cdFSoyGkg1RnVsYA9VdZr"
                                },
                                "object_type": "definition_activity"
                              },
                              {
                                "unique_name": "definition_activity_01RHYYDIQDSVZ7iUoMzkVjTfyUBQjTsd2OW",
                                "name": "Completed",
                                "title": "Failed",
                                "type": "logic.completed",
                                "base_type": "activity",
                                "properties": {
                                  "completion_type": "failed-completed",
                                  "continue_on_failure": false,
                                  "display_name": "Failed",
                                  "result_message": "\"$activity.definition_activity_01RIOAECX3AJW4hO4brPL8stca1aM8otrbw.output.script_queries.observable_value$\" observable handling failed.\n \n$activity.definition_activity_01QWIQ6N6CWE72n1dogga9W9j2mLlqUyfR1.output.error.message$",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity"
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "unique_name": "definition_activity_01QZMTOMBK07H62i0H7shoSywn5PHnqnpfL",
                        "name": "Fortinet - FortiGate - Add Entry to Web Filter",
                        "title": "Fortinet - FortiGate - Add Entry to Web Filter",
                        "type": "workflow.atomic_workflow",
                        "base_type": "subworkflow",
                        "properties": {
                          "continue_on_failure": true,
                          "display_name": "Fortinet - FortiGate - Add Entry to Web Filter",
                          "input": {
                            "variable_workflow_01QDU1FYPFRCK220HdGrQT5E8q5rHtzPQn2": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QVNBNH9JTYK3NfHWwhAzXMl4rzC8QLGvm$",
                            "variable_workflow_01QDU3BHG0FYX1YM6UUwzdhIYZFTDSLi8At": "$activity.definition_activity_01QWIP68PRO0264NxkcVELi3LVnfOV56HmE.output.variable_workflow_01QDTLM4QXHW12V9W5Xnt87Cv6NZV2byJoP$",
                            "variable_workflow_01QDUQU3ZBY9N7jboIgNoKcZdgUAQi1BtCD": "$activity.definition_activity_01QWIQ6N6CWE72n1dogga9W9j2mLlqUyfR1.output.variable_workflow_01QPJN9OQP3VF5AvZlRFEVyXuoNnuHRGrTI$"
                          },
                          "runtime_user": {
                            "target_default": true
                          },
                          "skip_execution": false,
                          "target": {
                            "use_workflow_target_group": true
                          },
                          "workflow_id": "definition_workflow_01QDU1FYX531C0rakrXzq8h6BHdjcTDqqu6"
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01RHYZEOYGM151P4pbKJIGhsMMsEbW7Odxw",
                        "name": "Condition Block",
                        "title": "Critical Error Occurred?",
                        "type": "logic.if_else",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Critical Error Occurred?",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "blocks": [
                          {
                            "unique_name": "definition_activity_01RHYZEV9J0NF4pzkTr09qMF9rDFYEMsH1a",
                            "name": "Condition Branch",
                            "title": "Yes",
                            "type": "logic.condition_block",
                            "base_type": "activity",
                            "properties": {
                              "condition": {
                                "left_operand": "$activity.definition_activity_01QZMTOMBK07H62i0H7shoSywn5PHnqnpfL.output.succeeded$",
                                "operator": "eq",
                                "right_operand": false
                              },
                              "continue_on_failure": false,
                              "display_name": "Yes",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01RHYZEVZDCD03O3ioFjIUc5Jo7RnWuiEdC",
                                "name": "Microsoft Teams - Post Message via Webhook",
                                "title": "Microsoft Teams - Post Message via Webhook",
                                "type": "workflow.atomic_workflow",
                                "base_type": "subworkflow",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Microsoft Teams - Post Message via Webhook",
                                  "input": {
                                    "variable_workflow_01MRIK9PFIH9457K2ZY1x7rEJvOPzYOE6eO": "MESSAGE FROM Fortinet - FortiGate - Block URL, IP or Domain",
                                    "variable_workflow_01MRIKICJKVS16L5nynmibtyxbFIqwxBhOV": "**\"$activity.definition_activity_01RIOAECX3AJW4hO4brPL8stca1aM8otrbw.output.script_queries.observable_value$\" observable handling failed.**\n\u003cbr/\u003e\n$activity.definition_activity_01QZMTOMBK07H62i0H7shoSywn5PHnqnpfL.output.error.message$",
                                    "variable_workflow_01MRIL2TKZ8FM1EvIZeO4VFV9ITFhG3vSlI": ""
                                  },
                                  "runtime_user": {
                                    "target_default": true
                                  },
                                  "skip_execution": false,
                                  "target": {
                                    "override_workflow_target_group_criteria": true,
                                    "target_group": {
                                      "run_on_all_targets": false,
                                      "use_criteria": {
                                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                        "conditions": [
                                          {
                                            "left_operand": "$targetgroup.target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH.common.display_name$",
                                            "operator": "eqi",
                                            "right_operand": "Microsoft Teams Webhook"
                                          }
                                        ]
                                      }
                                    }
                                  },
                                  "workflow_id": "definition_workflow_01MRIE3B3DNNQ3cdFSoyGkg1RnVsYA9VdZr"
                                },
                                "object_type": "definition_activity"
                              },
                              {
                                "unique_name": "definition_activity_01RHYZF29ZOSD5hha1Yrh6bHbi4AbqIwp0G",
                                "name": "Completed",
                                "title": "Failed",
                                "type": "logic.completed",
                                "base_type": "activity",
                                "properties": {
                                  "completion_type": "failed-completed",
                                  "continue_on_failure": false,
                                  "display_name": "Failed",
                                  "result_message": "\"$activity.definition_activity_01RIOAECX3AJW4hO4brPL8stca1aM8otrbw.output.script_queries.observable_value$\" observable handling failed.\n \n$activity.definition_activity_01QWIQ6N6CWE72n1dogga9W9j2mLlqUyfR1.output.error.message$",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity"
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "unique_name": "definition_activity_01QZMD7CFWB0962KGgdVNFh6uXvqCliPJgQ",
                        "name": "Set Variables",
                        "title": "Set Variable Web Filter Name",
                        "type": "core.set_multiple_variables",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Set Variable Web Filter Name",
                          "skip_execution": false,
                          "variables_to_update": [
                            {
                              "variable_to_update": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QENLZHPIVVI28kd2INwi2zuZncQeryxQr$",
                              "variable_value_new": "$activity.definition_activity_01QWIP68PRO0264NxkcVELi3LVnfOV56HmE.output.variable_workflow_01QDTLM4QXHW12V9W5Xnt87Cv6NZV2byJoP$"
                            }
                          ]
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01QYE7616RGZY1VsDZhccONoTGbEOhoLYd4",
                "name": "Set Variables",
                "title": "Clear extra inputs if present",
                "type": "core.set_multiple_variables",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "description": "Clear Address Group if it was set as it not needed",
                  "display_name": "Clear extra inputs if present",
                  "skip_execution": false,
                  "variables_to_update": [
                    {
                      "variable_to_update": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QENMB1Z1RQH358zoMEikzjGBvYRvrdvlA$",
                      "variable_value_new": ""
                    }
                  ]
                },
                "object_type": "definition_activity"
              }
            ]
          },
          {
            "unique_name": "definition_activity_01QWI5VPNMUJW108a33gEJz8JDNDV9ltm0K",
            "name": "Condition Branch",
            "title": "Anything Else",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": {
                  "left_operand": {
                    "left_operand": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWPO1WE3738QmwiLwBJbXce3agNJ7Kk$",
                    "operator": "ne",
                    "right_operand": "ip"
                  },
                  "operator": "and",
                  "right_operand": {
                    "left_operand": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWPO1WE3738QmwiLwBJbXce3agNJ7Kk$",
                    "operator": "ne",
                    "right_operand": "domain"
                  }
                },
                "operator": "or",
                "right_operand": {
                  "left_operand": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWPO1WE3738QmwiLwBJbXce3agNJ7Kk$",
                  "operator": "eq",
                  "right_operand": "url"
                }
              },
              "continue_on_failure": false,
              "display_name": "Anything Else",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01RHW19TFZ6Z65qLxohRX3VLxoznwpEZRZx",
                "name": "Microsoft Teams - Post Message via Webhook",
                "title": "Microsoft Teams - Post Message via Webhook",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Microsoft Teams - Post Message via Webhook",
                  "input": {
                    "variable_workflow_01MRIK9PFIH9457K2ZY1x7rEJvOPzYOE6eO": "MESSAGE FROM Fortinet - FortiGate - Block URL, IP or Domain",
                    "variable_workflow_01MRIKICJKVS16L5nynmibtyxbFIqwxBhOV": "**\"$activity.definition_activity_01RIOAECX3AJW4hO4brPL8stca1aM8otrbw.output.script_queries.observable_value$\" observable handling failed.**\n\u003cbr/\u003e\nThe observable_type \"$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWPO1WE3738QmwiLwBJbXce3agNJ7Kk$\" is not supported by this workflow.",
                    "variable_workflow_01MRIL2TKZ8FM1EvIZeO4VFV9ITFhG3vSlI": ""
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "override_workflow_target_group_criteria": true,
                    "target_group": {
                      "run_on_all_targets": false,
                      "use_criteria": {
                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                        "conditions": [
                          {
                            "left_operand": "$targetgroup.target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH.common.display_name$",
                            "operator": "eqi",
                            "right_operand": "Microsoft Teams Webhook"
                          }
                        ]
                      }
                    }
                  },
                  "workflow_id": "definition_workflow_01MRIE3B3DNNQ3cdFSoyGkg1RnVsYA9VdZr"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01QWIIX8P941C4J5Xibf1d0MkXo5UImzdBz",
                "name": "Completed",
                "title": "Failed",
                "type": "logic.completed",
                "base_type": "activity",
                "properties": {
                  "completion_type": "failed-completed",
                  "continue_on_failure": false,
                  "display_name": "Failed",
                  "result_message": " \"$activity.definition_activity_01RIOAECX3AJW4hO4brPL8stca1aM8otrbw.output.script_queries.observable_value$\" observable handling failed.\n \nThis observable_type  $workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWPO1WE3738QmwiLwBJbXce3agNJ7Kk$ is not supported by this workflow.",
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_01QYE8SSQ2M3K4OcaSjkO4WDxih52IlGdQz",
        "name": "Execute Python Script",
        "title": "Define Policy Action",
        "type": "python3.script",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "continue_on_failure": false,
          "display_name": "Define Policy Action",
          "script": "from sys import argv\nobservable_type = argv[1]\naction = \"deny\"\nif observable_type == \"url\":\n   action = \"accept\"\n",
          "script_arguments": [
            "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWPO1WE3738QmwiLwBJbXce3agNJ7Kk$"
          ],
          "script_queries": [
            {
              "script_query": "action",
              "script_query_name": "Action",
              "script_query_type": "string"
            }
          ],
          "skip_execution": false
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_01QXHJIZ26FHZ423VHybsJPWguBGG9M7qlA",
        "name": "Condition Block",
        "title": "Policy Name Provided?",
        "type": "logic.if_else",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": true,
          "display_name": "Policy Name Provided?",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "blocks": [
          {
            "unique_name": "definition_activity_01QXHJJ2QX2292GeAtcgVnZl2tXpnnyfRZ3",
            "name": "Condition Branch",
            "title": "Yes",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QXHR8UGUKKV3PzLWDz5cd9wfGxZ0M0WBc$",
                "operator": "ne",
                "right_operand": ""
              },
              "continue_on_failure": false,
              "display_name": "Yes",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01QXHTNT61F0A5WCqSPHjDsKbfuiX1WenlJ",
                "name": "Fortinet - FortiGate - Search for Policy by Name",
                "title": "Fortinet - FortiGate - Search for Policy by Name",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": true,
                  "display_name": "Fortinet - FortiGate - Search for Policy by Name",
                  "input": {
                    "variable_workflow_01QIUK02DI1IF4L5JSfJ1dW6v53vUb5sKrd": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QVNBNH9JTYK3NfHWwhAzXMl4rzC8QLGvm$",
                    "variable_workflow_01QIUK02DI2PR41Jf3FNKjTlsvabn7pRwAJ": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QXHR8UGUKKV3PzLWDz5cd9wfGxZ0M0WBc$",
                    "variable_workflow_01QZ7S20AIWUG4syV8kHuL1uInjCRVDLDJs": "root"
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "use_workflow_target_group": true
                  },
                  "workflow_id": "definition_workflow_01QIUK02LX1IV6JwzN4GYkZHhcTIw3RRTzf"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01QXHU2KX5ZBA6zhgKIkyPjsRilD3A7D5Xv",
                "name": "Condition Block",
                "title": "Policy Name found?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Policy Name found?",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01QXHU2RE0NWY7ffYrem1923BGy0UOcZpkm",
                    "name": "Condition Branch",
                    "title": "Yes",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01QXHTNT61F0A5WCqSPHjDsKbfuiX1WenlJ.output.succeeded$",
                        "operator": "eq",
                        "right_operand": true
                      },
                      "continue_on_failure": false,
                      "display_name": "Yes",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01QZND0TWXH2L61WfLZvJOStH2Wt7eehRfk",
                        "name": "JSONPath Query",
                        "title": "Extract Policy Action",
                        "type": "corejava.jsonpathquery",
                        "base_type": "activity",
                        "properties": {
                          "action_timeout": 180,
                          "continue_on_failure": true,
                          "display_name": "Extract Policy Action",
                          "input_json": "$activity.definition_activity_01QXHTNT61F0A5WCqSPHjDsKbfuiX1WenlJ.output.variable_workflow_01QIUK02DI7JL4sgSk2xE8cVHVvCv30Hgas$",
                          "jsonpath_queries": [
                            {
                              "jsonpath_query": ".results[0].action",
                              "jsonpath_query_name": "Action",
                              "jsonpath_query_type": "string"
                            }
                          ],
                          "skip_execution": false
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01QZNCS9L2MLO2zUMEuQJsqLoIWrJ98RR3v",
                        "name": "Condition Block",
                        "title": "Action correct?",
                        "type": "logic.if_else",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Action correct?",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "blocks": [
                          {
                            "unique_name": "definition_activity_01QZNCSGKD51454Khjol3rFna66Ro7uk1Ph",
                            "name": "Condition Branch",
                            "title": "Yes",
                            "type": "logic.condition_block",
                            "base_type": "activity",
                            "properties": {
                              "condition": {
                                "left_operand": {
                                  "left_operand": "$activity.definition_activity_01QYE8SSQ2M3K4OcaSjkO4WDxih52IlGdQz.output.script_queries.Action$",
                                  "operator": "eqi",
                                  "right_operand": "$activity.definition_activity_01QZND0TWXH2L61WfLZvJOStH2Wt7eehRfk.output.jsonpath_queries.Action$"
                                },
                                "operator": "and",
                                "right_operand": {
                                  "left_operand": "$activity.definition_activity_01QZND0TWXH2L61WfLZvJOStH2Wt7eehRfk.output.succeeded$",
                                  "operator": "eq",
                                  "right_operand": true
                                }
                              },
                              "continue_on_failure": false,
                              "display_name": "Yes",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01QXHTIHWWDL40UqaZ9D05Hdb9KzR7V7FaA",
                                "name": "Fortinet - FortiGate - Update Firewall Policy",
                                "title": "Fortinet - FortiGate - Update Firewall Policy",
                                "type": "workflow.atomic_workflow",
                                "base_type": "subworkflow",
                                "properties": {
                                  "continue_on_failure": true,
                                  "display_name": "Fortinet - FortiGate - Update Firewall Policy",
                                  "input": {
                                    "variable_workflow_01QNX6UNA0R2440XMUMiAAL1zqP9YwBrOUC": "$activity.definition_activity_01QXHTNT61F0A5WCqSPHjDsKbfuiX1WenlJ.output.variable_workflow_01QIUK02DI7JL4sgSk2xE8cVHVvCv30Hgas$",
                                    "variable_workflow_01QNX6UNA0WA022tb2ooU9vbzpN6TovSCiC": "$activity.definition_activity_01QXHTNT61F0A5WCqSPHjDsKbfuiX1WenlJ.output.variable_workflow_01QIUK02DHUFV5m3AAJ9VSfPBXcC36ZMSTB$",
                                    "variable_workflow_01QNX6UNA0ZY73OjTb7JSXIDO1uivd13tDq": "",
                                    "variable_workflow_01QNX6UNA15056jt8u1hL24BzMRo5ZSzL25": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QVNBNH9JTYK3NfHWwhAzXMl4rzC8QLGvm$",
                                    "variable_workflow_01QNX6UNA16KB5NHApxJFEu93dlrxEdD7DK": "root",
                                    "variable_workflow_01QNZNYDZ0G953p4PSo6QbYK3xG0Mhhoymi": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QENMB1Z1RQH358zoMEikzjGBvYRvrdvlA$",
                                    "variable_workflow_01QNZPXCL0G923vude6JTUJukZjKxAnKpRB": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QENLZHPIVVI28kd2INwi2zuZncQeryxQr$"
                                  },
                                  "runtime_user": {
                                    "target_default": true
                                  },
                                  "skip_execution": false,
                                  "target": {
                                    "use_workflow_target_group": true
                                  },
                                  "workflow_id": "definition_workflow_01QNX6UNITCLT5hFo0PqHo1Ajkua15WaSmO"
                                },
                                "object_type": "definition_activity"
                              },
                              {
                                "unique_name": "definition_activity_01RHWB6TEOH2N6jsJFjjv6zUL6epYlktdgw",
                                "name": "Condition Block",
                                "title": "Critical Error Occurred?",
                                "type": "logic.if_else",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Critical Error Occurred?",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "blocks": [
                                  {
                                    "unique_name": "definition_activity_01RHWB6X72SYM28PcD2AKPcnju9sMUegA70",
                                    "name": "Condition Branch",
                                    "title": "No",
                                    "type": "logic.condition_block",
                                    "base_type": "activity",
                                    "properties": {
                                      "condition": {
                                        "left_operand": "$activity.definition_activity_01QXHTIHWWDL40UqaZ9D05Hdb9KzR7V7FaA.output.succeeded$",
                                        "operator": "eq",
                                        "right_operand": false
                                      },
                                      "continue_on_failure": false,
                                      "display_name": "No",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "actions": [
                                      {
                                        "unique_name": "definition_activity_01RHWDE3W3SGA3LKj9HLiIAugUBujmdaHXI",
                                        "name": "Microsoft Teams - Post Message via Webhook",
                                        "title": "Microsoft Teams - Post Message via Webhook",
                                        "type": "workflow.atomic_workflow",
                                        "base_type": "subworkflow",
                                        "properties": {
                                          "continue_on_failure": false,
                                          "display_name": "Microsoft Teams - Post Message via Webhook",
                                          "input": {
                                            "variable_workflow_01MRIK9PFIH9457K2ZY1x7rEJvOPzYOE6eO": "MESSAGE FROM Fortinet - FortiGate - Block URL, IP or Domain",
                                            "variable_workflow_01MRIKICJKVS16L5nynmibtyxbFIqwxBhOV": "**\"$activity.definition_activity_01RIOAECX3AJW4hO4brPL8stca1aM8otrbw.output.script_queries.observable_value$\" observable handling failed.**\n\u003cbr/\u003e\n$activity.definition_activity_01QXHTIHWWDL40UqaZ9D05Hdb9KzR7V7FaA.output.error.message$",
                                            "variable_workflow_01MRIL2TKZ8FM1EvIZeO4VFV9ITFhG3vSlI": ""
                                          },
                                          "runtime_user": {
                                            "target_default": true
                                          },
                                          "skip_execution": false,
                                          "target": {
                                            "override_workflow_target_group_criteria": true,
                                            "target_group": {
                                              "run_on_all_targets": false,
                                              "use_criteria": {
                                                "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                                "conditions": [
                                                  {
                                                    "left_operand": "$targetgroup.target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH.common.display_name$",
                                                    "operator": "eqi",
                                                    "right_operand": "Microsoft Teams Webhook"
                                                  }
                                                ]
                                              }
                                            }
                                          },
                                          "workflow_id": "definition_workflow_01MRIE3B3DNNQ3cdFSoyGkg1RnVsYA9VdZr"
                                        },
                                        "object_type": "definition_activity"
                                      },
                                      {
                                        "unique_name": "definition_activity_01RHWFNRDQAJP7Rq8A0yeRaP2WDvKB67Gqw",
                                        "name": "Completed",
                                        "title": "Failed",
                                        "type": "logic.completed",
                                        "base_type": "activity",
                                        "properties": {
                                          "completion_type": "failed-completed",
                                          "continue_on_failure": false,
                                          "display_name": "Failed",
                                          "result_message": "\"$activity.definition_activity_01RIOAECX3AJW4hO4brPL8stca1aM8otrbw.output.script_queries.observable_value$\" observable handling failed.\n$activity.definition_activity_01QXHTIHWWDL40UqaZ9D05Hdb9KzR7V7FaA.output.error.message$",
                                          "skip_execution": false
                                        },
                                        "object_type": "definition_activity"
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "unique_name": "definition_activity_01QZNCSH9J97V4STIzEBQUn9i6Gvvpc5WVB",
                            "name": "Condition Branch",
                            "title": "No",
                            "type": "logic.condition_block",
                            "base_type": "activity",
                            "properties": {
                              "condition": {
                                "left_operand": {
                                  "left_operand": "$activity.definition_activity_01QZND0TWXH2L61WfLZvJOStH2Wt7eehRfk.output.jsonpath_queries.Action$",
                                  "operator": "ne",
                                  "right_operand": "$activity.definition_activity_01QYE8SSQ2M3K4OcaSjkO4WDxih52IlGdQz.output.script_queries.Action$"
                                },
                                "operator": "or",
                                "right_operand": {
                                  "left_operand": "$activity.definition_activity_01QZND0TWXH2L61WfLZvJOStH2Wt7eehRfk.output.succeeded$",
                                  "operator": "eq",
                                  "right_operand": false
                                }
                              },
                              "continue_on_failure": false,
                              "display_name": "No",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01RIH0YKI6K5A2SpujtiANNksSyXhDbUAYL",
                                "name": "Microsoft Teams - Post Message via Webhook",
                                "title": "Microsoft Teams - Post Message via Webhook",
                                "type": "workflow.atomic_workflow",
                                "base_type": "subworkflow",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Microsoft Teams - Post Message via Webhook",
                                  "input": {
                                    "variable_workflow_01MRIK9PFIH9457K2ZY1x7rEJvOPzYOE6eO": "MESSAGE FROM Fortinet - FortiGate - Block URL, IP or Domain",
                                    "variable_workflow_01MRIKICJKVS16L5nynmibtyxbFIqwxBhOV": "The Policy \"$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QXHR8UGUKKV3PzLWDz5cd9wfGxZ0M0WBc$\" has the wrong action (**$activity.definition_activity_01QZND0TWXH2L61WfLZvJOStH2Wt7eehRfk.output.jsonpath_queries.Action$** instead of **$activity.definition_activity_01QYE8SSQ2M3K4OcaSjkO4WDxih52IlGdQz.output.script_queries.Action$**), so a new Policy will be created.",
                                    "variable_workflow_01MRIL2TKZ8FM1EvIZeO4VFV9ITFhG3vSlI": ""
                                  },
                                  "runtime_user": {
                                    "target_default": true
                                  },
                                  "skip_execution": false,
                                  "target": {
                                    "override_workflow_target_group_criteria": true,
                                    "target_group": {
                                      "run_on_all_targets": false,
                                      "use_criteria": {
                                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                        "conditions": [
                                          {
                                            "left_operand": "$targetgroup.target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH.common.display_name$",
                                            "operator": "eqi",
                                            "right_operand": "Microsoft Teams Webhook"
                                          }
                                        ]
                                      }
                                    }
                                  },
                                  "workflow_id": "definition_workflow_01MRIE3B3DNNQ3cdFSoyGkg1RnVsYA9VdZr"
                                },
                                "object_type": "definition_activity"
                              },
                              {
                                "unique_name": "definition_activity_01QZNG5ASDZY24z4eu5PAelvJoPBpwcjQGP",
                                "name": "Set Variables",
                                "title": "Set Variable Wrong Policy Action",
                                "type": "core.set_multiple_variables",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Set Variable Wrong Policy Action",
                                  "skip_execution": false,
                                  "variables_to_update": [
                                    {
                                      "variable_to_update": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QZNHEJDR7FC4pDu5xtcEhXqjDYuHgYhUt$",
                                      "variable_value_new": true
                                    }
                                  ]
                                },
                                "object_type": "definition_activity"
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "unique_name": "definition_activity_01RHUY007S6VH5IUz6MrOkPcChdUtTJiZLA",
                    "name": "Condition Branch",
                    "title": "No",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01QXHTNT61F0A5WCqSPHjDsKbfuiX1WenlJ.output.succeeded$",
                        "operator": "eq",
                        "right_operand": false
                      },
                      "continue_on_failure": false,
                      "display_name": "No",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01RICTHA7F09R5jj1hBCaKu6ZVIzdwU4331",
                        "name": "Condition Block",
                        "title": "Critical Error Occurred?",
                        "type": "logic.if_else",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Critical Error Occurred?",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "blocks": [
                          {
                            "unique_name": "definition_activity_01RICTHDQQNQH6XXdzFbZtaEGwpIT5S6p1j",
                            "name": "Condition Branch",
                            "title": "Yes",
                            "type": "logic.condition_block",
                            "base_type": "activity",
                            "properties": {
                              "condition": {
                                "left_operand": "$activity.definition_activity_01QXHTNT61F0A5WCqSPHjDsKbfuiX1WenlJ.output.error.message$",
                                "operator": "mw",
                                "right_operand": "Status Code:"
                              },
                              "continue_on_failure": false,
                              "display_name": "Yes",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01RICTHEGNTA651ooZK7oaxlw03Qs51CuMD",
                                "name": "Microsoft Teams - Post Message via Webhook",
                                "title": "Microsoft Teams - Post Message via Webhook",
                                "type": "workflow.atomic_workflow",
                                "base_type": "subworkflow",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Microsoft Teams - Post Message via Webhook",
                                  "input": {
                                    "variable_workflow_01MRIK9PFIH9457K2ZY1x7rEJvOPzYOE6eO": "MESSAGE FROM Fortinet - FortiGate - Block URL, IP or Domain",
                                    "variable_workflow_01MRIKICJKVS16L5nynmibtyxbFIqwxBhOV": "**\"$activity.definition_activity_01RIOAECX3AJW4hO4brPL8stca1aM8otrbw.output.script_queries.observable_value$\" observable handling failed.**\n\u003cbr/\u003e\n$activity.definition_activity_01QXHTNT61F0A5WCqSPHjDsKbfuiX1WenlJ.output.error.message$",
                                    "variable_workflow_01MRIL2TKZ8FM1EvIZeO4VFV9ITFhG3vSlI": ""
                                  },
                                  "runtime_user": {
                                    "target_default": true
                                  },
                                  "skip_execution": false,
                                  "target": {
                                    "override_workflow_target_group_criteria": true,
                                    "target_group": {
                                      "run_on_all_targets": false,
                                      "use_criteria": {
                                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                        "conditions": [
                                          {
                                            "left_operand": "$targetgroup.target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH.common.display_name$",
                                            "operator": "eqi",
                                            "right_operand": "Microsoft Teams Webhook"
                                          }
                                        ]
                                      }
                                    }
                                  },
                                  "workflow_id": "definition_workflow_01MRIE3B3DNNQ3cdFSoyGkg1RnVsYA9VdZr"
                                },
                                "object_type": "definition_activity"
                              },
                              {
                                "unique_name": "definition_activity_01RICTHL15VEX17zkceVhIBX5FeVKBraizn",
                                "name": "Completed",
                                "title": "Failed",
                                "type": "logic.completed",
                                "base_type": "activity",
                                "properties": {
                                  "completion_type": "failed-completed",
                                  "continue_on_failure": false,
                                  "display_name": "Failed",
                                  "result_message": " \"$activity.definition_activity_01RIOAECX3AJW4hO4brPL8stca1aM8otrbw.output.script_queries.observable_value$\" observable handling failed.\n \n$activity.definition_activity_01QXHTNT61F0A5WCqSPHjDsKbfuiX1WenlJ.output.error.message$",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity"
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "unique_name": "definition_activity_01QXHPLMUF9MW7OU92cO68J5A894ajQuARu",
                        "name": "Fortinet - Create Firewall Policy",
                        "title": "Fortinet - Create Firewall Policy",
                        "type": "workflow.atomic_workflow",
                        "base_type": "subworkflow",
                        "properties": {
                          "continue_on_failure": true,
                          "display_name": "Fortinet - Create Firewall Policy",
                          "input": {
                            "variable_workflow_01QEKYC6NLUY01wNt1j7ZE7dX5FRo7AHclU": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QENLZHPIVVI28kd2INwi2zuZncQeryxQr$",
                            "variable_workflow_01QEKYC6NM3EZ3biMNp14AAr4Xt4cnAW7oo": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QVNBNH9JTYK3NfHWwhAzXMl4rzC8QLGvm$",
                            "variable_workflow_01QENMW1213UT0Dd0NnaSmzCwtvdpqEFy01": "",
                            "variable_workflow_01QENN5K8VOH4209wiKKonbcMpW7qHgdB4l": "",
                            "variable_workflow_01QHXEVCCL0NG1kqFXbO2K8WzTcQeqEiSOW": "",
                            "variable_workflow_01QHXFEOX0FUH6A5VGkORz8y0SsG8SWCLBS": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QENMB1Z1RQH358zoMEikzjGBvYRvrdvlA$",
                            "variable_workflow_01QHXGJ3NBMN8476dbsFaHZ1G5UQ7oA4iKV": "$activity.definition_activity_01QYE8SSQ2M3K4OcaSjkO4WDxih52IlGdQz.output.script_queries.Action$",
                            "variable_workflow_01QHXR0MUE9A55M1Jmtb6EUmVVBzEhR4r1F": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QXHR8UGUKKV3PzLWDz5cd9wfGxZ0M0WBc$",
                            "variable_workflow_01QZ7D0M9PNUC4Z3zAHPZBFuhNfP9HfA5RL": "root"
                          },
                          "runtime_user": {
                            "target_default": true
                          },
                          "skip_execution": false,
                          "target": {
                            "use_workflow_target_group": true
                          },
                          "workflow_id": "definition_workflow_01QEKYC6UW4XZ1w1cPVACPX85Vy4BJAAbq5"
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01RICS59E4LBJ73pEBBQyEYUI8qfHmU5KsU",
                        "name": "Condition Block",
                        "title": "Critical Error Occurred?",
                        "type": "logic.if_else",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Critical Error Occurred?",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "blocks": [
                          {
                            "unique_name": "definition_activity_01RICS5G66BHO2kWN7W1HyPDOS9toVr1LeF",
                            "name": "Condition Branch",
                            "title": "Yes",
                            "type": "logic.condition_block",
                            "base_type": "activity",
                            "properties": {
                              "condition": {
                                "left_operand": "$activity.definition_activity_01QXHPLMUF9MW7OU92cO68J5A894ajQuARu.output.succeeded$",
                                "operator": "eq",
                                "right_operand": false
                              },
                              "continue_on_failure": false,
                              "display_name": "Yes",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01RICS5GXISKC4a0tJEHKu2joXb8mWdqS9s",
                                "name": "Microsoft Teams - Post Message via Webhook",
                                "title": "Microsoft Teams - Post Message via Webhook",
                                "type": "workflow.atomic_workflow",
                                "base_type": "subworkflow",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Microsoft Teams - Post Message via Webhook",
                                  "input": {
                                    "variable_workflow_01MRIK9PFIH9457K2ZY1x7rEJvOPzYOE6eO": "MESSAGE FROM Fortinet - FortiGate - Block URL, IP or Domain",
                                    "variable_workflow_01MRIKICJKVS16L5nynmibtyxbFIqwxBhOV": "**\"$activity.definition_activity_01RIOAECX3AJW4hO4brPL8stca1aM8otrbw.output.script_queries.observable_value$\" observable handling failed.**\n\u003cbr/\u003e\n$activity.definition_activity_01QXHPLMUF9MW7OU92cO68J5A894ajQuARu.output.error.message$",
                                    "variable_workflow_01MRIL2TKZ8FM1EvIZeO4VFV9ITFhG3vSlI": ""
                                  },
                                  "runtime_user": {
                                    "target_default": true
                                  },
                                  "skip_execution": false,
                                  "target": {
                                    "override_workflow_target_group_criteria": true,
                                    "target_group": {
                                      "run_on_all_targets": false,
                                      "use_criteria": {
                                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                        "conditions": [
                                          {
                                            "left_operand": "$targetgroup.target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH.common.display_name$",
                                            "operator": "eqi",
                                            "right_operand": "Microsoft Teams Webhook"
                                          }
                                        ]
                                      }
                                    }
                                  },
                                  "workflow_id": "definition_workflow_01MRIE3B3DNNQ3cdFSoyGkg1RnVsYA9VdZr"
                                },
                                "object_type": "definition_activity"
                              },
                              {
                                "unique_name": "definition_activity_01RICS5N4TU1M1Nd5NQCsQytTOKLXCCyVob",
                                "name": "Completed",
                                "title": "Failed",
                                "type": "logic.completed",
                                "base_type": "activity",
                                "properties": {
                                  "completion_type": "failed-completed",
                                  "continue_on_failure": false,
                                  "display_name": "Failed",
                                  "result_message": "\"$activity.definition_activity_01RIOAECX3AJW4hO4brPL8stca1aM8otrbw.output.script_queries.observable_value$\" observable handling failed.\n \n$activity.definition_activity_01QXHPLMUF9MW7OU92cO68J5A894ajQuARu.output.error.message$",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity"
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "unique_name": "definition_activity_01RIDFE93EEJZ4f4JHdlCKEWVQHr8rUkWUn",
                        "name": "Microsoft Teams - Post Message via Webhook",
                        "title": "Microsoft Teams - Post Message via Webhook",
                        "type": "workflow.atomic_workflow",
                        "base_type": "subworkflow",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Microsoft Teams - Post Message via Webhook",
                          "input": {
                            "variable_workflow_01MRIK9PFIH9457K2ZY1x7rEJvOPzYOE6eO": "MESSAGE FROM Fortinet - FortiGate - Block URL, IP or Domain",
                            "variable_workflow_01MRIKICJKVS16L5nynmibtyxbFIqwxBhOV": "Policy Name \"$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QXHR8UGUKKV3PzLWDz5cd9wfGxZ0M0WBc$\" was not found, but a new Policy with the name \"$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QXHR8UGUKKV3PzLWDz5cd9wfGxZ0M0WBc$\" was created instead.",
                            "variable_workflow_01MRIL2TKZ8FM1EvIZeO4VFV9ITFhG3vSlI": ""
                          },
                          "runtime_user": {
                            "target_default": true
                          },
                          "skip_execution": false,
                          "target": {
                            "override_workflow_target_group_criteria": true,
                            "target_group": {
                              "run_on_all_targets": false,
                              "use_criteria": {
                                "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                "conditions": [
                                  {
                                    "left_operand": "$targetgroup.target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH.common.display_name$",
                                    "operator": "eqi",
                                    "right_operand": "Microsoft Teams Webhook"
                                  }
                                ]
                              }
                            }
                          },
                          "workflow_id": "definition_workflow_01MRIE3B3DNNQ3cdFSoyGkg1RnVsYA9VdZr"
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_01QXHSDRUWJ153pNQe22Mz0noFmfLj8qVf7",
        "name": "Condition Block",
        "title": "Policy Name not provided or has wrong action?",
        "type": "logic.if_else",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Policy Name not provided or has wrong action?",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "blocks": [
          {
            "unique_name": "definition_activity_01QXHJJ3FLJX442Q7Ueu8mbE7r7lbN8m3sF",
            "name": "Condition Branch",
            "title": "Yes",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": {
                  "left_operand": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QXHR8UGUKKV3PzLWDz5cd9wfGxZ0M0WBc$",
                  "operator": "eq",
                  "right_operand": ""
                },
                "operator": "or",
                "right_operand": {
                  "left_operand": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QZNHEJDR7FC4pDu5xtcEhXqjDYuHgYhUt$",
                  "operator": "eq",
                  "right_operand": true
                }
              },
              "continue_on_failure": false,
              "display_name": "Yes",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01RHT1SAIXBJX0nr3JFhsUkPH6m23Drjbpd",
                "name": "Fortinet - Create Firewall Policy",
                "title": "Fortinet - Create Firewall Policy",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": true,
                  "display_name": "Fortinet - Create Firewall Policy",
                  "input": {
                    "variable_workflow_01QEKYC6NLUY01wNt1j7ZE7dX5FRo7AHclU": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QENLZHPIVVI28kd2INwi2zuZncQeryxQr$",
                    "variable_workflow_01QEKYC6NM3EZ3biMNp14AAr4Xt4cnAW7oo": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QVNBNH9JTYK3NfHWwhAzXMl4rzC8QLGvm$",
                    "variable_workflow_01QENMW1213UT0Dd0NnaSmzCwtvdpqEFy01": "",
                    "variable_workflow_01QENN5K8VOH4209wiKKonbcMpW7qHgdB4l": "",
                    "variable_workflow_01QHXEVCCL0NG1kqFXbO2K8WzTcQeqEiSOW": "",
                    "variable_workflow_01QHXFEOX0FUH6A5VGkORz8y0SsG8SWCLBS": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QENMB1Z1RQH358zoMEikzjGBvYRvrdvlA$",
                    "variable_workflow_01QHXGJ3NBMN8476dbsFaHZ1G5UQ7oA4iKV": "$activity.definition_activity_01QYE8SSQ2M3K4OcaSjkO4WDxih52IlGdQz.output.script_queries.Action$",
                    "variable_workflow_01QHXR0MUE9A55M1Jmtb6EUmVVBzEhR4r1F": "$activity.definition_activity_01QXI1GGQNAGM5d6nsdblV5UELRhItEnps4.output.script_queries.Policy Name$",
                    "variable_workflow_01QZ7D0M9PNUC4Z3zAHPZBFuhNfP9HfA5RL": "root"
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "use_workflow_target_group": true
                  },
                  "workflow_id": "definition_workflow_01QEKYC6UW4XZ1w1cPVACPX85Vy4BJAAbq5"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01RQZEKQ3VOCA4ru07MW47JClZgiOumDdwN",
                "name": "Condition Block",
                "title": "Critical Error Occurred?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Critical Error Occurred?",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01RQZEKQ3W8VC5ceeqdSAtkmbn7cfGVJ3N0",
                    "name": "Condition Branch",
                    "title": "Yes",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01RHT1SAIXBJX0nr3JFhsUkPH6m23Drjbpd.output.succeeded$",
                        "operator": "eq",
                        "right_operand": false
                      },
                      "continue_on_failure": false,
                      "display_name": "Yes",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01RQZEKQ3Z8CV6Hrdnk68zpb1NS1OT1fLdD",
                        "name": "Microsoft Teams - Post Message via Webhook",
                        "title": "Microsoft Teams - Post Message via Webhook",
                        "type": "workflow.atomic_workflow",
                        "base_type": "subworkflow",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Microsoft Teams - Post Message via Webhook",
                          "input": {
                            "variable_workflow_01MRIK9PFIH9457K2ZY1x7rEJvOPzYOE6eO": "MESSAGE FROM Fortinet - FortiGate - Block URL, IP or Domain",
                            "variable_workflow_01MRIKICJKVS16L5nynmibtyxbFIqwxBhOV": "**\"$activity.definition_activity_01RIOAECX3AJW4hO4brPL8stca1aM8otrbw.output.script_queries.observable_value$\" observable handling failed.**\n\u003cbr/\u003e\n$activity.definition_activity_01RHT1SAIXBJX0nr3JFhsUkPH6m23Drjbpd.output.error.message$",
                            "variable_workflow_01MRIL2TKZ8FM1EvIZeO4VFV9ITFhG3vSlI": ""
                          },
                          "runtime_user": {
                            "target_default": true
                          },
                          "skip_execution": false,
                          "target": {
                            "override_workflow_target_group_criteria": true,
                            "target_group": {
                              "run_on_all_targets": false,
                              "use_criteria": {
                                "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                "conditions": [
                                  {
                                    "left_operand": "$targetgroup.target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH.common.display_name$",
                                    "operator": "eqi",
                                    "right_operand": "Microsoft Teams Webhook"
                                  }
                                ]
                              }
                            }
                          },
                          "workflow_id": "definition_workflow_01MRIE3B3DNNQ3cdFSoyGkg1RnVsYA9VdZr"
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01RQZEKQ414007G8YbFmsjYE45GUENrYorB",
                        "name": "Completed",
                        "title": "Failed",
                        "type": "logic.completed",
                        "base_type": "activity",
                        "properties": {
                          "completion_type": "failed-completed",
                          "continue_on_failure": false,
                          "display_name": "Failed",
                          "result_message": "\"$activity.definition_activity_01RIOAECX3AJW4hO4brPL8stca1aM8otrbw.output.script_queries.observable_value$\" observable handling failed.\n \n$activity.definition_activity_01RHT1SAIXBJX0nr3JFhsUkPH6m23Drjbpd.output.error.message$",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01QYFWKRDAUTX2Y3vgn4Cqoiu4sMqcXfuKT",
                "name": "Set Variables",
                "title": "Set Variable Policy Name",
                "type": "core.set_multiple_variables",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Set Variable Policy Name",
                  "skip_execution": false,
                  "variables_to_update": [
                    {
                      "variable_to_update": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QXHR8UGUKKV3PzLWDz5cd9wfGxZ0M0WBc$",
                      "variable_value_new": "$activity.definition_activity_01QXI1GGQNAGM5d6nsdblV5UELRhItEnps4.output.script_queries.Policy Name$"
                    }
                  ]
                },
                "object_type": "definition_activity"
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_01RQZ9810JZ6E4ani1c6ILDi23iH7iuiG9f",
        "name": "Fortinet - FortiGate - Move Policy on Top of the Policies List",
        "title": "Fortinet - FortiGate - Move Policy on Top of the Policies List",
        "type": "workflow.atomic_workflow",
        "base_type": "subworkflow",
        "properties": {
          "continue_on_failure": true,
          "display_name": "Fortinet - FortiGate - Move Policy on Top of the Policies List",
          "input": {
            "variable_workflow_01RL0ZYDSSTEA1H5YdUxbC5WZf3PGU31zBk": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QXHR8UGUKKV3PzLWDz5cd9wfGxZ0M0WBc$",
            "variable_workflow_01RL0ZYDST2F13RUNFmIaNqBBtT4MtsXvlX": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QVNBNH9JTYK3NfHWwhAzXMl4rzC8QLGvm$",
            "variable_workflow_01RL0ZYDST3YY33jZNgUsLBKnkFoRa7Vgcs": "root"
          },
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "use_workflow_target_group": true
          },
          "workflow_id": "definition_workflow_01RL0ZYE7UHXO0nAMEa55KHOiiLLvVzSQwX"
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_01RQZBGJDELEO7KQSv8NcaPr60gWqAPN50k",
        "name": "Condition Block",
        "title": "Critical Error Occurred?",
        "type": "logic.if_else",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Critical Error Occurred?",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "blocks": [
          {
            "unique_name": "definition_activity_01RQZBGJDF5YT6CkZbn0ffYd6n43p7zmlEi",
            "name": "Condition Branch",
            "title": "Yes",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$activity.definition_activity_01RQZ9810JZ6E4ani1c6ILDi23iH7iuiG9f.output.succeeded$",
                "operator": "eq",
                "right_operand": false
              },
              "continue_on_failure": false,
              "display_name": "Yes",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01RQZBGJDIQQZ5lzNcBtt3myJdQyTr4U1cW",
                "name": "Microsoft Teams - Post Message via Webhook",
                "title": "Microsoft Teams - Post Message via Webhook",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Microsoft Teams - Post Message via Webhook",
                  "input": {
                    "variable_workflow_01MRIK9PFIH9457K2ZY1x7rEJvOPzYOE6eO": "MESSAGE FROM Fortinet - FortiGate - Block URL, IP or Domain",
                    "variable_workflow_01MRIKICJKVS16L5nynmibtyxbFIqwxBhOV": "**\"$activity.definition_activity_01RIOAECX3AJW4hO4brPL8stca1aM8otrbw.output.script_queries.observable_value$\" observable handling failed.**\n\u003cbr/\u003e\n$activity.definition_activity_01RQZ9810JZ6E4ani1c6ILDi23iH7iuiG9f.output.error.message$",
                    "variable_workflow_01MRIL2TKZ8FM1EvIZeO4VFV9ITFhG3vSlI": ""
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "override_workflow_target_group_criteria": true,
                    "target_group": {
                      "run_on_all_targets": false,
                      "use_criteria": {
                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                        "conditions": [
                          {
                            "left_operand": "$targetgroup.target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH.common.display_name$",
                            "operator": "eqi",
                            "right_operand": "Microsoft Teams Webhook"
                          }
                        ]
                      }
                    }
                  },
                  "workflow_id": "definition_workflow_01MRIE3B3DNNQ3cdFSoyGkg1RnVsYA9VdZr"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01RQZBGJDKPCD60Ud1mM8sovTg4grm3z9pS",
                "name": "Completed",
                "title": "Failed",
                "type": "logic.completed",
                "base_type": "activity",
                "properties": {
                  "completion_type": "failed-completed",
                  "continue_on_failure": false,
                  "display_name": "Failed",
                  "result_message": "\"$activity.definition_activity_01RIOAECX3AJW4hO4brPL8stca1aM8otrbw.output.script_queries.observable_value$\" observable handling failed.\n \n$activity.definition_activity_01RQZ9810JZ6E4ani1c6ILDi23iH7iuiG9f.output.error.message$",
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_01QYED09JUF4607UQWwkS6Sr9Z42wQk3eSy",
        "name": "Execute Python Script",
        "title": "Create Message",
        "type": "python3.script",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "continue_on_failure": false,
          "display_name": "Create Message",
          "script": "import sys\nimport json\nobservable_type = sys.argv[1]\nobservable_value = sys.argv[6]\nresult_message = None\ntitle = ''\nif observable_type == \"domain\":\n    title = f'## {observable_type.capitalize()} \"{observable_value}\" handled successfully'\nelse:\n    title = f'## {observable_type.upper()} \"{observable_value}\" handled successfully'\nentities = [(\"Policy Name\", sys.argv[5])]\nif observable_type == \"url\":\n    entities.append(\n        (\"Web Filter Name\", sys.argv[4])\n    )\nelse:\n    entities += [(\"Address Name\", sys.argv[2]), (\"Address Group Name\", sys.argv[3])]\nsuccess_message = [title]\nfor entity in entities:\n        success_message.append(\n        f\"**{entity[0]}**: {entity[1]}\"\n        )\nresult_message = '\\n\\n'.join(success_message)",
          "script_arguments": [
            "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWPO1WE3738QmwiLwBJbXce3agNJ7Kk$",
            "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QXEW7YBXKOA67nOxzUyeafXXO7sWUTTyr$",
            "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QENMB1Z1RQH358zoMEikzjGBvYRvrdvlA$",
            "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QENLZHPIVVI28kd2INwi2zuZncQeryxQr$",
            "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QXHR8UGUKKV3PzLWDz5cd9wfGxZ0M0WBc$",
            "$activity.definition_activity_01RIOAECX3AJW4hO4brPL8stca1aM8otrbw.output.script_queries.observable_value$"
          ],
          "script_queries": [
            {
              "script_query": "result_message",
              "script_query_name": "Result  Message",
              "script_query_type": "string"
            }
          ],
          "skip_execution": false
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_01QZLP0NPIBNF4hqpFbSW9ThQ99eStbUnHU",
        "name": "Microsoft Teams - Post Message via Webhook",
        "title": "Microsoft Teams - Post Message via Webhook",
        "type": "workflow.atomic_workflow",
        "base_type": "subworkflow",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Microsoft Teams - Post Message via Webhook",
          "input": {
            "variable_workflow_01MRIK9PFIH9457K2ZY1x7rEJvOPzYOE6eO": "MESSAGE FROM Fortinet - FortiGate - Block URL, IP or Domain",
            "variable_workflow_01MRIKICJKVS16L5nynmibtyxbFIqwxBhOV": "$activity.definition_activity_01QYED09JUF4607UQWwkS6Sr9Z42wQk3eSy.output.script_queries.Result  Message$",
            "variable_workflow_01MRIL2TKZ8FM1EvIZeO4VFV9ITFhG3vSlI": ""
          },
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "override_workflow_target_group_criteria": true,
            "target_group": {
              "run_on_all_targets": false,
              "use_criteria": {
                "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                "conditions": [
                  {
                    "left_operand": "$targetgroup.target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH.common.display_name$",
                    "operator": "eqi",
                    "right_operand": "Microsoft Teams Webhook"
                  }
                ]
              }
            }
          },
          "workflow_id": "definition_workflow_01MRIE3B3DNNQ3cdFSoyGkg1RnVsYA9VdZr"
        },
        "object_type": "definition_activity"
      }
    ],
    "categories": [
      "category_01FM7CGPZZCMY0KcvgiGjVH5UaB4y4aDJ7m",
      "category_01QKFKSJE1EJI1NoiNr1VfmBDywTaAMKWSH"
    ]
  },
  "categories": {
    "category_01FM7CGPZZCMY0KcvgiGjVH5UaB4y4aDJ7m": {
      "unique_name": "category_01FM7CGPZZCMY0KcvgiGjVH5UaB4y4aDJ7m",
      "name": "response",
      "title": "response",
      "type": "basic.category",
      "base_type": "category",
      "category_type": "custom",
      "object_type": "category"
    },
    "category_01QKFKSJE1EJI1NoiNr1VfmBDywTaAMKWSH": {
      "unique_name": "category_01QKFKSJE1EJI1NoiNr1VfmBDywTaAMKWSH",
      "name": "FortiGate",
      "title": "FortiGate",
      "type": "basic.category",
      "base_type": "category",
      "category_type": "custom",
      "object_type": "category"
    }
  },
  "target_groups": {
    "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH": {
      "unique_name": "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH",
      "name": "Default TargetGroup",
      "title": "Default TargetGroup",
      "type": "generic.target_group",
      "base_type": "target_group",
      "version": "1.0.0",
      "targets": [
        {
          "data_target_type": "web-service.endpoint",
          "view_target_type": "web-service.endpoint",
          "include_all_targets": true
        },
        {
          "data_target_type": "email.smtp_endpoint",
          "view_target_type": "email.smtp_endpoint",
          "include_all_targets": true
        }
      ],
      "object_type": "target_group"
    }
  },
  "atomic_workflows": [
    "definition_workflow_01Q2H2423CNMQ55zxmxIlndVdm1FyYI9WvB",
    "definition_workflow_01QJMY7EFE9EB0dUuvozT00neDnloTNQN05",
    "definition_workflow_01QDTLM4YSM301c4l0yOFGdfOheLwpbNvjT",
    "definition_workflow_01QDU1FYX531C0rakrXzq8h6BHdjcTDqqu6",
    "definition_workflow_01QIUK02LX1IV6JwzN4GYkZHhcTIw3RRTzf",
    "definition_workflow_01QNX6UNITCLT5hFo0PqHo1Ajkua15WaSmO",
    "definition_workflow_01MRIE3B3DNNQ3cdFSoyGkg1RnVsYA9VdZr",
    "definition_workflow_01QTSQI5IY61E0eT05l4mbwyexR2rwtaSYl",
    "definition_workflow_01QKJSE0LURMP1XIO79isiyUAXKTDDZeCGV",
    "definition_workflow_01RL0ZYE7UHXO0nAMEa55KHOiiLLvVzSQwX",
    "definition_workflow_01QTTUMDSUU0L6hykgyzvov9DIbC8YZyISv",
    "definition_workflow_01QPJN9P092ZK4B1nv7D0yaTHqYWenXdVIb",
    "definition_workflow_01QEKYC6UW4XZ1w1cPVACPX85Vy4BJAAbq5",
    "definition_workflow_01QCYG8UTYAXE2w8zM3Mn9RTBQXaMPNNl6e"
  ]
}