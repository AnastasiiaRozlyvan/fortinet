{
  "workflow": {
    "unique_name": "definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J",
    "name": "Fortinet - FortiGate - Request Threat Containment",
    "title": "Fortinet - FortiGate - Request Threat Containment",
    "type": "generic.workflow",
    "base_type": "workflow",
    "variables": [
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Destination Address Group Name",
          "type": "datatype.string",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01SBBU6YZFLHU7ivu9e9Rki8KhZrxORq6sR",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "ip",
          "scope": "input",
          "name": "observable_type",
          "type": "datatype.string",
          "is_required": true,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01S6BK8PJICEO1Sw0YZtdaQjtmobwyW8Tu9",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Source Address Name",
          "type": "datatype.string",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01SB9OQ9J4RMT3JaxuNkO5BbVQBcn1GOOC1",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.boolean",
        "properties": {
          "value": false,
          "scope": "local",
          "name": "Wrong Policy Action",
          "type": "datatype.boolean",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01SBE4UJDYJF52tMYY5CyhoutfZ3mi5RF4n",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Service Name",
          "type": "datatype.string",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01SBAKR6SYUQ12lXhdq78P30h0yFJuIcDLC",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "SXo",
          "scope": "local",
          "name": "Prefix",
          "type": "datatype.string",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01SB9LG5ALPAB7SVBpxRQNCpK6FQSnPe9Kj",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.secure_string",
        "properties": {
          "value": "*****",
          "scope": "local",
          "name": "Access Token",
          "type": "datatype.secure_string",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01S6BPQESSX1J2lrfBrlSyllQkTIdm3uQoe",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Source Group Address Name",
          "type": "datatype.string",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01SBBTW2WA37M2fvFzuIJBMyCa7GRg7ldDO",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Policy Name",
          "type": "datatype.string",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01SBD5N18ZK7Z5l1EvvX4lRhjBDNkLL1VMI",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "{\"Destination Host IP\":\"9.9.9.9\",\"Source Host IP\":\"6.6.6.6\",\"Access Action\":\"allow\",\"Access Policy Name\":\"AO_Policy1635163787486\",\"Protocol\":\"TCP\",\"ServiceNow Task ID\":\"71be94e32f9330102d00d5ccf699b66e\",\"Destination Port\":\"90\"}",
          "scope": "input",
          "name": "observable_value",
          "type": "datatype.string",
          "is_required": true,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01S6BKDUZAOOA57IxSfv5jb9bQXWEkREkVR",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Destination Address Name",
          "type": "datatype.string",
          "description": "Name of the object to handle destination address.",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01SB9PIPECCAL4L4Nb6HY857fnW7uLpEx71",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Service Group Name",
          "type": "datatype.string",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01SBATZ1JBTRB4y0iIpXGZkYfJNPnktOXPO",
        "object_type": "variable_workflow"
      }
    ],
    "properties": {
      "atomic": {
        "is_atomic": false
      },
      "delete_workflow_instance": false,
      "display_name": "Fortinet - FortiGate - Request Threat Containment",
      "runtime_user": {
        "target_default": true
      },
      "target": {
        "execute_on_target_group": true,
        "target_group": {
          "target_group_id": "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH",
          "run_on_all_targets": false,
          "selected_target_types": [
            "web-service.endpoint"
          ],
          "use_criteria": {
            "choose_target_using_algorithm": "choose_first_with_matching_criteria",
            "conditions": [
              {
                "operator": "eqi",
                "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                "right_operand": "FortiGate_API"
              }
            ]
          }
        }
      }
    },
    "object_type": "definition_workflow",
    "actions": [
      {
        "unique_name": "definition_activity_01SBFRZPMC5XH4y9ws02Umtm7b6VoWnc827",
        "name": "Execute Python Script",
        "title": "Parse input data",
        "type": "python3.script",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "continue_on_failure": false,
          "display_name": "Parse input data",
          "script": "import json\nimport sys\n\ndef read_possible_range_value(value):\n    value = [part.strip() for part in value.split('-')]\n    return '-'.join(value)\n\ndef read_protocol(protocol):\n    assert protocol in ('tcp', 'udp')\n    return protocol\n\ndef read_action(action):\n    action_mapping = {'allow': 'allow', 'block': 'deny'}\n    return action_mapping[action.lower()]\n#\ninput_data = json.loads(sys.argv[1])\ndestination_address = None\ndestination_address_type = None\nsource_address = None\nsource_address_type = None\ndestination_service = None\nprotocol = None\npre_rule = None\naction = None\nsn_task_id = None\nerror = None\nerror_mapping = {\n    KeyError: 'Input Data Error. Input JSON is not valid.',\n    AttributeError: \"Input Data Error. Destination port (port range) can't be empty.\",\n    AssertionError: \"Input Data Error. The protocol has to be one of TCP or UDP.\"\n}\ntry:\n    sn_task_id = input_data[\"ServiceNow Task ID\"]\n    destination_address = read_possible_range_value(input_data[\"Destination Host IP\"])\n    source_address = read_possible_range_value(input_data[\"Source Host IP\"])\n    destination_service = read_possible_range_value(input_data[\"Destination Port\"])\n    protocol = read_protocol(input_data[\"Protocol\"].lower())\n    pre_rule = input_data[\"Access Policy Name\"]\n    action = read_action(input_data[\"Access Action\"])\nexcept tuple(error_mapping) as exception:\n    error = error_mapping[exception.__class__]",
          "script_arguments": [
            "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.input.variable_workflow_01S6BKDUZAOOA57IxSfv5jb9bQXWEkREkVR$"
          ],
          "script_queries": [
            {
              "script_query": "destination_address",
              "script_query_name": "Destination Address",
              "script_query_type": "string"
            },
            {
              "script_query": "source_address",
              "script_query_name": "Source Address",
              "script_query_type": "string"
            },
            {
              "script_query": "destination_service",
              "script_query_name": "Destination Service",
              "script_query_type": "string"
            },
            {
              "script_query": "pre_rule",
              "script_query_name": "Policy",
              "script_query_type": "string"
            },
            {
              "script_query": "protocol",
              "script_query_name": "Protocol",
              "script_query_type": "string"
            },
            {
              "script_query": "sn_task_id",
              "script_query_name": "ServiceNow Task ID",
              "script_query_type": "string"
            },
            {
              "script_query": "action",
              "script_query_name": "Action",
              "script_query_type": "string"
            },
            {
              "script_query": "error",
              "script_query_name": "Error",
              "script_query_type": "string"
            }
          ],
          "skip_execution": false
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_01SBJA5P5PVTH4udV0aPb4n5u3Y0gp9555f",
        "name": "Condition Block",
        "title": "Input Data Valid?",
        "type": "logic.if_else",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Input Data Valid?",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "blocks": [
          {
            "unique_name": "definition_activity_01SBJA5P5R7H03ssL4sm0b6oCdfiLEdHYUG",
            "name": "Condition Branch",
            "title": "No",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$activity.definition_activity_01SBFRZPMC5XH4y9ws02Umtm7b6VoWnc827.output.script_queries.Error$",
                "operator": "ne",
                "right_operand": "None"
              },
              "continue_on_failure": false,
              "display_name": "No",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01SBJA5P5VU9W0zXdEUTzHWVOjWQTLjINqG",
                "name": "ServiceNow - Add Work Note to Firewall Rule Task",
                "title": "ServiceNow - Add Work Note to Firewall Rule Task",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "ServiceNow - Add Work Note to Firewall Rule Task",
                  "input": {
                    "variable_workflow_01O26LHVKETWS6NlqDRxw7LozFb5PYuORuj": "$activity.definition_activity_01SBFRZPMC5XH4y9ws02Umtm7b6VoWnc827.output.script_queries.ServiceNow Task ID$",
                    "variable_workflow_01O26LHVKEV5Z72XukftJQPOqPzsRpLGjzl": "[code]\u003ch2\u003eMessage from Fortinet - FortiGate - Request Threat Containment \u003c/h2\u003e[/code]\n$activity.definition_activity_01SBFRZPMC5XH4y9ws02Umtm7b6VoWnc827.output.script_queries.Error$",
                    "variable_workflow_01OX8KRPV34425GXjwybtQzddzhwdSmpqmk": "v2"
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "override_workflow_target_group_criteria": true,
                    "target_group": {
                      "run_on_all_targets": false,
                      "use_criteria": {
                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                        "conditions": [
                          {
                            "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                            "operator": "eqi",
                            "right_operand": "ServiceNow_API"
                          }
                        ]
                      }
                    }
                  },
                  "workflow_id": "definition_workflow_01O26LHVR14XR5ggjibxICB3qkpqZ7HuQmc"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01SBJA5P5XNQS1YSna58lXqwSkBhcCEKgNd",
                "name": "Completed",
                "title": "Failed",
                "type": "logic.completed",
                "base_type": "activity",
                "properties": {
                  "completion_type": "failed-completed",
                  "continue_on_failure": false,
                  "display_name": "Failed",
                  "result_message": "Failed to process Threat Containment Request.\n$activity.definition_activity_01SBFRZPMC5XH4y9ws02Umtm7b6VoWnc827.output.script_queries.Error$",
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_01S6BMEIXZ6WS3mEx1m9TOdUDSPuUPMuyS6",
        "name": "Parallel Block",
        "title": "Parallel Block",
        "type": "logic.parallel",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Parallel Block",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "blocks": [
          {
            "unique_name": "definition_activity_01S6BMI0RQPUQ50mmyUKVqJFHdPRwwhTIwk",
            "name": "Parallel Branch",
            "title": "Service",
            "type": "logic.parallel_block",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Service",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01S6CL78DL9P94y712dpJy4QcIhVEpTdy1U",
                "name": "Fortinet - FortiGate - Search Services by Port \u0026 Protocol",
                "title": "Fortinet - FortiGate - Search Services by Port \u0026 Protocol",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": true,
                  "display_name": "Fortinet - FortiGate - Search Services by Port \u0026 Protocol",
                  "input": {
                    "variable_workflow_01RZGRP01HV426OpM4AeePOPt4hqh6VJjlM": "root",
                    "variable_workflow_01RZGRP01IJ2E0mcgGdwPbpM54YuoYMtpJk": "$activity.definition_activity_01SBFRZPMC5XH4y9ws02Umtm7b6VoWnc827.output.script_queries.Destination Service$",
                    "variable_workflow_01RZGRP01IT581rtrzoBzi2T8u0XQTTcAGB": "",
                    "variable_workflow_01RZGRP01JAME7VMCJTHkWlC5zKEdJeOWjW": "$activity.definition_activity_01SBFRZPMC5XH4y9ws02Umtm7b6VoWnc827.output.script_queries.Protocol$",
                    "variable_workflow_01RZGRP01K29Q62g6JcSb2otssHL4HrpNjC": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01S6BPQESSX1J2lrfBrlSyllQkTIdm3uQoe$",
                    "variable_workflow_01S170KOVU2T41ajc44gcKExByQulifdAcv": "0.0.0.0"
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "use_workflow_target_group": true
                  },
                  "workflow_id": "definition_workflow_01RZGROZT4HXO7Yzmi2GzZtLdMJTJ4MB2tQ"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01SBJ2GU3H7YK00NahvLFjdpocMsyzu16Ut",
                "name": "Condition Block",
                "title": "Critical Error Occurred?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Critical Error Occurred?",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01SBJ2GUCGG881AKoHx2jkDudDmhwlV4V7c",
                    "name": "Condition Branch",
                    "title": "Yes",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": {
                          "left_operand": "$activity.definition_activity_01S6CL78DL9P94y712dpJy4QcIhVEpTdy1U.output.error.message$",
                          "operator": "mw",
                          "right_operand": "Status code:"
                        },
                        "operator": "and",
                        "right_operand": {
                          "left_operand": "$activity.definition_activity_01S6CL78DL9P94y712dpJy4QcIhVEpTdy1U.output.succeeded$",
                          "operator": "eq",
                          "right_operand": false
                        }
                      },
                      "continue_on_failure": false,
                      "display_name": "Yes",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01SBJ42AXSX5C4Sa9DN7xlPDwVZ1FfDpCJc",
                        "name": "ServiceNow - Add Work Note to Firewall Rule Task",
                        "title": "ServiceNow - Add Work Note to Firewall Rule Task",
                        "type": "workflow.atomic_workflow",
                        "base_type": "subworkflow",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "ServiceNow - Add Work Note to Firewall Rule Task",
                          "input": {
                            "variable_workflow_01O26LHVKETWS6NlqDRxw7LozFb5PYuORuj": "$activity.definition_activity_01SBFRZPMC5XH4y9ws02Umtm7b6VoWnc827.output.script_queries.ServiceNow Task ID$",
                            "variable_workflow_01O26LHVKEV5Z72XukftJQPOqPzsRpLGjzl": "[code]\u003ch2\u003eMessage from Fortinet - FortiGate - Request Threat Containment \u003c/h2\u003e[/code]\n$activity.definition_activity_01S6CL78DL9P94y712dpJy4QcIhVEpTdy1U.output.error.message$",
                            "variable_workflow_01OX8KRPV34425GXjwybtQzddzhwdSmpqmk": "v2"
                          },
                          "runtime_user": {
                            "target_default": true
                          },
                          "skip_execution": false,
                          "target": {
                            "override_workflow_target_group_criteria": true,
                            "target_group": {
                              "run_on_all_targets": false,
                              "use_criteria": {
                                "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                "conditions": [
                                  {
                                    "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                    "operator": "eqi",
                                    "right_operand": "ServiceNow_API"
                                  }
                                ]
                              }
                            }
                          },
                          "workflow_id": "definition_workflow_01O26LHVR14XR5ggjibxICB3qkpqZ7HuQmc"
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01SBJ5TUNPOR62uwfxReEQ9nDWFgKc7eVZn",
                        "name": "Completed",
                        "title": "Failed",
                        "type": "logic.completed",
                        "base_type": "activity",
                        "properties": {
                          "completion_type": "failed-completed",
                          "continue_on_failure": false,
                          "display_name": "Failed",
                          "result_message": "Failed to process Threat Containment Request.\n$activity.definition_activity_01S6CL78DL9P94y712dpJy4QcIhVEpTdy1U.output.error.message$",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01S6FSOKKUJ6M78yijfBC3dkxo4kqTgq3rz",
                "name": "Condition Block",
                "title": "Service found?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Service found?",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01SBALMOL5J3Y6WdrfDJiEWOm8rS1p10X7O",
                    "name": "Condition Branch",
                    "title": "Yes",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01S6CL78DL9P94y712dpJy4QcIhVEpTdy1U.output.succeeded$",
                        "operator": "eq",
                        "right_operand": true
                      },
                      "continue_on_failure": false,
                      "display_name": "Yes",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01SBALMOLCCZG0sOP8wupnw4ze3rqP2hdPN",
                        "name": "Set Variables",
                        "title": "Set Variable",
                        "type": "core.set_multiple_variables",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Set Variable",
                          "skip_execution": false,
                          "variables_to_update": [
                            {
                              "variable_to_update": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBAKR6SYUQ12lXhdq78P30h0yFJuIcDLC$",
                              "variable_value_new": "$activity.definition_activity_01S6CL78DL9P94y712dpJy4QcIhVEpTdy1U.output.variable_workflow_01RZGRP01JIRW4450N3QfWxouVF3G9PV3pf$"
                            }
                          ]
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  },
                  {
                    "unique_name": "definition_activity_01S6FSOKS4INE15iw4JVIPALAz5b8DLNQ9e",
                    "name": "Condition Branch",
                    "title": "No",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01S6CL78DL9P94y712dpJy4QcIhVEpTdy1U.output.succeeded$",
                        "operator": "eq",
                        "right_operand": false
                      },
                      "continue_on_failure": false,
                      "display_name": "No",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01SBAIHHJH6ZL4CLLx4C7ues1vZuEBME9lm",
                        "name": "Execute Python Script",
                        "title": "Generate UUID to create unique name",
                        "type": "python3.script",
                        "base_type": "activity",
                        "properties": {
                          "action_timeout": 180,
                          "continue_on_failure": false,
                          "display_name": "Generate UUID to create unique name",
                          "script": "from sys import argv\nfrom uuid import uuid4\n\nprefix = argv[1]\nservice_name = f\"{prefix}-Service-{uuid4()}\"",
                          "script_arguments": [
                            "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SB9LG5ALPAB7SVBpxRQNCpK6FQSnPe9Kj$"
                          ],
                          "script_queries": [
                            {
                              "script_query": "service_name",
                              "script_query_name": "Service Name",
                              "script_query_type": "string"
                            }
                          ],
                          "skip_execution": false
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01SBAEM7HTBEB0ZEpT0OKh6ELGjbVw6YmBv",
                        "name": "Fortinet - FortiGate - Create Service",
                        "title": "Fortinet - FortiGate - Create Service",
                        "type": "workflow.atomic_workflow",
                        "base_type": "subworkflow",
                        "properties": {
                          "continue_on_failure": true,
                          "display_name": "Fortinet - FortiGate - Create Service",
                          "input": {
                            "variable_workflow_01RV9ELI8N87P2dO8bXsq5JMJ7lwIk6Bssh": "root",
                            "variable_workflow_01RV9ELI8NIER0waKCBzZuDb3FM4FzI4elf": "",
                            "variable_workflow_01RV9ELI8NQTO1uehKtBKQV3hnw4CWmQTLq": "$activity.definition_activity_01SBAIHHJH6ZL4CLLx4C7ues1vZuEBME9lm.output.script_queries.Service Name$",
                            "variable_workflow_01RV9ELI8O8HR62K8iBpbeDnZ48YQ4vlzHk": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01S6BPQESSX1J2lrfBrlSyllQkTIdm3uQoe$",
                            "variable_workflow_01RV9ELI8OQLS5TZh6ew1C5NjUgZGjle74Z": "90",
                            "variable_workflow_01RVCONR8MAO93Mls3APBaJZNCLXo3FNjA9": "tcp",
                            "variable_workflow_01RX3VZUMHVIZ4nkBLdR0kfxzMfJs2du86j": ""
                          },
                          "runtime_user": {
                            "target_default": true
                          },
                          "skip_execution": false,
                          "target": {
                            "use_workflow_target_group": true
                          },
                          "workflow_id": "definition_workflow_01RV9ELI34NB13GBEHhAGy60bTaNtnkFOEM"
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01SBJYPYNDLZT5ER3xFZrkosEtoO77P0eIw",
                        "name": "Condition Block",
                        "title": "Critical Error Occurred?",
                        "type": "logic.if_else",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Critical Error Occurred?",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "blocks": [
                          {
                            "unique_name": "definition_activity_01SBJYPYNEVG00El6aYPlthUSkaBB40xlMU",
                            "name": "Condition Branch",
                            "title": "Yes",
                            "type": "logic.condition_block",
                            "base_type": "activity",
                            "properties": {
                              "condition": {
                                "left_operand": "$activity.definition_activity_01SBAEM7HTBEB0ZEpT0OKh6ELGjbVw6YmBv.output.succeeded$",
                                "operator": "eq",
                                "right_operand": false
                              },
                              "continue_on_failure": false,
                              "display_name": "Yes",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01SBJYPYNJKV32YmDgHUBMXeCPqugImqnXG",
                                "name": "ServiceNow - Add Work Note to Firewall Rule Task",
                                "title": "ServiceNow - Add Work Note to Firewall Rule Task",
                                "type": "workflow.atomic_workflow",
                                "base_type": "subworkflow",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "ServiceNow - Add Work Note to Firewall Rule Task",
                                  "input": {
                                    "variable_workflow_01O26LHVKETWS6NlqDRxw7LozFb5PYuORuj": "$activity.definition_activity_01SBFRZPMC5XH4y9ws02Umtm7b6VoWnc827.output.script_queries.ServiceNow Task ID$",
                                    "variable_workflow_01O26LHVKEV5Z72XukftJQPOqPzsRpLGjzl": "[code]\u003ch2\u003eMessage from Fortinet - FortiGate - Request Threat Containment \u003c/h2\u003e[/code]\n$activity.definition_activity_01SBAEM7HTBEB0ZEpT0OKh6ELGjbVw6YmBv.output.error.message$",
                                    "variable_workflow_01OX8KRPV34425GXjwybtQzddzhwdSmpqmk": "v2"
                                  },
                                  "runtime_user": {
                                    "target_default": true
                                  },
                                  "skip_execution": false,
                                  "target": {
                                    "override_workflow_target_group_criteria": true,
                                    "target_group": {
                                      "run_on_all_targets": false,
                                      "use_criteria": {
                                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                        "conditions": [
                                          {
                                            "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                            "operator": "eqi",
                                            "right_operand": "ServiceNow_API"
                                          }
                                        ]
                                      }
                                    }
                                  },
                                  "workflow_id": "definition_workflow_01O26LHVR14XR5ggjibxICB3qkpqZ7HuQmc"
                                },
                                "object_type": "definition_activity"
                              },
                              {
                                "unique_name": "definition_activity_01SBJYPYNLB1V0FTMvrwJ0BC8JJvbJo4Enz",
                                "name": "Completed",
                                "title": "Failed",
                                "type": "logic.completed",
                                "base_type": "activity",
                                "properties": {
                                  "completion_type": "failed-completed",
                                  "continue_on_failure": false,
                                  "display_name": "Failed",
                                  "result_message": "Failed to process Threat Containment Request.\n$activity.definition_activity_01SBAEM7HTBEB0ZEpT0OKh6ELGjbVw6YmBv.output.error.message$",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity"
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "unique_name": "definition_activity_01SBALJ7Y5C544GmUc1MNraNzlmJnQpOlAs",
                        "name": "Set Variables",
                        "title": "Set Variable",
                        "type": "core.set_multiple_variables",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Set Variable",
                          "skip_execution": false,
                          "variables_to_update": [
                            {
                              "variable_to_update": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBAKR6SYUQ12lXhdq78P30h0yFJuIcDLC$",
                              "variable_value_new": "$activity.definition_activity_01SBAEM7HTBEB0ZEpT0OKh6ELGjbVw6YmBv.output.variable_workflow_01RV9ELI8NZ4915NkyamIyehm0DYNRO9s4Z$"
                            }
                          ]
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01SBB8D3HZLRV5qg4lXXXOzvcqM8WygH0ST",
                "name": "Condition Block",
                "title": "Service Group name provided?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Service Group name provided?",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01SBB8D3PLHK12gw6OOAFkTcf4qU3S7uPw9",
                    "name": "Condition Branch",
                    "title": "Yes",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBATZ1JBTRB4y0iIpXGZkYfJNPnktOXPO$",
                        "operator": "ne",
                        "right_operand": ""
                      },
                      "continue_on_failure": false,
                      "display_name": "Yes",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01SBAUBE9UMQ83pETNhwMOS54OuHlKbTvWX",
                        "name": "Fortinet - FortiGate - Add Service to Service Group",
                        "title": "Fortinet - FortiGate - Add Service to Service Group",
                        "type": "workflow.atomic_workflow",
                        "base_type": "subworkflow",
                        "properties": {
                          "continue_on_failure": true,
                          "display_name": "Fortinet - FortiGate - Add Service to Service Group",
                          "input": {
                            "variable_workflow_01S0C9RPKE1J41hHDROkolBsfyL1CjzNsMj": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBAKR6SYUQ12lXhdq78P30h0yFJuIcDLC$",
                            "variable_workflow_01S0C9RPKEG560ccSdgHicX3AR3iN4DgQDD": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01S6BPQESSX1J2lrfBrlSyllQkTIdm3uQoe$",
                            "variable_workflow_01S0C9RPKEORM6jFLBwq4BGHGq3E2NDuJwl": "root",
                            "variable_workflow_01S0C9RPKEXJT5H15bhEVzKRn2OiSTB3sqL": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBATZ1JBTRB4y0iIpXGZkYfJNPnktOXPO$"
                          },
                          "runtime_user": {
                            "target_default": true
                          },
                          "skip_execution": false,
                          "target": {
                            "use_workflow_target_group": true
                          },
                          "workflow_id": "definition_workflow_01S0C9RPDQDWD5dweMu1XWDQeA4IU48SC1F"
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01SBKBUNNZUE724JROkxphB6UP4vtkjEDdj",
                        "name": "Condition Block",
                        "title": "Critical Error Occurred?",
                        "type": "logic.if_else",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Critical Error Occurred?",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "blocks": [
                          {
                            "unique_name": "definition_activity_01SBKBUNO0HIW7OmfAWlHwxHtNdxwJQooto",
                            "name": "Condition Branch",
                            "title": "Yes",
                            "type": "logic.condition_block",
                            "base_type": "activity",
                            "properties": {
                              "condition": {
                                "left_operand": {
                                  "left_operand": "$activity.definition_activity_01SBAUBE9UMQ83pETNhwMOS54OuHlKbTvWX.output.succeeded$",
                                  "operator": "eq",
                                  "right_operand": false
                                },
                                "operator": "and",
                                "right_operand": {
                                  "left_operand": "$activity.definition_activity_01SBAUBE9UMQ83pETNhwMOS54OuHlKbTvWX.output.error.message$",
                                  "operator": "nmw",
                                  "right_operand": "Status code: 404"
                                }
                              },
                              "continue_on_failure": false,
                              "display_name": "Yes",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01SBKBUNO48N070xB3NW5nmERIKsPR4ddGd",
                                "name": "ServiceNow - Add Work Note to Firewall Rule Task",
                                "title": "ServiceNow - Add Work Note to Firewall Rule Task",
                                "type": "workflow.atomic_workflow",
                                "base_type": "subworkflow",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "ServiceNow - Add Work Note to Firewall Rule Task",
                                  "input": {
                                    "variable_workflow_01O26LHVKETWS6NlqDRxw7LozFb5PYuORuj": "$activity.definition_activity_01SBFRZPMC5XH4y9ws02Umtm7b6VoWnc827.output.script_queries.ServiceNow Task ID$",
                                    "variable_workflow_01O26LHVKEV5Z72XukftJQPOqPzsRpLGjzl": "[code]\u003ch2\u003eMessage from Fortinet - FortiGate - Request Threat Containment \u003c/h2\u003e[/code]\n$activity.definition_activity_01SBAUBE9UMQ83pETNhwMOS54OuHlKbTvWX.output.error.message$",
                                    "variable_workflow_01OX8KRPV34425GXjwybtQzddzhwdSmpqmk": "v2"
                                  },
                                  "runtime_user": {
                                    "target_default": true
                                  },
                                  "skip_execution": false,
                                  "target": {
                                    "override_workflow_target_group_criteria": true,
                                    "target_group": {
                                      "run_on_all_targets": false,
                                      "use_criteria": {
                                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                        "conditions": [
                                          {
                                            "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                            "operator": "eqi",
                                            "right_operand": "ServiceNow_API"
                                          }
                                        ]
                                      }
                                    }
                                  },
                                  "workflow_id": "definition_workflow_01O26LHVR14XR5ggjibxICB3qkpqZ7HuQmc"
                                },
                                "object_type": "definition_activity"
                              },
                              {
                                "unique_name": "definition_activity_01SBKBUNO682Z5vlLLYcC9ESzOk1FhPMUOI",
                                "name": "Completed",
                                "title": "Failed",
                                "type": "logic.completed",
                                "base_type": "activity",
                                "properties": {
                                  "completion_type": "failed-completed",
                                  "continue_on_failure": false,
                                  "display_name": "Failed",
                                  "result_message": "Failed to process Threat Containment Request.\n$activity.definition_activity_01SBAUBE9UMQ83pETNhwMOS54OuHlKbTvWX.output.error.message$",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity"
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "unique_name": "definition_activity_01SBBHTF627YC4wFeGUdMiUvZn3Wb4aO6T8",
                    "name": "Condition Branch",
                    "title": "No",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBATZ1JBTRB4y0iIpXGZkYfJNPnktOXPO$",
                        "operator": "eq",
                        "right_operand": ""
                      },
                      "continue_on_failure": false,
                      "display_name": "No",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01SBBIBDUXEP946UjXPgmtz9yWFNKPrbnEq",
                        "name": "Execute Python Script",
                        "title": "Generate UUID to create unique name",
                        "type": "python3.script",
                        "base_type": "activity",
                        "properties": {
                          "action_timeout": 180,
                          "continue_on_failure": false,
                          "display_name": "Generate UUID to create unique name",
                          "script": "from sys import argv\nfrom uuid import uuid4\n\nprefix = argv[1]\nservice_group_name = f\"{prefix}-ServiceGroup-{uuid4()}\"",
                          "script_arguments": [
                            "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SB9LG5ALPAB7SVBpxRQNCpK6FQSnPe9Kj$"
                          ],
                          "script_queries": [
                            {
                              "script_query": "service_group_name",
                              "script_query_name": "Service Group Name",
                              "script_query_type": "string"
                            }
                          ],
                          "skip_execution": false
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01SBBK75O5QUH22EvmqB2sALryvukG8FIlF",
                        "name": "Fortinet - FortiGate - Create Service Group",
                        "title": "Fortinet - FortiGate - Create Service Group",
                        "type": "workflow.atomic_workflow",
                        "base_type": "subworkflow",
                        "properties": {
                          "continue_on_failure": true,
                          "display_name": "Fortinet - FortiGate - Create Service Group",
                          "input": {
                            "variable_workflow_01RZNYVY3HT4W46eb1IGnZHuvPdAc9EVsVS": "root",
                            "variable_workflow_01RZNYVY3IKCI7hk0461ZsisyRTizEggTPq": "$activity.definition_activity_01SBBIBDUXEP946UjXPgmtz9yWFNKPrbnEq.output.script_queries.Service Group Name$",
                            "variable_workflow_01RZNYVY3IUWJ3HLtS5USyUGRnKLLOFAKPo": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01S6BPQESSX1J2lrfBrlSyllQkTIdm3uQoe$",
                            "variable_workflow_01RZOD44514BX0kGUceiPoUWcHXcPoTc9Ap": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBAKR6SYUQ12lXhdq78P30h0yFJuIcDLC$",
                            "variable_workflow_01S5GA6PCT5AR6HtJNJc5kLJ2lhEfOu9Axu": false
                          },
                          "runtime_user": {
                            "target_default": true
                          },
                          "skip_execution": false,
                          "target": {
                            "use_workflow_target_group": true
                          },
                          "workflow_id": "definition_workflow_01RZNYVXUXIG552KulMfFGCIBl8mRN1ZZvf"
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01SBKAVSDUOST5ODHjiTIsZDAfjwX8SPliu",
                        "name": "Condition Block",
                        "title": "Critical Error Occurred?",
                        "type": "logic.if_else",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Critical Error Occurred?",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "blocks": [
                          {
                            "unique_name": "definition_activity_01SBKAVSDVCN82YC16SQabcClZooMnG7iOM",
                            "name": "Condition Branch",
                            "title": "Yes",
                            "type": "logic.condition_block",
                            "base_type": "activity",
                            "properties": {
                              "condition": {
                                "left_operand": "$activity.definition_activity_01SBBK75O5QUH22EvmqB2sALryvukG8FIlF.output.succeeded$",
                                "operator": "eq",
                                "right_operand": false
                              },
                              "continue_on_failure": false,
                              "display_name": "Yes",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01SBKAVSDYN4952eVHHEutBo1SWcWan1aMT",
                                "name": "ServiceNow - Add Work Note to Firewall Rule Task",
                                "title": "ServiceNow - Add Work Note to Firewall Rule Task",
                                "type": "workflow.atomic_workflow",
                                "base_type": "subworkflow",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "ServiceNow - Add Work Note to Firewall Rule Task",
                                  "input": {
                                    "variable_workflow_01O26LHVKETWS6NlqDRxw7LozFb5PYuORuj": "$activity.definition_activity_01SBFRZPMC5XH4y9ws02Umtm7b6VoWnc827.output.script_queries.ServiceNow Task ID$",
                                    "variable_workflow_01O26LHVKEV5Z72XukftJQPOqPzsRpLGjzl": "[code]\u003ch2\u003eMessage from Fortinet - FortiGate - Request Threat Containment \u003c/h2\u003e[/code]\n$activity.definition_activity_01SBBK75O5QUH22EvmqB2sALryvukG8FIlF.output.error.message$",
                                    "variable_workflow_01OX8KRPV34425GXjwybtQzddzhwdSmpqmk": "v2"
                                  },
                                  "runtime_user": {
                                    "target_default": true
                                  },
                                  "skip_execution": false,
                                  "target": {
                                    "override_workflow_target_group_criteria": true,
                                    "target_group": {
                                      "run_on_all_targets": false,
                                      "use_criteria": {
                                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                        "conditions": [
                                          {
                                            "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                            "operator": "eqi",
                                            "right_operand": "ServiceNow_API"
                                          }
                                        ]
                                      }
                                    }
                                  },
                                  "workflow_id": "definition_workflow_01O26LHVR14XR5ggjibxICB3qkpqZ7HuQmc"
                                },
                                "object_type": "definition_activity"
                              },
                              {
                                "unique_name": "definition_activity_01SBKAVSE0HOG1w8hwrKYWffZksZExep6mS",
                                "name": "Completed",
                                "title": "Failed",
                                "type": "logic.completed",
                                "base_type": "activity",
                                "properties": {
                                  "completion_type": "failed-completed",
                                  "continue_on_failure": false,
                                  "display_name": "Failed",
                                  "result_message": "Failed to process Threat Containment Request.\n$activity.definition_activity_01SBBK75O5QUH22EvmqB2sALryvukG8FIlF.output.error.message$",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity"
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "unique_name": "definition_activity_01SBBJRMG0PEK1Mbgsrw5YWj6dm3FHzThTy",
                        "name": "Set Variables",
                        "title": "Set Variable",
                        "type": "core.set_multiple_variables",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Set Variable",
                          "skip_execution": false,
                          "variables_to_update": [
                            {
                              "variable_to_update": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBATZ1JBTRB4y0iIpXGZkYfJNPnktOXPO$",
                              "variable_value_new": "$activity.definition_activity_01SBBIBDUXEP946UjXPgmtz9yWFNKPrbnEq.output.script_queries.Service Group Name$"
                            }
                          ]
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01SBAUXDALBSB7ivl23lL7qaxHZnST3qLSk",
                "name": "Condition Block",
                "title": "Service added?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Service added?",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01SBAUXDOM7SK2np4cPuaJc42ryoY9osAOi",
                    "name": "Condition Branch",
                    "title": "No",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01SBB8D3HZLRV5qg4lXXXOzvcqM8WygH0ST.output.succeeded$",
                        "operator": "eq",
                        "right_operand": false
                      },
                      "continue_on_failure": false,
                      "display_name": "No",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01SBAXB13T5KV3K4KgWiNLf1CCWpVs4nDyP",
                        "name": "Fortinet - FortiGate - Create Service Group",
                        "title": "Fortinet - FortiGate - Create Service Group",
                        "type": "workflow.atomic_workflow",
                        "base_type": "subworkflow",
                        "properties": {
                          "continue_on_failure": true,
                          "display_name": "Fortinet - FortiGate - Create Service Group",
                          "input": {
                            "variable_workflow_01RZNYVY3HT4W46eb1IGnZHuvPdAc9EVsVS": "root",
                            "variable_workflow_01RZNYVY3IKCI7hk0461ZsisyRTizEggTPq": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBAKR6SYUQ12lXhdq78P30h0yFJuIcDLC$",
                            "variable_workflow_01RZNYVY3IUWJ3HLtS5USyUGRnKLLOFAKPo": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01S6BPQESSX1J2lrfBrlSyllQkTIdm3uQoe$",
                            "variable_workflow_01RZOD44514BX0kGUceiPoUWcHXcPoTc9Ap": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBAKR6SYUQ12lXhdq78P30h0yFJuIcDLC$",
                            "variable_workflow_01S5GA6PCT5AR6HtJNJc5kLJ2lhEfOu9Axu": false
                          },
                          "runtime_user": {
                            "target_default": true
                          },
                          "skip_execution": false,
                          "target": {
                            "use_workflow_target_group": true
                          },
                          "workflow_id": "definition_workflow_01RZNYVXUXIG552KulMfFGCIBl8mRN1ZZvf"
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01SBKDFG8GMVT42wUiqP0nLiJKn2NUZ1wYb",
                        "name": "Condition Block",
                        "title": "Critical Error Occurred?",
                        "type": "logic.if_else",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Critical Error Occurred?",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "blocks": [
                          {
                            "unique_name": "definition_activity_01SBKDFG8HDAE6hbLs7ur2qA83SogStbEH6",
                            "name": "Condition Branch",
                            "title": "Yes",
                            "type": "logic.condition_block",
                            "base_type": "activity",
                            "properties": {
                              "condition": {
                                "left_operand": "$activity.definition_activity_01SBAXB13T5KV3K4KgWiNLf1CCWpVs4nDyP.output.succeeded$",
                                "operator": "eq",
                                "right_operand": false
                              },
                              "continue_on_failure": false,
                              "display_name": "Yes",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01SBKDFG8LCAZ5DH7jQr7rtZ8ee8oKYLOMN",
                                "name": "ServiceNow - Add Work Note to Firewall Rule Task",
                                "title": "ServiceNow - Add Work Note to Firewall Rule Task",
                                "type": "workflow.atomic_workflow",
                                "base_type": "subworkflow",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "ServiceNow - Add Work Note to Firewall Rule Task",
                                  "input": {
                                    "variable_workflow_01O26LHVKETWS6NlqDRxw7LozFb5PYuORuj": "$activity.definition_activity_01SBFRZPMC5XH4y9ws02Umtm7b6VoWnc827.output.script_queries.ServiceNow Task ID$",
                                    "variable_workflow_01O26LHVKEV5Z72XukftJQPOqPzsRpLGjzl": "[code]\u003ch2\u003eMessage from Fortinet - FortiGate - Request Threat Containment \u003c/h2\u003e[/code]\n$activity.definition_activity_01SBAXB13T5KV3K4KgWiNLf1CCWpVs4nDyP.output.error.message$",
                                    "variable_workflow_01OX8KRPV34425GXjwybtQzddzhwdSmpqmk": "v2"
                                  },
                                  "runtime_user": {
                                    "target_default": true
                                  },
                                  "skip_execution": false,
                                  "target": {
                                    "override_workflow_target_group_criteria": true,
                                    "target_group": {
                                      "run_on_all_targets": false,
                                      "use_criteria": {
                                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                        "conditions": [
                                          {
                                            "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                            "operator": "eqi",
                                            "right_operand": "ServiceNow_API"
                                          }
                                        ]
                                      }
                                    }
                                  },
                                  "workflow_id": "definition_workflow_01O26LHVR14XR5ggjibxICB3qkpqZ7HuQmc"
                                },
                                "object_type": "definition_activity"
                              },
                              {
                                "unique_name": "definition_activity_01SBKDFG8NA9822K7fze7mSlWfFjFrDL6fU",
                                "name": "Completed",
                                "title": "Failed",
                                "type": "logic.completed",
                                "base_type": "activity",
                                "properties": {
                                  "completion_type": "failed-completed",
                                  "continue_on_failure": false,
                                  "display_name": "Failed",
                                  "result_message": "Failed to process Threat Containment Request.\n$activity.definition_activity_01SBAXB13T5KV3K4KgWiNLf1CCWpVs4nDyP.output.error.message$",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity"
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "unique_name": "definition_activity_01SBKGX56TN7E5qamwhi7AI9Vxh0C21MYb0",
                        "name": "ServiceNow - Add Work Note to Firewall Rule Task",
                        "title": "ServiceNow - Add Work Note to Firewall Rule Task",
                        "type": "workflow.atomic_workflow",
                        "base_type": "subworkflow",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "ServiceNow - Add Work Note to Firewall Rule Task",
                          "input": {
                            "variable_workflow_01O26LHVKETWS6NlqDRxw7LozFb5PYuORuj": "$activity.definition_activity_01SBFRZPMC5XH4y9ws02Umtm7b6VoWnc827.output.script_queries.ServiceNow Task ID$",
                            "variable_workflow_01O26LHVKEV5Z72XukftJQPOqPzsRpLGjzl": "[code]\u003ch2\u003eMessage from Fortinet - FortiGate - Request Threat Containment \u003c/h2\u003e[/code]\nSevice Group Name \"$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBATZ1JBTRB4y0iIpXGZkYfJNPnktOXPO$\" was not found, but the new Sevice Group with the name \"$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBATZ1JBTRB4y0iIpXGZkYfJNPnktOXPO$\" was created instead.",
                            "variable_workflow_01OX8KRPV34425GXjwybtQzddzhwdSmpqmk": "v2"
                          },
                          "runtime_user": {
                            "target_default": true
                          },
                          "skip_execution": false,
                          "target": {
                            "override_workflow_target_group_criteria": true,
                            "target_group": {
                              "run_on_all_targets": false,
                              "use_criteria": {
                                "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                "conditions": [
                                  {
                                    "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                    "operator": "eqi",
                                    "right_operand": "ServiceNow_API"
                                  }
                                ]
                              }
                            }
                          },
                          "workflow_id": "definition_workflow_01O26LHVR14XR5ggjibxICB3qkpqZ7HuQmc"
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01SBBC8B9GVZS2Gdtqp4WjG3pMZ4Xqh6g1I",
                        "name": "Set Variables",
                        "title": "Set Variable",
                        "type": "core.set_multiple_variables",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Set Variable",
                          "skip_execution": false,
                          "variables_to_update": [
                            {
                              "variable_to_update": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBATZ1JBTRB4y0iIpXGZkYfJNPnktOXPO$",
                              "variable_value_new": "$activity.definition_activity_01SBAXB13T5KV3K4KgWiNLf1CCWpVs4nDyP.output.variable_workflow_01RZNYVY3JD6I54WoDH9BXZHHYpfwPJSW7d$"
                            }
                          ]
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              }
            ]
          },
          {
            "unique_name": "definition_activity_01S6EHT5WS5UY4REyLDLWGInJJuTPo4zz7k",
            "name": "Parallel Branch",
            "title": "Address",
            "type": "logic.parallel_block",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Address",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01S6FJ9PJJN9O0yu9owsj3SiBggfR16VvPO",
                "name": "Read Table from Text",
                "title": "Read Table from Text",
                "type": "core.read_table_from_text",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "delimiters": [
                    {
                      "delimiter": ","
                    }
                  ],
                  "display_name": "Read Table from Text",
                  "input_text": "$activity.definition_activity_01SBFRZPMC5XH4y9ws02Umtm7b6VoWnc827.output.script_queries.Source Address$,source,$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBBTW2WA37M2fvFzuIJBMyCa7GRg7ldDO$\n$activity.definition_activity_01SBFRZPMC5XH4y9ws02Umtm7b6VoWnc827.output.script_queries.Destination Address$,destination,$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBBU6YZFLHU7ivu9e9Rki8KhZrxORq6sR$",
                  "persist_output": false,
                  "populate_columns": false,
                  "skip_execution": false,
                  "table_columns": [
                    {
                      "column_name": "ip",
                      "column_type": "string"
                    },
                    {
                      "column_name": "direction",
                      "column_type": "string"
                    },
                    {
                      "column_name": "group",
                      "column_type": "string"
                    }
                  ]
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01S6EI6UL39RW0n6VOJFesQT1e8VCwrmqSz",
                "name": "For Each",
                "title": "For Each",
                "type": "logic.for_each",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "For Each",
                  "skip_execution": false,
                  "source_array": "$activity.definition_activity_01S6FJ9PJJN9O0yu9owsj3SiBggfR16VvPO.output.read_table_from_text$"
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01S6BN3MBOGXH6W8sfXZBbaq9gkxO21ngkx",
                    "name": "Fortinet - FortiGate - Search for Address by Value",
                    "title": "Fortinet - FortiGate - Search for Address by Value",
                    "type": "workflow.atomic_workflow",
                    "base_type": "subworkflow",
                    "properties": {
                      "continue_on_failure": true,
                      "display_name": "Fortinet - FortiGate - Search for Address by Value",
                      "input": {
                        "variable_workflow_01QJMY7E7Z0IB2Ed7caVA90mExOvR277l2a": "$activity.definition_activity_01S6EI6UL39RW0n6VOJFesQT1e8VCwrmqSz.input.source_array[@].ip$",
                        "variable_workflow_01QJMY7E7Z34Y31xJWhl8psuGJq9nSwAGQA": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01S6BPQESSX1J2lrfBrlSyllQkTIdm3uQoe$",
                        "variable_workflow_01QJNP94KKPAD0OwFo8IB6b8carKE0VVqpl": "ip",
                        "variable_workflow_01QJQEPSZM3BE1GcmTTNciS5QqSczLq11G7": "root"
                      },
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "use_workflow_target_group": true
                      },
                      "workflow_id": "definition_workflow_01QJMY7EFE9EB0dUuvozT00neDnloTNQN05"
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01SBK2B25Y0136CEWWDGuMkjegYAnxAY13L",
                    "name": "Condition Block",
                    "title": "Critical Error Occurred?",
                    "type": "logic.if_else",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Critical Error Occurred?",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "blocks": [
                      {
                        "unique_name": "definition_activity_01SBK2B25YLAB1ACyOUaEKBSkgfSrPg1kbq",
                        "name": "Condition Branch",
                        "title": "Yes",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                          "condition": {
                            "left_operand": {
                              "left_operand": "$activity.definition_activity_01S6BN3MBOGXH6W8sfXZBbaq9gkxO21ngkx.output.succeeded$",
                              "operator": "eq",
                              "right_operand": false
                            },
                            "operator": "and",
                            "right_operand": {
                              "left_operand": "$activity.definition_activity_01S6BN3MBOGXH6W8sfXZBbaq9gkxO21ngkx.output.error.message$",
                              "operator": "nmw",
                              "right_operand": "Status code: 404"
                            }
                          },
                          "continue_on_failure": false,
                          "display_name": "Yes",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01SBK2B262KLB6LuR3oIZAfgasHU6TQpxJw",
                            "name": "ServiceNow - Add Work Note to Firewall Rule Task",
                            "title": "ServiceNow - Add Work Note to Firewall Rule Task",
                            "type": "workflow.atomic_workflow",
                            "base_type": "subworkflow",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "ServiceNow - Add Work Note to Firewall Rule Task",
                              "input": {
                                "variable_workflow_01O26LHVKETWS6NlqDRxw7LozFb5PYuORuj": "$activity.definition_activity_01SBFRZPMC5XH4y9ws02Umtm7b6VoWnc827.output.script_queries.ServiceNow Task ID$",
                                "variable_workflow_01O26LHVKEV5Z72XukftJQPOqPzsRpLGjzl": "[code]\u003ch2\u003eMessage from Fortinet - FortiGate - Request Threat Containment \u003c/h2\u003e[/code]\n$activity.definition_activity_01S6BN3MBOGXH6W8sfXZBbaq9gkxO21ngkx.output.error.message$",
                                "variable_workflow_01OX8KRPV34425GXjwybtQzddzhwdSmpqmk": "v2"
                              },
                              "runtime_user": {
                                "target_default": true
                              },
                              "skip_execution": false,
                              "target": {
                                "override_workflow_target_group_criteria": true,
                                "target_group": {
                                  "run_on_all_targets": false,
                                  "use_criteria": {
                                    "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                    "conditions": [
                                      {
                                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                        "operator": "eqi",
                                        "right_operand": "ServiceNow_API"
                                      }
                                    ]
                                  }
                                }
                              },
                              "workflow_id": "definition_workflow_01O26LHVR14XR5ggjibxICB3qkpqZ7HuQmc"
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01SBK2B264I8G0pGhJA9SnWlq4yhoUeAFHd",
                            "name": "Completed",
                            "title": "Failed",
                            "type": "logic.completed",
                            "base_type": "activity",
                            "properties": {
                              "completion_type": "failed-completed",
                              "continue_on_failure": false,
                              "display_name": "Failed",
                              "result_message": "Failed to process Threat Containment Request.\n$activity.definition_activity_01S6BN3MBOGXH6W8sfXZBbaq9gkxO21ngkx.output.error.message$",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "unique_name": "definition_activity_01S6FNXPIAE8C3WSBuo4977OnSQQUIazL0z",
                    "name": "Condition Block",
                    "title": "Address found?",
                    "type": "logic.if_else",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Address found?",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "blocks": [
                      {
                        "unique_name": "definition_activity_01S6FNXPV8R8O3NRVaL63wUofPS6VEYCnEC",
                        "name": "Condition Branch",
                        "title": "Yes",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                          "condition": {
                            "left_operand": "$activity.definition_activity_01S6BN3MBOGXH6W8sfXZBbaq9gkxO21ngkx.output.succeeded$",
                            "operator": "eq",
                            "right_operand": true
                          },
                          "continue_on_failure": false,
                          "display_name": "Yes",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01SB9YMO47LK80nYWlhH44vbkgn0DAcyM58",
                            "name": "Condition Block",
                            "title": "Source or Destination Address?",
                            "type": "logic.if_else",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Source or Destination Address?",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "blocks": [
                              {
                                "unique_name": "definition_activity_01SB9YMOIIX7S5wtdlmU1eZiLLV1I4MplTh",
                                "name": "Condition Branch",
                                "title": "Source Address",
                                "type": "logic.condition_block",
                                "base_type": "activity",
                                "properties": {
                                  "condition": {
                                    "left_operand": "$activity.definition_activity_01S6EI6UL39RW0n6VOJFesQT1e8VCwrmqSz.input.source_array[@].direction$",
                                    "operator": "eq",
                                    "right_operand": "source"
                                  },
                                  "continue_on_failure": false,
                                  "display_name": "Source Address",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "actions": [
                                  {
                                    "unique_name": "definition_activity_01SB9XAPS589421friHEEjg5ztxc97HIoWo",
                                    "name": "Set Variables",
                                    "title": "Set Variable",
                                    "type": "core.set_multiple_variables",
                                    "base_type": "activity",
                                    "properties": {
                                      "continue_on_failure": false,
                                      "display_name": "Set Variable",
                                      "skip_execution": false,
                                      "variables_to_update": [
                                        {
                                          "variable_to_update": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SB9OQ9J4RMT3JaxuNkO5BbVQBcn1GOOC1$",
                                          "variable_value_new": "$activity.definition_activity_01S6BN3MBOGXH6W8sfXZBbaq9gkxO21ngkx.output.variable_workflow_01QJMY7E7YVSH6zkv5YqG2E3Dy29Ng7fQJP$"
                                        }
                                      ]
                                    },
                                    "object_type": "definition_activity"
                                  }
                                ]
                              },
                              {
                                "unique_name": "definition_activity_01SBA0W5J4XI56glaiORM3m4D9Hm3Ao0zMZ",
                                "name": "Condition Branch",
                                "title": "Destination Address",
                                "type": "logic.condition_block",
                                "base_type": "activity",
                                "properties": {
                                  "condition": {
                                    "left_operand": "$activity.definition_activity_01S6EI6UL39RW0n6VOJFesQT1e8VCwrmqSz.input.source_array[@].direction$",
                                    "operator": "eq",
                                    "right_operand": "destination"
                                  },
                                  "continue_on_failure": false,
                                  "display_name": "Destination Address",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "actions": [
                                  {
                                    "unique_name": "definition_activity_01SBA0W5J5L5E1NusD4T1cOltEBcM93vJOH",
                                    "name": "Set Variables",
                                    "title": "Set Variables",
                                    "type": "core.set_multiple_variables",
                                    "base_type": "activity",
                                    "properties": {
                                      "continue_on_failure": false,
                                      "display_name": "Set Variables",
                                      "skip_execution": false,
                                      "variables_to_update": [
                                        {
                                          "variable_to_update": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SB9PIPECCAL4L4Nb6HY857fnW7uLpEx71$",
                                          "variable_value_new": "$activity.definition_activity_01S6BN3MBOGXH6W8sfXZBbaq9gkxO21ngkx.output.variable_workflow_01QJMY7E7YVSH6zkv5YqG2E3Dy29Ng7fQJP$"
                                        }
                                      ]
                                    },
                                    "object_type": "definition_activity"
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "unique_name": "definition_activity_01SB9VLY3WUYT4CuqdiTnH9pTVrnFZ3VS58",
                        "name": "Condition Branch",
                        "title": "No",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                          "condition": {
                            "left_operand": "$activity.definition_activity_01S6BN3MBOGXH6W8sfXZBbaq9gkxO21ngkx.output.succeeded$",
                            "operator": "eq",
                            "right_operand": false
                          },
                          "continue_on_failure": false,
                          "display_name": "No",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01SB9VLY3XH350SEGlusKDdZptKv2QD1ru7",
                            "name": "Execute Python Script",
                            "title": "Generate UUID to create unique name",
                            "type": "python3.script",
                            "base_type": "activity",
                            "properties": {
                              "action_timeout": 180,
                              "continue_on_failure": false,
                              "display_name": "Generate UUID to create unique name",
                              "script": "from sys import argv\nfrom uuid import uuid4\n\nprefix = argv[1]\naddress_name = f\"{prefix}-Address-{uuid4()}\"",
                              "script_arguments": [
                                "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SB9LG5ALPAB7SVBpxRQNCpK6FQSnPe9Kj$"
                              ],
                              "script_queries": [
                                {
                                  "script_query": "address_name",
                                  "script_query_name": "Address Name",
                                  "script_query_type": "string"
                                }
                              ],
                              "skip_execution": false
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01SB9VLY3ZGD00vH3KixvD3xRXR5Mh3TXPf",
                            "name": "Fortinet - FortiGate - Create Address",
                            "title": "Fortinet - FortiGate - Create Address",
                            "type": "workflow.atomic_workflow",
                            "base_type": "subworkflow",
                            "properties": {
                              "continue_on_failure": true,
                              "display_name": "Fortinet - FortiGate - Create Address",
                              "input": {
                                "variable_workflow_01Q8Q3G8HFBBV4bCgPNxr8tNZAdaRIhTchP": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.input.variable_workflow_01S6BK8PJICEO1Sw0YZtdaQjtmobwyW8Tu9$",
                                "variable_workflow_01Q8QAOJCFJFX2aDEaoWMl8JIaBJeUoywL6": "$activity.definition_activity_01S6EI6UL39RW0n6VOJFesQT1e8VCwrmqSz.input.source_array[@].ip$",
                                "variable_workflow_01QCRJI0NZEMB0Pm8zeCVQJSI6QGrjOyakn": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01S6BPQESSX1J2lrfBrlSyllQkTIdm3uQoe$",
                                "variable_workflow_01QYDQME2SLKW7lJPgDsK0aMFMMODvnejqs": "$activity.definition_activity_01SB9VLY3XH350SEGlusKDdZptKv2QD1ru7.output.script_queries.Address Name$",
                                "variable_workflow_01QYE15IBF6Q74dRiYe9StNFoRQ1cIEul1M": "root"
                              },
                              "runtime_user": {
                                "target_default": true
                              },
                              "skip_execution": false,
                              "target": {
                                "use_workflow_target_group": true
                              },
                              "workflow_id": "definition_workflow_01Q2H2423CNMQ55zxmxIlndVdm1FyYI9WvB"
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01SBK0JO3VJ2H4SKbyyb8eZLlV98cebk8YS",
                            "name": "Condition Block",
                            "title": "Critical Error Occurred?",
                            "type": "logic.if_else",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Critical Error Occurred?",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "blocks": [
                              {
                                "unique_name": "definition_activity_01SBK0JO3W3ID67U8YyFWiphRczkpkXSXC0",
                                "name": "Condition Branch",
                                "title": "Yes",
                                "type": "logic.condition_block",
                                "base_type": "activity",
                                "properties": {
                                  "condition": {
                                    "left_operand": "$activity.definition_activity_01SB9VLY3ZGD00vH3KixvD3xRXR5Mh3TXPf.output.succeeded$",
                                    "operator": "eq",
                                    "right_operand": false
                                  },
                                  "continue_on_failure": false,
                                  "display_name": "Yes",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "actions": [
                                  {
                                    "unique_name": "definition_activity_01SBK0JO3Z82D4VP7cmQYLhGAOot6yPiVPI",
                                    "name": "ServiceNow - Add Work Note to Firewall Rule Task",
                                    "title": "ServiceNow - Add Work Note to Firewall Rule Task",
                                    "type": "workflow.atomic_workflow",
                                    "base_type": "subworkflow",
                                    "properties": {
                                      "continue_on_failure": false,
                                      "display_name": "ServiceNow - Add Work Note to Firewall Rule Task",
                                      "input": {
                                        "variable_workflow_01O26LHVKETWS6NlqDRxw7LozFb5PYuORuj": "$activity.definition_activity_01SBFRZPMC5XH4y9ws02Umtm7b6VoWnc827.output.script_queries.ServiceNow Task ID$",
                                        "variable_workflow_01O26LHVKEV5Z72XukftJQPOqPzsRpLGjzl": "[code]\u003ch2\u003eMessage from Fortinet - FortiGate - Request Threat Containment \u003c/h2\u003e[/code]\n$activity.definition_activity_01SB9VLY3ZGD00vH3KixvD3xRXR5Mh3TXPf.output.error.message$",
                                        "variable_workflow_01OX8KRPV34425GXjwybtQzddzhwdSmpqmk": "v2"
                                      },
                                      "runtime_user": {
                                        "target_default": true
                                      },
                                      "skip_execution": false,
                                      "target": {
                                        "override_workflow_target_group_criteria": true,
                                        "target_group": {
                                          "run_on_all_targets": false,
                                          "use_criteria": {
                                            "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                            "conditions": [
                                              {
                                                "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                                "operator": "eqi",
                                                "right_operand": "ServiceNow_API"
                                              }
                                            ]
                                          }
                                        }
                                      },
                                      "workflow_id": "definition_workflow_01O26LHVR14XR5ggjibxICB3qkpqZ7HuQmc"
                                    },
                                    "object_type": "definition_activity"
                                  },
                                  {
                                    "unique_name": "definition_activity_01SBK0JO4118I4kPhq8SifqkEQP8r4W4bfm",
                                    "name": "Completed",
                                    "title": "Failed",
                                    "type": "logic.completed",
                                    "base_type": "activity",
                                    "properties": {
                                      "completion_type": "failed-completed",
                                      "continue_on_failure": false,
                                      "display_name": "Failed",
                                      "result_message": "Failed to process Threat Containment Request.\n$activity.definition_activity_01SB9VLY3ZGD00vH3KixvD3xRXR5Mh3TXPf.output.error.message$",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity"
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "unique_name": "definition_activity_01SBA1YP1SBD15qhLY3ZeyYgeMT9lmc688D",
                            "name": "Condition Block",
                            "title": "Source or Destination Address?",
                            "type": "logic.if_else",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Source or Destination Address?",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "blocks": [
                              {
                                "unique_name": "definition_activity_01SBA1YP1SVXW1ITx9GqoJ0KeZKJE84suHg",
                                "name": "Condition Branch",
                                "title": "Source Address",
                                "type": "logic.condition_block",
                                "base_type": "activity",
                                "properties": {
                                  "condition": {
                                    "left_operand": "$activity.definition_activity_01S6EI6UL39RW0n6VOJFesQT1e8VCwrmqSz.input.source_array[@].direction$",
                                    "operator": "eq",
                                    "right_operand": "source"
                                  },
                                  "continue_on_failure": false,
                                  "display_name": "Source Address",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "actions": [
                                  {
                                    "unique_name": "definition_activity_01SBA1YP1USF17bajqR040Gc0CtrEZwMj99",
                                    "name": "Set Variables",
                                    "title": "Set Variables",
                                    "type": "core.set_multiple_variables",
                                    "base_type": "activity",
                                    "properties": {
                                      "continue_on_failure": false,
                                      "display_name": "Set Variables",
                                      "skip_execution": false,
                                      "variables_to_update": [
                                        {
                                          "variable_to_update": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SB9OQ9J4RMT3JaxuNkO5BbVQBcn1GOOC1$",
                                          "variable_value_new": "$activity.definition_activity_01SB9VLY3ZGD00vH3KixvD3xRXR5Mh3TXPf.output.variable_workflow_01QC9LIOV6YU17SrgFzUqifOESxFzg5ss7d$"
                                        }
                                      ]
                                    },
                                    "object_type": "definition_activity"
                                  }
                                ]
                              },
                              {
                                "unique_name": "definition_activity_01SBA1YP1XX9F0vED0JBSgpdXpj2WJ4b0Yr",
                                "name": "Condition Branch",
                                "title": "Destination Address",
                                "type": "logic.condition_block",
                                "base_type": "activity",
                                "properties": {
                                  "condition": {
                                    "left_operand": "$activity.definition_activity_01S6EI6UL39RW0n6VOJFesQT1e8VCwrmqSz.input.source_array[@].direction$",
                                    "operator": "eq",
                                    "right_operand": "destination"
                                  },
                                  "continue_on_failure": false,
                                  "display_name": "Destination Address",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "actions": [
                                  {
                                    "unique_name": "definition_activity_01SBA1YP1YICW3wTeYk7aksD83d5CES0FIo",
                                    "name": "Set Variables",
                                    "title": "Set Variables",
                                    "type": "core.set_multiple_variables",
                                    "base_type": "activity",
                                    "properties": {
                                      "continue_on_failure": false,
                                      "display_name": "Set Variables",
                                      "skip_execution": false,
                                      "variables_to_update": [
                                        {
                                          "variable_to_update": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SB9PIPECCAL4L4Nb6HY857fnW7uLpEx71$",
                                          "variable_value_new": "$activity.definition_activity_01SB9VLY3ZGD00vH3KixvD3xRXR5Mh3TXPf.output.variable_workflow_01QC9LIOV6YU17SrgFzUqifOESxFzg5ss7d$"
                                        }
                                      ]
                                    },
                                    "object_type": "definition_activity"
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "unique_name": "definition_activity_01SBLXA5VD2E018xRncuww9sDyvkaa6oQW2",
                    "name": "Execute Python Script",
                    "title": "Set temporary object name",
                    "type": "python3.script",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "continue_on_failure": false,
                      "display_name": "Set temporary object name",
                      "script": "from sys import argv\n\nobj_name = None\nif argv[1] == \"source\":\n    obj_name = argv[2]\nelse:\n    obj_name = argv[3]",
                      "script_arguments": [
                        "$activity.definition_activity_01S6EI6UL39RW0n6VOJFesQT1e8VCwrmqSz.input.source_array[@].direction$",
                        "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SB9OQ9J4RMT3JaxuNkO5BbVQBcn1GOOC1$",
                        "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SB9PIPECCAL4L4Nb6HY857fnW7uLpEx71$"
                      ],
                      "script_queries": [
                        {
                          "script_query": "obj_name",
                          "script_query_name": "Object Name",
                          "script_query_type": "string"
                        }
                      ],
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01SBBGXJB0FOS6haL7FbqMutOGF0dLK5ctx",
                    "name": "Condition Block",
                    "title": "Address group name provided?",
                    "type": "logic.if_else",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Address group name provided?",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "blocks": [
                      {
                        "unique_name": "definition_activity_01SBBGXJHMA684TmMTV7XyLzpG6Jyv9Vi8x",
                        "name": "Condition Branch",
                        "title": "Yes",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                          "condition": {
                            "left_operand": "$activity.definition_activity_01S6EI6UL39RW0n6VOJFesQT1e8VCwrmqSz.input.source_array[@].group$",
                            "operator": "ne",
                            "right_operand": ""
                          },
                          "continue_on_failure": false,
                          "display_name": "Yes",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01SBCKDCUKQ8T5cFauUVLpT3Xx6xzQM1TVq",
                            "name": "Fortinet - FortiGate - Add Address to Address Group",
                            "title": "Fortinet - FortiGate - Add Address to Address Group",
                            "type": "workflow.atomic_workflow",
                            "base_type": "subworkflow",
                            "properties": {
                              "continue_on_failure": true,
                              "display_name": "Fortinet - FortiGate - Add Address to Address Group",
                              "input": {
                                "variable_workflow_01QKJSE0EFJ2W31BeDVMJrs1CFizp43DKQr": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01S6BPQESSX1J2lrfBrlSyllQkTIdm3uQoe$",
                                "variable_workflow_01QKJSE0EFMPQ4ZousJqguiEM0z7cVkN0z4": "$activity.definition_activity_01SBLXA5VD2E018xRncuww9sDyvkaa6oQW2.output.script_queries.Object Name$",
                                "variable_workflow_01QKJSE0EFQL61FRB1WLGyXTIRetH2ohsE4": "$activity.definition_activity_01S6EI6UL39RW0n6VOJFesQT1e8VCwrmqSz.input.source_array[@].group$",
                                "variable_workflow_01QKM1ZUG7X301PG75jm0VEKR1SrG6holTq": "root"
                              },
                              "runtime_user": {
                                "target_default": true
                              },
                              "skip_execution": false,
                              "target": {
                                "use_workflow_target_group": true
                              },
                              "workflow_id": "definition_workflow_01QKJSE0LURMP1XIO79isiyUAXKTDDZeCGV"
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01SBLD1F0YNY87fbIBxyNgHIyc4KRjunMec",
                            "name": "Condition Block",
                            "title": "Critical Error Occurred?",
                            "type": "logic.if_else",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Critical Error Occurred?",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "blocks": [
                              {
                                "unique_name": "definition_activity_01SBLD1F0Z64O3rVVHYcIBE23nL7m0UyX9T",
                                "name": "Condition Branch",
                                "title": "Yes",
                                "type": "logic.condition_block",
                                "base_type": "activity",
                                "properties": {
                                  "condition": {
                                    "left_operand": "$activity.definition_activity_01SBCKDCUKQ8T5cFauUVLpT3Xx6xzQM1TVq.output.succeeded$",
                                    "operator": "eq",
                                    "right_operand": false
                                  },
                                  "continue_on_failure": false,
                                  "display_name": "Yes",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "actions": [
                                  {
                                    "unique_name": "definition_activity_01SBLD1F129C43IO5xhQv1pCHwNvxw9OePC",
                                    "name": "ServiceNow - Add Work Note to Firewall Rule Task",
                                    "title": "ServiceNow - Add Work Note to Firewall Rule Task",
                                    "type": "workflow.atomic_workflow",
                                    "base_type": "subworkflow",
                                    "properties": {
                                      "continue_on_failure": false,
                                      "display_name": "ServiceNow - Add Work Note to Firewall Rule Task",
                                      "input": {
                                        "variable_workflow_01O26LHVKETWS6NlqDRxw7LozFb5PYuORuj": "$activity.definition_activity_01SBFRZPMC5XH4y9ws02Umtm7b6VoWnc827.output.script_queries.ServiceNow Task ID$",
                                        "variable_workflow_01O26LHVKEV5Z72XukftJQPOqPzsRpLGjzl": "[code]\u003ch2\u003eMessage from Fortinet - FortiGate - Request Threat Containment \u003c/h2\u003e[/code]\n$activity.definition_activity_01SBCKDCUKQ8T5cFauUVLpT3Xx6xzQM1TVq.output.error.message$",
                                        "variable_workflow_01OX8KRPV34425GXjwybtQzddzhwdSmpqmk": "v2"
                                      },
                                      "runtime_user": {
                                        "target_default": true
                                      },
                                      "skip_execution": false,
                                      "target": {
                                        "override_workflow_target_group_criteria": true,
                                        "target_group": {
                                          "run_on_all_targets": false,
                                          "use_criteria": {
                                            "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                            "conditions": [
                                              {
                                                "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                                "operator": "eqi",
                                                "right_operand": "ServiceNow_API"
                                              }
                                            ]
                                          }
                                        }
                                      },
                                      "workflow_id": "definition_workflow_01O26LHVR14XR5ggjibxICB3qkpqZ7HuQmc"
                                    },
                                    "object_type": "definition_activity"
                                  },
                                  {
                                    "unique_name": "definition_activity_01SBLD1F13Q6C1wCfdZH61oNrSB09y3lFNN",
                                    "name": "Completed",
                                    "title": "Failed",
                                    "type": "logic.completed",
                                    "base_type": "activity",
                                    "properties": {
                                      "completion_type": "failed-completed",
                                      "continue_on_failure": false,
                                      "display_name": "Failed",
                                      "result_message": "Failed to process Threat Containment Request.\n$activity.definition_activity_01SBCKDCUKQ8T5cFauUVLpT3Xx6xzQM1TVq.output.error.message$",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity"
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "unique_name": "definition_activity_01SBCTPULF8LW2ziY1Yf6BTUy5UmuNPCvD0",
                            "name": "Condition Block",
                            "title": "Address added?",
                            "type": "logic.if_else",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Address added?",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "blocks": [
                              {
                                "unique_name": "definition_activity_01SBCTPUS7XDB1tVJwthdzvR9ojB9dhoOBb",
                                "name": "Condition Branch",
                                "title": "No",
                                "type": "logic.condition_block",
                                "base_type": "activity",
                                "properties": {
                                  "condition": {
                                    "left_operand": "$activity.definition_activity_01SBCKDCUKQ8T5cFauUVLpT3Xx6xzQM1TVq.output.succeeded$",
                                    "operator": "eq",
                                    "right_operand": false
                                  },
                                  "continue_on_failure": false,
                                  "display_name": "No",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "actions": [
                                  {
                                    "unique_name": "definition_activity_01SBCUR0TX8BN0gacf2FIoleSRfDnlv6dpO",
                                    "name": "Fortinet - FortiGate - Create Address Group",
                                    "title": "Fortinet - FortiGate - Create Address Group",
                                    "type": "workflow.atomic_workflow",
                                    "base_type": "subworkflow",
                                    "properties": {
                                      "continue_on_failure": true,
                                      "display_name": "Fortinet - FortiGate - Create Address Group",
                                      "input": {
                                        "variable_workflow_01QCYG8UMC62K3m6m1L8dsnlM5t4unEJ0n0": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01S6BPQESSX1J2lrfBrlSyllQkTIdm3uQoe$",
                                        "variable_workflow_01QFDWH91N2T04DPadLeuWLn0hPQBEdxbgZ": "$activity.definition_activity_01SBLXA5VD2E018xRncuww9sDyvkaa6oQW2.output.script_queries.Object Name$",
                                        "variable_workflow_01QHUHPCHZCRG19cgEY94aieokgUxEMtzaZ": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBBTW2WA37M2fvFzuIJBMyCa7GRg7ldDO$",
                                        "variable_workflow_01QZ6HUP59C8K4nUVPojPIE79ofWxLKG3Bp": "root"
                                      },
                                      "runtime_user": {
                                        "target_default": true
                                      },
                                      "skip_execution": false,
                                      "target": {
                                        "use_workflow_target_group": true
                                      },
                                      "workflow_id": "definition_workflow_01QCYG8UTYAXE2w8zM3Mn9RTBQXaMPNNl6e"
                                    },
                                    "object_type": "definition_activity"
                                  },
                                  {
                                    "unique_name": "definition_activity_01SBLE52WVHQH2lek3AsUDOY3ualwdmOFA0",
                                    "name": "Condition Block",
                                    "title": "Critical Error Occurred?",
                                    "type": "logic.if_else",
                                    "base_type": "activity",
                                    "properties": {
                                      "continue_on_failure": false,
                                      "display_name": "Critical Error Occurred?",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "blocks": [
                                      {
                                        "unique_name": "definition_activity_01SBLE52WWDU63tygYW0UW0FRrb2o7XInzZ",
                                        "name": "Condition Branch",
                                        "title": "Yes",
                                        "type": "logic.condition_block",
                                        "base_type": "activity",
                                        "properties": {
                                          "condition": {
                                            "left_operand": "$activity.definition_activity_01SBCUR0TX8BN0gacf2FIoleSRfDnlv6dpO.output.succeeded$",
                                            "operator": "eq",
                                            "right_operand": false
                                          },
                                          "continue_on_failure": false,
                                          "display_name": "Yes",
                                          "skip_execution": false
                                        },
                                        "object_type": "definition_activity",
                                        "actions": [
                                          {
                                            "unique_name": "definition_activity_01SBLE52WZXD924dZfRVw1lAtqhZJ8AWmnt",
                                            "name": "ServiceNow - Add Work Note to Firewall Rule Task",
                                            "title": "ServiceNow - Add Work Note to Firewall Rule Task",
                                            "type": "workflow.atomic_workflow",
                                            "base_type": "subworkflow",
                                            "properties": {
                                              "continue_on_failure": false,
                                              "display_name": "ServiceNow - Add Work Note to Firewall Rule Task",
                                              "input": {
                                                "variable_workflow_01O26LHVKETWS6NlqDRxw7LozFb5PYuORuj": "$activity.definition_activity_01SBFRZPMC5XH4y9ws02Umtm7b6VoWnc827.output.script_queries.ServiceNow Task ID$",
                                                "variable_workflow_01O26LHVKEV5Z72XukftJQPOqPzsRpLGjzl": "[code]\u003ch2\u003eMessage from Fortinet - FortiGate - Request Threat Containment \u003c/h2\u003e[/code]\n$activity.definition_activity_01SBCUR0TX8BN0gacf2FIoleSRfDnlv6dpO.output.error.message$",
                                                "variable_workflow_01OX8KRPV34425GXjwybtQzddzhwdSmpqmk": "v2"
                                              },
                                              "runtime_user": {
                                                "target_default": true
                                              },
                                              "skip_execution": false,
                                              "target": {
                                                "override_workflow_target_group_criteria": true,
                                                "target_group": {
                                                  "run_on_all_targets": false,
                                                  "use_criteria": {
                                                    "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                                    "conditions": [
                                                      {
                                                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                                        "operator": "eqi",
                                                        "right_operand": "ServiceNow_API"
                                                      }
                                                    ]
                                                  }
                                                }
                                              },
                                              "workflow_id": "definition_workflow_01O26LHVR14XR5ggjibxICB3qkpqZ7HuQmc"
                                            },
                                            "object_type": "definition_activity"
                                          },
                                          {
                                            "unique_name": "definition_activity_01SBLE52X1RW04V2sRszvhWSD8bj4UnNeWv",
                                            "name": "Completed",
                                            "title": "Failed",
                                            "type": "logic.completed",
                                            "base_type": "activity",
                                            "properties": {
                                              "completion_type": "failed-completed",
                                              "continue_on_failure": false,
                                              "display_name": "Failed",
                                              "result_message": "Failed to process Threat Containment Request.\n$activity.definition_activity_01SBCUR0TX8BN0gacf2FIoleSRfDnlv6dpO.output.error.message$",
                                              "skip_execution": false
                                            },
                                            "object_type": "definition_activity"
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "unique_name": "definition_activity_01SBBLMW6KOEB58EJVoEKBc0gteYiCVS5H8",
                        "name": "Condition Branch",
                        "title": "No",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                          "condition": {
                            "left_operand": "$activity.definition_activity_01S6EI6UL39RW0n6VOJFesQT1e8VCwrmqSz.input.source_array[@].group$",
                            "operator": "eq",
                            "right_operand": ""
                          },
                          "continue_on_failure": false,
                          "display_name": "No",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01SBBLMW6LKWI2ZNNPOsjYf0kunRXTeHYcq",
                            "name": "Execute Python Script",
                            "title": "Generate UUID to create unique name",
                            "type": "python3.script",
                            "base_type": "activity",
                            "properties": {
                              "action_timeout": 180,
                              "continue_on_failure": false,
                              "display_name": "Generate UUID to create unique name",
                              "script": "from sys import argv\nfrom uuid import uuid4\n\nprefix = argv[1]\naddress_group_name = f\"{prefix}-AddressGroup-{uuid4()}\"",
                              "script_arguments": [
                                "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SB9LG5ALPAB7SVBpxRQNCpK6FQSnPe9Kj$"
                              ],
                              "script_queries": [
                                {
                                  "script_query": "address_group_name",
                                  "script_query_name": "Address Group Name",
                                  "script_query_type": "string"
                                }
                              ],
                              "skip_execution": false
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01SBCS3S4QQ0A0OZXFTPMKAHbGvxpru9JYH",
                            "name": "Fortinet - FortiGate - Create Address Group",
                            "title": "Fortinet - FortiGate - Create Address Group",
                            "type": "workflow.atomic_workflow",
                            "base_type": "subworkflow",
                            "properties": {
                              "continue_on_failure": true,
                              "display_name": "Fortinet - FortiGate - Create Address Group",
                              "input": {
                                "variable_workflow_01QCYG8UMC62K3m6m1L8dsnlM5t4unEJ0n0": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01S6BPQESSX1J2lrfBrlSyllQkTIdm3uQoe$",
                                "variable_workflow_01QFDWH91N2T04DPadLeuWLn0hPQBEdxbgZ": "$activity.definition_activity_01SBLXA5VD2E018xRncuww9sDyvkaa6oQW2.output.script_queries.Object Name$",
                                "variable_workflow_01QHUHPCHZCRG19cgEY94aieokgUxEMtzaZ": "$activity.definition_activity_01SBBLMW6LKWI2ZNNPOsjYf0kunRXTeHYcq.output.script_queries.Address Group Name$",
                                "variable_workflow_01QZ6HUP59C8K4nUVPojPIE79ofWxLKG3Bp": "root"
                              },
                              "runtime_user": {
                                "target_default": true
                              },
                              "skip_execution": false,
                              "target": {
                                "use_workflow_target_group": true
                              },
                              "workflow_id": "definition_workflow_01QCYG8UTYAXE2w8zM3Mn9RTBQXaMPNNl6e"
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01SBLEJL0BZNV5ZF26UyLxDOKelGa9Th4oo",
                            "name": "Condition Block",
                            "title": "Critical Error Occurred?",
                            "type": "logic.if_else",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Critical Error Occurred?",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "blocks": [
                              {
                                "unique_name": "definition_activity_01SBLEJL0CL3B7AYwBtZ66e8SzDvBnwmtBl",
                                "name": "Condition Branch",
                                "title": "Yes",
                                "type": "logic.condition_block",
                                "base_type": "activity",
                                "properties": {
                                  "condition": {
                                    "left_operand": "$activity.definition_activity_01SBCS3S4QQ0A0OZXFTPMKAHbGvxpru9JYH.output.succeeded$",
                                    "operator": "eq",
                                    "right_operand": false
                                  },
                                  "continue_on_failure": false,
                                  "display_name": "Yes",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "actions": [
                                  {
                                    "unique_name": "definition_activity_01SBLEJL0H2BW1EuDfUN2JKgRrkAYtyeZQ8",
                                    "name": "ServiceNow - Add Work Note to Firewall Rule Task",
                                    "title": "ServiceNow - Add Work Note to Firewall Rule Task",
                                    "type": "workflow.atomic_workflow",
                                    "base_type": "subworkflow",
                                    "properties": {
                                      "continue_on_failure": false,
                                      "display_name": "ServiceNow - Add Work Note to Firewall Rule Task",
                                      "input": {
                                        "variable_workflow_01O26LHVKETWS6NlqDRxw7LozFb5PYuORuj": "$activity.definition_activity_01SBFRZPMC5XH4y9ws02Umtm7b6VoWnc827.output.script_queries.ServiceNow Task ID$",
                                        "variable_workflow_01O26LHVKEV5Z72XukftJQPOqPzsRpLGjzl": "[code]\u003ch2\u003eMessage from Fortinet - FortiGate - Request Threat Containment \u003c/h2\u003e[/code]\n$activity.definition_activity_01SBCS3S4QQ0A0OZXFTPMKAHbGvxpru9JYH.output.error.message$",
                                        "variable_workflow_01OX8KRPV34425GXjwybtQzddzhwdSmpqmk": "v2"
                                      },
                                      "runtime_user": {
                                        "target_default": true
                                      },
                                      "skip_execution": false,
                                      "target": {
                                        "override_workflow_target_group_criteria": true,
                                        "target_group": {
                                          "run_on_all_targets": false,
                                          "use_criteria": {
                                            "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                            "conditions": [
                                              {
                                                "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                                "operator": "eqi",
                                                "right_operand": "ServiceNow_API"
                                              }
                                            ]
                                          }
                                        }
                                      },
                                      "workflow_id": "definition_workflow_01O26LHVR14XR5ggjibxICB3qkpqZ7HuQmc"
                                    },
                                    "object_type": "definition_activity"
                                  },
                                  {
                                    "unique_name": "definition_activity_01SBLEJL0IS5O51ZqVzK9VYXtYPSgK9QhzX",
                                    "name": "Completed",
                                    "title": "Failed",
                                    "type": "logic.completed",
                                    "base_type": "activity",
                                    "properties": {
                                      "completion_type": "failed-completed",
                                      "continue_on_failure": false,
                                      "display_name": "Failed",
                                      "result_message": "Failed to process Threat Containment Request.\n$activity.definition_activity_01SBCS3S4QQ0A0OZXFTPMKAHbGvxpru9JYH.output.error.message$",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity"
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "unique_name": "definition_activity_01SBBO2TE8UKD4WiSN2rHxLjPjHH3LYy5mE",
                            "name": "Condition Block",
                            "title": "Source or Destination Address Group?",
                            "type": "logic.if_else",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Source or Destination Address Group?",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "blocks": [
                              {
                                "unique_name": "definition_activity_01SBBO2TE9FBH64xI4MTiXMDih9Ih2v2XTs",
                                "name": "Condition Branch",
                                "title": "Source Address Group",
                                "type": "logic.condition_block",
                                "base_type": "activity",
                                "properties": {
                                  "condition": {
                                    "left_operand": "$activity.definition_activity_01S6EI6UL39RW0n6VOJFesQT1e8VCwrmqSz.input.source_array[@].direction$",
                                    "operator": "eq",
                                    "right_operand": "source"
                                  },
                                  "continue_on_failure": false,
                                  "display_name": "Source Address Group",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "actions": [
                                  {
                                    "unique_name": "definition_activity_01SBBO2TEB93O5nyiWEyllbLfFAv34dDqRe",
                                    "name": "Set Variables",
                                    "title": "Set Variable",
                                    "type": "core.set_multiple_variables",
                                    "base_type": "activity",
                                    "properties": {
                                      "continue_on_failure": false,
                                      "display_name": "Set Variable",
                                      "skip_execution": false,
                                      "variables_to_update": [
                                        {
                                          "variable_to_update": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBBTW2WA37M2fvFzuIJBMyCa7GRg7ldDO$",
                                          "variable_value_new": "$activity.definition_activity_01SBCS3S4QQ0A0OZXFTPMKAHbGvxpru9JYH.output.variable_workflow_01QCYG8UMCCS05YeDk3P1pt3OOXGHM55hi3$"
                                        }
                                      ]
                                    },
                                    "object_type": "definition_activity"
                                  }
                                ]
                              },
                              {
                                "unique_name": "definition_activity_01SBBO2TEEHQS2X4i6piHo7Xi0qbsU76Afc",
                                "name": "Condition Branch",
                                "title": "Destination Address Group",
                                "type": "logic.condition_block",
                                "base_type": "activity",
                                "properties": {
                                  "condition": {
                                    "left_operand": "$activity.definition_activity_01S6EI6UL39RW0n6VOJFesQT1e8VCwrmqSz.input.source_array[@].direction$",
                                    "operator": "eq",
                                    "right_operand": "destination"
                                  },
                                  "continue_on_failure": false,
                                  "display_name": "Destination Address Group",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "actions": [
                                  {
                                    "unique_name": "definition_activity_01SBBO2TEF3CY7H1uOowfLCUQlFJzyby2ys",
                                    "name": "Set Variables",
                                    "title": "Set Variable",
                                    "type": "core.set_multiple_variables",
                                    "base_type": "activity",
                                    "properties": {
                                      "continue_on_failure": false,
                                      "display_name": "Set Variable",
                                      "skip_execution": false,
                                      "variables_to_update": [
                                        {
                                          "variable_to_update": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBBU6YZFLHU7ivu9e9Rki8KhZrxORq6sR$",
                                          "variable_value_new": "$activity.definition_activity_01SBCS3S4QQ0A0OZXFTPMKAHbGvxpru9JYH.output.variable_workflow_01QCYG8UMCCS05YeDk3P1pt3OOXGHM55hi3$"
                                        }
                                      ]
                                    },
                                    "object_type": "definition_activity"
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_01SBD4M7J4RSI3HmMwvSBwY5qr3lNWrJFd4",
        "name": "Condition Block",
        "title": "Policy name provided?",
        "type": "logic.if_else",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Policy name provided?",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "blocks": [
          {
            "unique_name": "definition_activity_01SBD4M7S4HRU0IuvVg9wyCzxGkaQoG19zz",
            "name": "Condition Branch",
            "title": "Yes",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBD5N18ZK7Z5l1EvvX4lRhjBDNkLL1VMI$",
                "operator": "ne",
                "right_operand": ""
              },
              "continue_on_failure": false,
              "display_name": "Yes",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01SBD6B9UADAI1eDxrUDAtqqB6E4tVnT7Hh",
                "name": "Fortinet - FortiGate - Get Policy by Name",
                "title": "Fortinet - FortiGate - Get Policy by Name",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": true,
                  "display_name": "Fortinet - FortiGate - Get Policy by Name",
                  "input": {
                    "variable_workflow_01QIUK02DI1IF4L5JSfJ1dW6v53vUb5sKrd": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01S6BPQESSX1J2lrfBrlSyllQkTIdm3uQoe$",
                    "variable_workflow_01QIUK02DI2PR41Jf3FNKjTlsvabn7pRwAJ": "$activity.definition_activity_01SBFRZPMC5XH4y9ws02Umtm7b6VoWnc827.output.script_queries.Policy$",
                    "variable_workflow_01QZ7S20AIWUG4syV8kHuL1uInjCRVDLDJs": "root"
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "use_workflow_target_group": true
                  },
                  "workflow_id": "definition_workflow_01QIUK02LX1IV6JwzN4GYkZHhcTIw3RRTzf"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01SBKJ43LBMO12DiEkgo45Bc7Vq2LjNYEnW",
                "name": "Condition Block",
                "title": "Critical Error Occurred?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Critical Error Occurred?",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01SBKJ43LC5ZH4qQ1Mob4LXL3pm49U7dIqX",
                    "name": "Condition Branch",
                    "title": "Yes",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": {
                          "left_operand": "$activity.definition_activity_01SBD6B9UADAI1eDxrUDAtqqB6E4tVnT7Hh.output.succeeded$",
                          "operator": "eq",
                          "right_operand": false
                        },
                        "operator": "and",
                        "right_operand": {
                          "left_operand": "$activity.definition_activity_01SBD6B9UADAI1eDxrUDAtqqB6E4tVnT7Hh.output.error.message$",
                          "operator": "eq",
                          "right_operand": "Status code: 404"
                        }
                      },
                      "continue_on_failure": false,
                      "display_name": "Yes",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01SBKJ43LFX9H3HoZKWCMchsEuVaDVEKU3N",
                        "name": "ServiceNow - Add Work Note to Firewall Rule Task",
                        "title": "ServiceNow - Add Work Note to Firewall Rule Task",
                        "type": "workflow.atomic_workflow",
                        "base_type": "subworkflow",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "ServiceNow - Add Work Note to Firewall Rule Task",
                          "input": {
                            "variable_workflow_01O26LHVKETWS6NlqDRxw7LozFb5PYuORuj": "$activity.definition_activity_01SBFRZPMC5XH4y9ws02Umtm7b6VoWnc827.output.script_queries.ServiceNow Task ID$",
                            "variable_workflow_01O26LHVKEV5Z72XukftJQPOqPzsRpLGjzl": "[code]\u003ch2\u003eMessage from Fortinet - FortiGate - Request Threat Containment \u003c/h2\u003e[/code]\n$activity.definition_activity_01SBD6B9UADAI1eDxrUDAtqqB6E4tVnT7Hh.output.error.message$",
                            "variable_workflow_01OX8KRPV34425GXjwybtQzddzhwdSmpqmk": "v2"
                          },
                          "runtime_user": {
                            "target_default": true
                          },
                          "skip_execution": false,
                          "target": {
                            "override_workflow_target_group_criteria": true,
                            "target_group": {
                              "run_on_all_targets": false,
                              "use_criteria": {
                                "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                "conditions": [
                                  {
                                    "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                    "operator": "eqi",
                                    "right_operand": "ServiceNow_API"
                                  }
                                ]
                              }
                            }
                          },
                          "workflow_id": "definition_workflow_01O26LHVR14XR5ggjibxICB3qkpqZ7HuQmc"
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01SBKJ43LHQZS14eOIdPOIoVBA6eC97vBaV",
                        "name": "Completed",
                        "title": "Failed",
                        "type": "logic.completed",
                        "base_type": "activity",
                        "properties": {
                          "completion_type": "failed-completed",
                          "continue_on_failure": false,
                          "display_name": "Failed",
                          "result_message": "Failed to process Threat Containment Request.\n$activity.definition_activity_01SBD6B9UADAI1eDxrUDAtqqB6E4tVnT7Hh.output.error.message$",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01SBEDJV038HB4BKHAl73U9KTlBvZKzGsQe",
                "name": "Condition Block",
                "title": "Policy Name found?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Policy Name found?",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01SBEDJV8E7P15QNc1hf1xBH765N6GxLt1p",
                    "name": "Condition Branch",
                    "title": "Yes",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01SBD6B9UADAI1eDxrUDAtqqB6E4tVnT7Hh.output.succeeded$",
                        "operator": "eq",
                        "right_operand": true
                      },
                      "continue_on_failure": false,
                      "display_name": "Yes",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01SBDPZ2K34A77FN5sJYXgBiNaLSYznr0Oe",
                        "name": "JSONPath Query",
                        "title": "Extract Policy Action",
                        "type": "corejava.jsonpathquery",
                        "base_type": "activity",
                        "properties": {
                          "action_timeout": 180,
                          "continue_on_failure": false,
                          "display_name": "Extract Policy Action",
                          "input_json": "$activity.definition_activity_01SBD6B9UADAI1eDxrUDAtqqB6E4tVnT7Hh.output.variable_workflow_01QIUK02DI7JL4sgSk2xE8cVHVvCv30Hgas$",
                          "jsonpath_queries": [
                            {
                              "jsonpath_query": ".results[0].action",
                              "jsonpath_query_name": "Action",
                              "jsonpath_query_type": "string"
                            }
                          ],
                          "skip_execution": false
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01SBDRM869XVF1EG14C8YYZeeV8GLogZtQt",
                        "name": "Condition Block",
                        "title": "Action correct?",
                        "type": "logic.if_else",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Action correct?",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "blocks": [
                          {
                            "unique_name": "definition_activity_01SBDRM8DP7Z45lzKl1JEClEVjWoBiGyGbS",
                            "name": "Condition Branch",
                            "title": "Yes",
                            "type": "logic.condition_block",
                            "base_type": "activity",
                            "properties": {
                              "condition": {
                                "left_operand": "$activity.definition_activity_01SBDPZ2K34A77FN5sJYXgBiNaLSYznr0Oe.output.jsonpath_queries.Action$",
                                "operator": "eqi",
                                "right_operand": "$activity.definition_activity_01SBFRZPMC5XH4y9ws02Umtm7b6VoWnc827.output.script_queries.Action$"
                              },
                              "continue_on_failure": false,
                              "display_name": "Yes",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01SBEHNV3YOGB7b5X3pdHIoWr5HWkSXlV8R",
                                "name": "Fortinet - FortiGate - Update Firewall Policy",
                                "title": "Fortinet - FortiGate - Update Firewall Policy",
                                "type": "workflow.atomic_workflow",
                                "base_type": "subworkflow",
                                "properties": {
                                  "continue_on_failure": true,
                                  "display_name": "Fortinet - FortiGate - Update Firewall Policy",
                                  "input": {
                                    "variable_workflow_01QNX6UNA0R2440XMUMiAAL1zqP9YwBrOUC": "",
                                    "variable_workflow_01QNX6UNA0WA022tb2ooU9vbzpN6TovSCiC": "$activity.definition_activity_01SBD6B9UADAI1eDxrUDAtqqB6E4tVnT7Hh.output.variable_workflow_01QIUK02DHUFV5m3AAJ9VSfPBXcC36ZMSTB$",
                                    "variable_workflow_01QNX6UNA0ZY73OjTb7JSXIDO1uivd13tDq": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBBTW2WA37M2fvFzuIJBMyCa7GRg7ldDO$",
                                    "variable_workflow_01QNX6UNA15056jt8u1hL24BzMRo5ZSzL25": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01S6BPQESSX1J2lrfBrlSyllQkTIdm3uQoe$",
                                    "variable_workflow_01QNX6UNA16KB5NHApxJFEu93dlrxEdD7DK": "root",
                                    "variable_workflow_01QNZNYDZ0G953p4PSo6QbYK3xG0Mhhoymi": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBBU6YZFLHU7ivu9e9Rki8KhZrxORq6sR$",
                                    "variable_workflow_01QNZPXCL0G923vude6JTUJukZjKxAnKpRB": ""
                                  },
                                  "runtime_user": {
                                    "target_default": true
                                  },
                                  "skip_execution": false,
                                  "target": {
                                    "use_workflow_target_group": true
                                  },
                                  "workflow_id": "definition_workflow_01QNX6UNITCLT5hFo0PqHo1Ajkua15WaSmO"
                                },
                                "object_type": "definition_activity"
                              },
                              {
                                "unique_name": "definition_activity_01SBKM3Y2CGBH3n0HAHKtzVgCTaR1Xcxgvm",
                                "name": "Condition Block",
                                "title": "Critical Error Occurred?",
                                "type": "logic.if_else",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Critical Error Occurred?",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "blocks": [
                                  {
                                    "unique_name": "definition_activity_01SBKM3Y2D0PM7SyCAehvGG8RWuCyhdJrqw",
                                    "name": "Condition Branch",
                                    "title": "Yes",
                                    "type": "logic.condition_block",
                                    "base_type": "activity",
                                    "properties": {
                                      "condition": {
                                        "left_operand": "$activity.definition_activity_01SBEHNV3YOGB7b5X3pdHIoWr5HWkSXlV8R.output.succeeded$",
                                        "operator": "eq",
                                        "right_operand": false
                                      },
                                      "continue_on_failure": false,
                                      "display_name": "Yes",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "actions": [
                                      {
                                        "unique_name": "definition_activity_01SBKM3Y2IR2B6pjlXPGmyx9h3VkVKU9NZj",
                                        "name": "ServiceNow - Add Work Note to Firewall Rule Task",
                                        "title": "ServiceNow - Add Work Note to Firewall Rule Task",
                                        "type": "workflow.atomic_workflow",
                                        "base_type": "subworkflow",
                                        "properties": {
                                          "continue_on_failure": false,
                                          "display_name": "ServiceNow - Add Work Note to Firewall Rule Task",
                                          "input": {
                                            "variable_workflow_01O26LHVKETWS6NlqDRxw7LozFb5PYuORuj": "$activity.definition_activity_01SBFRZPMC5XH4y9ws02Umtm7b6VoWnc827.output.script_queries.ServiceNow Task ID$",
                                            "variable_workflow_01O26LHVKEV5Z72XukftJQPOqPzsRpLGjzl": "[code]\u003ch2\u003eMessage from Fortinet - FortiGate - Request Threat Containment \u003c/h2\u003e[/code]\n$activity.definition_activity_01SBEHNV3YOGB7b5X3pdHIoWr5HWkSXlV8R.output.error.message$",
                                            "variable_workflow_01OX8KRPV34425GXjwybtQzddzhwdSmpqmk": "v2"
                                          },
                                          "runtime_user": {
                                            "target_default": true
                                          },
                                          "skip_execution": false,
                                          "target": {
                                            "override_workflow_target_group_criteria": true,
                                            "target_group": {
                                              "run_on_all_targets": false,
                                              "use_criteria": {
                                                "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                                "conditions": [
                                                  {
                                                    "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                                    "operator": "eqi",
                                                    "right_operand": "ServiceNow_API"
                                                  }
                                                ]
                                              }
                                            }
                                          },
                                          "workflow_id": "definition_workflow_01O26LHVR14XR5ggjibxICB3qkpqZ7HuQmc"
                                        },
                                        "object_type": "definition_activity"
                                      },
                                      {
                                        "unique_name": "definition_activity_01SBKM3Y2KIO74KJgd5CFoWpLEk3LzmTWhZ",
                                        "name": "Completed",
                                        "title": "Failed",
                                        "type": "logic.completed",
                                        "base_type": "activity",
                                        "properties": {
                                          "completion_type": "failed-completed",
                                          "continue_on_failure": false,
                                          "display_name": "Failed",
                                          "result_message": "Failed to process Threat Containment Request.\n$activity.definition_activity_01SBEHNV3YOGB7b5X3pdHIoWr5HWkSXlV8R.output.error.message$",
                                          "skip_execution": false
                                        },
                                        "object_type": "definition_activity"
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "unique_name": "definition_activity_01SBE3SJA8BHV3hR5m9Uby7bBT2jeC7YglB",
                            "name": "Condition Branch",
                            "title": "No",
                            "type": "logic.condition_block",
                            "base_type": "activity",
                            "properties": {
                              "condition": {
                                "left_operand": "$activity.definition_activity_01SBDPZ2K34A77FN5sJYXgBiNaLSYznr0Oe.output.jsonpath_queries.Action$",
                                "operator": "ne",
                                "right_operand": "$activity.definition_activity_01SBFRZPMC5XH4y9ws02Umtm7b6VoWnc827.output.script_queries.Action$"
                              },
                              "continue_on_failure": false,
                              "display_name": "No",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01SBE40AXO4JO0V4u07ECMDgVYqOkN4559C",
                                "name": "Set Variables",
                                "title": "Set Variable Wrong Policy Action",
                                "type": "core.set_multiple_variables",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Set Variable Wrong Policy Action",
                                  "skip_execution": false,
                                  "variables_to_update": [
                                    {
                                      "variable_to_update": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBE4UJDYJF52tMYY5CyhoutfZ3mi5RF4n$",
                                      "variable_value_new": true
                                    }
                                  ]
                                },
                                "object_type": "definition_activity"
                              },
                              {
                                "unique_name": "definition_activity_01SBKOCK2BG760NczhYzbik268A1zUxqIyC",
                                "name": "ServiceNow - Add Work Note to Firewall Rule Task",
                                "title": "ServiceNow - Add Work Note to Firewall Rule Task",
                                "type": "workflow.atomic_workflow",
                                "base_type": "subworkflow",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "ServiceNow - Add Work Note to Firewall Rule Task",
                                  "input": {
                                    "variable_workflow_01O26LHVKETWS6NlqDRxw7LozFb5PYuORuj": "$activity.definition_activity_01SBFRZPMC5XH4y9ws02Umtm7b6VoWnc827.output.script_queries.ServiceNow Task ID$",
                                    "variable_workflow_01O26LHVKEV5Z72XukftJQPOqPzsRpLGjzl": "[code]\u003ch2\u003eMessage from Fortinet - FortiGate - Request Threat Containment \u003c/h2\u003e\nThe Policy \"$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBD5N18ZK7Z5l1EvvX4lRhjBDNkLL1VMI$\" has the wrong action (\u003cb\u003e$activity.definition_activity_01SBFRZPMC5XH4y9ws02Umtm7b6VoWnc827.output.script_queries.Action$\u003c/b\u003e instead of \u003cb\u003e$activity.definition_activity_01SBDPZ2K34A77FN5sJYXgBiNaLSYznr0Oe.output.jsonpath_queries.Action$\u003c/b\u003e), so that a new Policy will be created.\n[/code]",
                                    "variable_workflow_01OX8KRPV34425GXjwybtQzddzhwdSmpqmk": "v2"
                                  },
                                  "runtime_user": {
                                    "target_default": true
                                  },
                                  "skip_execution": false,
                                  "target": {
                                    "override_workflow_target_group_criteria": true,
                                    "target_group": {
                                      "run_on_all_targets": false,
                                      "use_criteria": {
                                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                        "conditions": [
                                          {
                                            "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                            "operator": "eqi",
                                            "right_operand": "ServiceNow_API"
                                          }
                                        ]
                                      }
                                    }
                                  },
                                  "workflow_id": "definition_workflow_01O26LHVR14XR5ggjibxICB3qkpqZ7HuQmc"
                                },
                                "object_type": "definition_activity"
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "unique_name": "definition_activity_01SBEDJVFM76G5R89SyHs04VARrqC8jknYA",
                    "name": "Condition Branch",
                    "title": "No",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01SBD6B9UADAI1eDxrUDAtqqB6E4tVnT7Hh.output.succeeded$",
                        "operator": "eq",
                        "right_operand": false
                      },
                      "continue_on_failure": false,
                      "display_name": "No",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01SBEFIZ4C1442sCBLicrtrprWWjXAv0wPk",
                        "name": "Fortinet - FortiGate - Create Firewall Policy",
                        "title": "Fortinet - FortiGate - Create Firewall Policy",
                        "type": "workflow.atomic_workflow",
                        "base_type": "subworkflow",
                        "properties": {
                          "continue_on_failure": true,
                          "display_name": "Fortinet - FortiGate - Create Firewall Policy",
                          "input": {
                            "variable_workflow_01QEKYC6NLUY01wNt1j7ZE7dX5FRo7AHclU": "",
                            "variable_workflow_01QEKYC6NM3EZ3biMNp14AAr4Xt4cnAW7oo": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01S6BPQESSX1J2lrfBrlSyllQkTIdm3uQoe$",
                            "variable_workflow_01QENMW1213UT0Dd0NnaSmzCwtvdpqEFy01": "",
                            "variable_workflow_01QENN5K8VOH4209wiKKonbcMpW7qHgdB4l": "",
                            "variable_workflow_01QHXEVCCL0NG1kqFXbO2K8WzTcQeqEiSOW": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBBTW2WA37M2fvFzuIJBMyCa7GRg7ldDO$",
                            "variable_workflow_01QHXFEOX0FUH6A5VGkORz8y0SsG8SWCLBS": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBBU6YZFLHU7ivu9e9Rki8KhZrxORq6sR$",
                            "variable_workflow_01QHXGJ3NBMN8476dbsFaHZ1G5UQ7oA4iKV": "$activity.definition_activity_01SBFRZPMC5XH4y9ws02Umtm7b6VoWnc827.output.script_queries.Action$",
                            "variable_workflow_01QHXR0MUE9A55M1Jmtb6EUmVVBzEhR4r1F": "$activity.definition_activity_01SBFRZPMC5XH4y9ws02Umtm7b6VoWnc827.output.script_queries.Policy$",
                            "variable_workflow_01QZ7D0M9PNUC4Z3zAHPZBFuhNfP9HfA5RL": "root"
                          },
                          "runtime_user": {
                            "target_default": true
                          },
                          "skip_execution": false,
                          "target": {
                            "use_workflow_target_group": true
                          },
                          "workflow_id": "definition_workflow_01QEKYC6UW4XZ1w1cPVACPX85Vy4BJAAbq5"
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01SBKL5F7CAZB18O9kxlevwWZZdeBuJIyIg",
                        "name": "Condition Block",
                        "title": "Critical Error Occurred?",
                        "type": "logic.if_else",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Critical Error Occurred?",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "blocks": [
                          {
                            "unique_name": "definition_activity_01SBKL5F7CX144DSzgXG6AWmn8n2qOqMy5h",
                            "name": "Condition Branch",
                            "title": "Yes",
                            "type": "logic.condition_block",
                            "base_type": "activity",
                            "properties": {
                              "condition": {
                                "left_operand": "$activity.definition_activity_01SBEFIZ4C1442sCBLicrtrprWWjXAv0wPk.output.succeeded$",
                                "operator": "eq",
                                "right_operand": false
                              },
                              "continue_on_failure": false,
                              "display_name": "Yes",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01SBKL5F7GL447cQGFMblUSBbjnFDOFTIsz",
                                "name": "ServiceNow - Add Work Note to Firewall Rule Task",
                                "title": "ServiceNow - Add Work Note to Firewall Rule Task",
                                "type": "workflow.atomic_workflow",
                                "base_type": "subworkflow",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "ServiceNow - Add Work Note to Firewall Rule Task",
                                  "input": {
                                    "variable_workflow_01O26LHVKETWS6NlqDRxw7LozFb5PYuORuj": "$activity.definition_activity_01SBFRZPMC5XH4y9ws02Umtm7b6VoWnc827.output.script_queries.ServiceNow Task ID$",
                                    "variable_workflow_01O26LHVKEV5Z72XukftJQPOqPzsRpLGjzl": "[code]\u003ch2\u003eMessage from Fortinet - FortiGate - Request Threat Containment \u003c/h2\u003e[/code]\n$activity.definition_activity_01SBEFIZ4C1442sCBLicrtrprWWjXAv0wPk.output.error.message$",
                                    "variable_workflow_01OX8KRPV34425GXjwybtQzddzhwdSmpqmk": "v2"
                                  },
                                  "runtime_user": {
                                    "target_default": true
                                  },
                                  "skip_execution": false,
                                  "target": {
                                    "override_workflow_target_group_criteria": true,
                                    "target_group": {
                                      "run_on_all_targets": false,
                                      "use_criteria": {
                                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                        "conditions": [
                                          {
                                            "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                            "operator": "eqi",
                                            "right_operand": "ServiceNow_API"
                                          }
                                        ]
                                      }
                                    }
                                  },
                                  "workflow_id": "definition_workflow_01O26LHVR14XR5ggjibxICB3qkpqZ7HuQmc"
                                },
                                "object_type": "definition_activity"
                              },
                              {
                                "unique_name": "definition_activity_01SBKL5F7IBQQ5BJbdN3SwQrZf3bxbxWKTm",
                                "name": "Completed",
                                "title": "Failed",
                                "type": "logic.completed",
                                "base_type": "activity",
                                "properties": {
                                  "completion_type": "failed-completed",
                                  "continue_on_failure": false,
                                  "display_name": "Failed",
                                  "result_message": "Failed to process Threat Containment Request.\n$activity.definition_activity_01SBEFIZ4C1442sCBLicrtrprWWjXAv0wPk.output.error.message$",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity"
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "unique_name": "definition_activity_01SBKN65A2FWW1h63YU29FLqN60yub6PphL",
                        "name": "ServiceNow - Add Work Note to Firewall Rule Task",
                        "title": "ServiceNow - Add Work Note to Firewall Rule Task",
                        "type": "workflow.atomic_workflow",
                        "base_type": "subworkflow",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "ServiceNow - Add Work Note to Firewall Rule Task",
                          "input": {
                            "variable_workflow_01O26LHVKETWS6NlqDRxw7LozFb5PYuORuj": "$activity.definition_activity_01SBFRZPMC5XH4y9ws02Umtm7b6VoWnc827.output.script_queries.ServiceNow Task ID$",
                            "variable_workflow_01O26LHVKEV5Z72XukftJQPOqPzsRpLGjzl": "[code]\u003ch2\u003eMessage from Fortinet - FortiGate - Request Threat Containment \u003c/h2\u003e[/code]\nFirawall Policy \"$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBD5N18ZK7Z5l1EvvX4lRhjBDNkLL1VMI$\" was not found, but the new Policy with the name \"$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBD5N18ZK7Z5l1EvvX4lRhjBDNkLL1VMI$\" was created instead.",
                            "variable_workflow_01OX8KRPV34425GXjwybtQzddzhwdSmpqmk": "v2"
                          },
                          "runtime_user": {
                            "target_default": true
                          },
                          "skip_execution": false,
                          "target": {
                            "override_workflow_target_group_criteria": true,
                            "target_group": {
                              "run_on_all_targets": false,
                              "use_criteria": {
                                "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                "conditions": [
                                  {
                                    "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                    "operator": "eqi",
                                    "right_operand": "ServiceNow_API"
                                  }
                                ]
                              }
                            }
                          },
                          "workflow_id": "definition_workflow_01O26LHVR14XR5ggjibxICB3qkpqZ7HuQmc"
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_01SBEAYO9ZHPO1fWcB0FQN9oRSP4tQcHcEZ",
        "name": "Condition Block",
        "title": "Policy Name not provided or has wrong action?",
        "type": "logic.if_else",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Policy Name not provided or has wrong action?",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "blocks": [
          {
            "unique_name": "definition_activity_01SBEAYOGS2R748gf3sQSo6PH2WrhvZYWRB",
            "name": "Condition Branch",
            "title": "Yes",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": {
                  "left_operand": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBD5N18ZK7Z5l1EvvX4lRhjBDNkLL1VMI$",
                  "operator": "eq",
                  "right_operand": ""
                },
                "operator": "or",
                "right_operand": {
                  "left_operand": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBE4UJDYJF52tMYY5CyhoutfZ3mi5RF4n$",
                  "operator": "eq",
                  "right_operand": true
                }
              },
              "continue_on_failure": false,
              "display_name": "Yes",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01SBD78RRMTHT1IU0HlGgJaOaW8r3BEs3Lm",
                "name": "Execute Python Script",
                "title": "Generate UUID to create unique name",
                "type": "python3.script",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "continue_on_failure": false,
                  "display_name": "Generate UUID to create unique name",
                  "script": "from sys import argv\nfrom uuid import uuid4\n\nprefix = argv[1]\npolicy_name = f\"{prefix}-Policy-{str(uuid4())[:23]}\"",
                  "script_arguments": [
                    "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SB9LG5ALPAB7SVBpxRQNCpK6FQSnPe9Kj$"
                  ],
                  "script_queries": [
                    {
                      "script_query": "policy_name",
                      "script_query_name": "Policy Name",
                      "script_query_type": "string"
                    }
                  ],
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01SBDB9VNPZDF7deIqxfZFPa6u3hrxV1J6m",
                "name": "Fortinet - FortiGate - Create Firewall Policy",
                "title": "Fortinet - FortiGate - Create Firewall Policy",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": true,
                  "display_name": "Fortinet - FortiGate - Create Firewall Policy",
                  "input": {
                    "variable_workflow_01QEKYC6NLUY01wNt1j7ZE7dX5FRo7AHclU": "",
                    "variable_workflow_01QEKYC6NM3EZ3biMNp14AAr4Xt4cnAW7oo": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01S6BPQESSX1J2lrfBrlSyllQkTIdm3uQoe$",
                    "variable_workflow_01QENMW1213UT0Dd0NnaSmzCwtvdpqEFy01": "",
                    "variable_workflow_01QENN5K8VOH4209wiKKonbcMpW7qHgdB4l": "",
                    "variable_workflow_01QHXEVCCL0NG1kqFXbO2K8WzTcQeqEiSOW": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBBTW2WA37M2fvFzuIJBMyCa7GRg7ldDO$",
                    "variable_workflow_01QHXFEOX0FUH6A5VGkORz8y0SsG8SWCLBS": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBBU6YZFLHU7ivu9e9Rki8KhZrxORq6sR$",
                    "variable_workflow_01QHXGJ3NBMN8476dbsFaHZ1G5UQ7oA4iKV": "$activity.definition_activity_01SBFRZPMC5XH4y9ws02Umtm7b6VoWnc827.output.script_queries.Policy$",
                    "variable_workflow_01QHXR0MUE9A55M1Jmtb6EUmVVBzEhR4r1F": "$activity.definition_activity_01SBD78RRMTHT1IU0HlGgJaOaW8r3BEs3Lm.output.script_queries.Policy Name$",
                    "variable_workflow_01QZ7D0M9PNUC4Z3zAHPZBFuhNfP9HfA5RL": "root"
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "use_workflow_target_group": true
                  },
                  "workflow_id": "definition_workflow_01QEKYC6UW4XZ1w1cPVACPX85Vy4BJAAbq5"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01SBKRJCETLMP6i8E26Va62j7m0IHxzHdL1",
                "name": "Condition Block",
                "title": "Critical Error Occurred?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Critical Error Occurred?",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01SBKRJCEUD2O0gNXUVSeJpKWbKrXpAYHQj",
                    "name": "Condition Branch",
                    "title": "Yes",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01SBDB9VNPZDF7deIqxfZFPa6u3hrxV1J6m.output.succeeded$",
                        "operator": "eq",
                        "right_operand": false
                      },
                      "continue_on_failure": false,
                      "display_name": "Yes",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01SBKRJCEYH7U2fjBsmI8DtNgohQw9GF0um",
                        "name": "ServiceNow - Add Work Note to Firewall Rule Task",
                        "title": "ServiceNow - Add Work Note to Firewall Rule Task",
                        "type": "workflow.atomic_workflow",
                        "base_type": "subworkflow",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "ServiceNow - Add Work Note to Firewall Rule Task",
                          "input": {
                            "variable_workflow_01O26LHVKETWS6NlqDRxw7LozFb5PYuORuj": "$activity.definition_activity_01SBFRZPMC5XH4y9ws02Umtm7b6VoWnc827.output.script_queries.ServiceNow Task ID$",
                            "variable_workflow_01O26LHVKEV5Z72XukftJQPOqPzsRpLGjzl": "[code]\u003ch2\u003eMessage from Fortinet - FortiGate - Request Threat Containment \u003c/h2\u003e[/code]\n$activity.definition_activity_01SBDB9VNPZDF7deIqxfZFPa6u3hrxV1J6m.output.error.message$",
                            "variable_workflow_01OX8KRPV34425GXjwybtQzddzhwdSmpqmk": "v2"
                          },
                          "runtime_user": {
                            "target_default": true
                          },
                          "skip_execution": false,
                          "target": {
                            "override_workflow_target_group_criteria": true,
                            "target_group": {
                              "run_on_all_targets": false,
                              "use_criteria": {
                                "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                "conditions": [
                                  {
                                    "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                    "operator": "eqi",
                                    "right_operand": "ServiceNow_API"
                                  }
                                ]
                              }
                            }
                          },
                          "workflow_id": "definition_workflow_01O26LHVR14XR5ggjibxICB3qkpqZ7HuQmc"
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01SBKRJCF0AQQ4HNZS5vRMkhZUoO3wBRHib",
                        "name": "Completed",
                        "title": "Failed",
                        "type": "logic.completed",
                        "base_type": "activity",
                        "properties": {
                          "completion_type": "failed-completed",
                          "continue_on_failure": false,
                          "display_name": "Failed",
                          "result_message": "Failed to process Threat Containment Request.\n$activity.definition_activity_01SBDB9VNPZDF7deIqxfZFPa6u3hrxV1J6m.output.error.message$",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01SBDE1D57NVX59phupsKYt76nbywjyl7mx",
                "name": "Set Variables",
                "title": "Set Variable",
                "type": "core.set_multiple_variables",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Set Variable",
                  "skip_execution": false,
                  "variables_to_update": [
                    {
                      "variable_to_update": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBD5N18ZK7Z5l1EvvX4lRhjBDNkLL1VMI$",
                      "variable_value_new": "$activity.definition_activity_01SBD78RRMTHT1IU0HlGgJaOaW8r3BEs3Lm.output.script_queries.Policy Name$"
                    }
                  ]
                },
                "object_type": "definition_activity"
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_01SBFG2VKX43I3m72HkRJ6eWEYd8eulotIS",
        "name": "Fortinet - FortiGate - Move Policy To Top of Policy List",
        "title": "Fortinet - FortiGate - Move Policy To Top of Policy List",
        "type": "workflow.atomic_workflow",
        "base_type": "subworkflow",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Fortinet - FortiGate - Move Policy To Top of Policy List",
          "input": {
            "variable_workflow_01RL0ZYDSSTEA1H5YdUxbC5WZf3PGU31zBk": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBD5N18ZK7Z5l1EvvX4lRhjBDNkLL1VMI$",
            "variable_workflow_01RL0ZYDST2F13RUNFmIaNqBBtT4MtsXvlX": "$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01S6BPQESSX1J2lrfBrlSyllQkTIdm3uQoe$",
            "variable_workflow_01RL0ZYDST3YY33jZNgUsLBKnkFoRa7Vgcs": "root"
          },
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "use_workflow_target_group": true
          },
          "workflow_id": "definition_workflow_01RL0ZYE7UHXO0nAMEa55KHOiiLLvVzSQwX"
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_01SBKSD8HBQ6D4myA4aFCRKG4pWee5Nkv0c",
        "name": "Condition Block",
        "title": "Critical Error Occurred?",
        "type": "logic.if_else",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Critical Error Occurred?",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "blocks": [
          {
            "unique_name": "definition_activity_01SBKSD8HCA7E0HZQarE2nefn8wOV5GFJAN",
            "name": "Condition Branch",
            "title": "Yes",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$activity.definition_activity_01SBFG2VKX43I3m72HkRJ6eWEYd8eulotIS.output.succeeded$",
                "operator": "eq",
                "right_operand": false
              },
              "continue_on_failure": false,
              "display_name": "Yes",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01SBKSD8HGAP45XG45OgTDlSVDdSZrqZrCn",
                "name": "ServiceNow - Add Work Note to Firewall Rule Task",
                "title": "ServiceNow - Add Work Note to Firewall Rule Task",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "ServiceNow - Add Work Note to Firewall Rule Task",
                  "input": {
                    "variable_workflow_01O26LHVKETWS6NlqDRxw7LozFb5PYuORuj": "$activity.definition_activity_01SBFRZPMC5XH4y9ws02Umtm7b6VoWnc827.output.script_queries.ServiceNow Task ID$",
                    "variable_workflow_01O26LHVKEV5Z72XukftJQPOqPzsRpLGjzl": "[code]\u003ch2\u003eMessage from Fortinet - FortiGate - Request Threat Containment \u003c/h2\u003e[/code]\n$activity.definition_activity_01SBFG2VKX43I3m72HkRJ6eWEYd8eulotIS.output.error.message$",
                    "variable_workflow_01OX8KRPV34425GXjwybtQzddzhwdSmpqmk": "v2"
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "override_workflow_target_group_criteria": true,
                    "target_group": {
                      "run_on_all_targets": false,
                      "use_criteria": {
                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                        "conditions": [
                          {
                            "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                            "operator": "eqi",
                            "right_operand": "ServiceNow_API"
                          }
                        ]
                      }
                    }
                  },
                  "workflow_id": "definition_workflow_01O26LHVR14XR5ggjibxICB3qkpqZ7HuQmc"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01SBKSD8HI3YM7Rvmx0CapnnvmL46ZcEcoI",
                "name": "Completed",
                "title": "Failed",
                "type": "logic.completed",
                "base_type": "activity",
                "properties": {
                  "completion_type": "failed-completed",
                  "continue_on_failure": false,
                  "display_name": "Failed",
                  "result_message": "Failed to process Threat Containment Request.\n$activity.definition_activity_01SBFG2VKX43I3m72HkRJ6eWEYd8eulotIS.output.error.message$",
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_01SBKUM5YV8201BeIjyILW87qWdwyCXyiAv",
        "name": "ServiceNow - Add Work Note to Firewall Rule Task",
        "title": "ServiceNow - Add Work Note to Firewall Rule Task",
        "type": "workflow.atomic_workflow",
        "base_type": "subworkflow",
        "properties": {
          "continue_on_failure": false,
          "display_name": "ServiceNow - Add Work Note to Firewall Rule Task",
          "input": {
            "variable_workflow_01O26LHVKETWS6NlqDRxw7LozFb5PYuORuj": "$activity.definition_activity_01SBFRZPMC5XH4y9ws02Umtm7b6VoWnc827.output.script_queries.ServiceNow Task ID$",
            "variable_workflow_01O26LHVKEV5Z72XukftJQPOqPzsRpLGjzl": "[code]\u003ch2\u003eMessage from Fortinet - FortiGate - Request Threat Containment \u003c/h2\u003e\nFirawall Policy \"$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBD5N18ZK7Z5l1EvvX4lRhjBDNkLL1VMI$\" was created successfully.\n\u003cbr/\u003e\nObjects:\n\u003cul\u003e\n\u003cli\u003e\nSource Address Group: \"$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBBTW2WA37M2fvFzuIJBMyCa7GRg7ldDO$\" with object \"$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SB9OQ9J4RMT3JaxuNkO5BbVQBcn1GOOC1$\"\n\u003c/li\u003e\n\u003cli\u003e\nDestination Address Group: \"$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBBU6YZFLHU7ivu9e9Rki8KhZrxORq6sR$\" with object \"$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SB9PIPECCAL4L4Nb6HY857fnW7uLpEx71$\"\n\u003c/li\u003e\n\u003cli\u003e\nService Group: \"$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBATZ1JBTRB4y0iIpXGZkYfJNPnktOXPO$\" with object \"$workflow.definition_workflow_01S6AUJDD8LRG7MkYXhdf7irBMC3rSAJF1J.local.variable_workflow_01SBAKR6SYUQ12lXhdq78P30h0yFJuIcDLC$\"\n\u003c/li\u003e\n\u003c/ul\u003e\n[/code]",
            "variable_workflow_01OX8KRPV34425GXjwybtQzddzhwdSmpqmk": "v2"
          },
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "override_workflow_target_group_criteria": true,
            "target_group": {
              "run_on_all_targets": false,
              "use_criteria": {
                "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                "conditions": [
                  {
                    "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                    "operator": "eqi",
                    "right_operand": "ServiceNow_API"
                  }
                ]
              }
            }
          },
          "workflow_id": "definition_workflow_01O26LHVR14XR5ggjibxICB3qkpqZ7HuQmc"
        },
        "object_type": "definition_activity"
      }
    ],
    "categories": [
      "category_01FM7CGPZZCMY0KcvgiGjVH5UaB4y4aDJ7m"
    ]
  },
  "categories": {
    "category_01FM7CGPZZCMY0KcvgiGjVH5UaB4y4aDJ7m": {
      "unique_name": "category_01FM7CGPZZCMY0KcvgiGjVH5UaB4y4aDJ7m",
      "name": "response",
      "title": "response",
      "type": "basic.category",
      "base_type": "category",
      "category_type": "custom",
      "object_type": "category"
    }
  },
  "target_groups": {
    "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH": {
      "unique_name": "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH",
      "name": "Default TargetGroup",
      "title": "Default TargetGroup",
      "type": "generic.target_group",
      "base_type": "target_group",
      "version": "1.0.0",
      "targets": [
        {
          "data_target_type": "web-service.endpoint",
          "view_target_type": "web-service.endpoint",
          "include_all_targets": true
        },
        {
          "data_target_type": "email.smtp_endpoint",
          "view_target_type": "email.smtp_endpoint",
          "include_all_targets": true
        }
      ],
      "object_type": "target_group"
    }
  },
  "atomic_workflows": [
    "definition_workflow_01Q2H2423CNMQ55zxmxIlndVdm1FyYI9WvB",
    "definition_workflow_01S0C9RPDQDWD5dweMu1XWDQeA4IU48SC1F",
    "definition_workflow_01O26LHVR14XR5ggjibxICB3qkpqZ7HuQmc",
    "definition_workflow_01QJMY7EFE9EB0dUuvozT00neDnloTNQN05",
    "definition_workflow_01QKJSE0LURMP1XIO79isiyUAXKTDDZeCGV",
    "definition_workflow_01RZGROZT4HXO7Yzmi2GzZtLdMJTJ4MB2tQ",
    "definition_workflow_01QEKYC6UW4XZ1w1cPVACPX85Vy4BJAAbq5",
    "definition_workflow_01QNX6UNITCLT5hFo0PqHo1Ajkua15WaSmO",
    "definition_workflow_01RL0ZYE7UHXO0nAMEa55KHOiiLLvVzSQwX",
    "definition_workflow_01RZNYVXUXIG552KulMfFGCIBl8mRN1ZZvf",
    "definition_workflow_01RV9ELI34NB13GBEHhAGy60bTaNtnkFOEM",
    "definition_workflow_01QIUK02LX1IV6JwzN4GYkZHhcTIw3RRTzf",
    "definition_workflow_01QCYG8UTYAXE2w8zM3Mn9RTBQXaMPNNl6e"
  ]
}