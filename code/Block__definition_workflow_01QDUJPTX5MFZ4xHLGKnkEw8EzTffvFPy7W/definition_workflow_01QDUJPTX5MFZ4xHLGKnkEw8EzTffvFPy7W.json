{
  "workflow": {
    "unique_name": "definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W",
    "name": "Fortinet  - FortiGate - Block URL, IP or Domain",
    "title": "Fortinet  - FortiGate - Block URL, IP or Domain",
    "type": "generic.workflow",
    "base_type": "workflow",
    "variables": [
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "input",
          "name": "observable_type",
          "type": "datatype.string",
          "description": "Type of object to block.\nThis workflow supports url, ip and domain types.",
          "is_required": true,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01QDUWPO1WE3738QmwiLwBJbXce3agNJ7Kk",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.secure_string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Access Token",
          "type": "datatype.secure_string",
          "description": "Access Token for FortiGate API.  This can be generated by creating a new REST API Admin under System \u003e Administrators.",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01QVNBNH9JTYK3NfHWwhAzXMl4rzC8QLGvm",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Web Filter Name",
          "type": "datatype.string",
          "description": "The name of the Web Filter to add URL Filter to. This variable is required.",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01QENLZHPIVVI28kd2INwi2zuZncQeryxQr",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "SXo",
          "scope": "local",
          "name": "Name Prefix",
          "type": "datatype.string",
          "description": "Name Prefix for names of the objects which will be created automatically.",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01QXI76U3FI367PUsYmsAFxcPCIQeY3UVws",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Policy Name",
          "type": "datatype.string",
          "description": "Name of the Firewall Policy to be updated. This variable is required.",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01QXHR8UGUKKV3PzLWDz5cd9wfGxZ0M0WBc",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "URL Filter MKey",
          "type": "datatype.string",
          "description": "The MKey of the URL Filter. This will be populated automatically.",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01QXHDCQAJHNJ0v4PZklkjvjjbTrjGiY9Bi",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Address Name",
          "type": "datatype.string",
          "description": "The name of the Address. This will be populated automatically.",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01QXEW7YBXKOA67nOxzUyeafXXO7sWUTTyr",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "input",
          "name": "observable_value",
          "type": "datatype.string",
          "description": "The value of the observable to block.",
          "is_required": true,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01QDUWWV8OOA64LdyclajeziyBPSXN0JFIC",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Address Group Name",
          "type": "datatype.string",
          "description": "The Name of the Address Group to be updated with the provided observable value. This variable is required.",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01QENMB1Z1RQH358zoMEikzjGBvYRvrdvlA",
        "object_type": "variable_workflow"
      }
    ],
    "properties": {
      "atomic": {
        "is_atomic": false
      },
      "delete_workflow_instance": false,
      "description": "This is a response workflow that:\n- accepts a URL, IP, Domain observables as input\n   For IP and Domain:\n          - creates/reuses an Address and adds it to an Address Group  in FortiGate Firewall\n          - updates a firewall Policy and adds the Address Group to it\n For URL:\n          - creates a URL Filter and adds it to Web Filter in FortiGate Firewall\n          - updates a firewall Policy and adds the Web Filter to it\n\nTarget Group: Default TargetGroup\n\nTargets:  FortiGate, Microsoft Teams\n\nSteps: \n[] Defang observable\n[] Check if policy name provided\n[] Generate timestamps to create unique names\n[] Validate observable type\n[] Creates/reuses an Address and adds it to an Address Group (if IP/Domain)\n[] Creates a URL Filter and adds it to Web Filter (if URL)\n[] Update Firewall Policy\n[] Move Policy on top of the Policies list\n[] Post message to Microsoft Teams\n\nMore information about this API:  [placeholder]",
      "display_name": "Fortinet  - FortiGate - Block URL, IP or Domain",
      "runtime_user": {
        "target_default": true
      },
      "target": {
        "execute_on_target_group": true,
        "target_group": {
          "target_group_id": "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH",
          "run_on_all_targets": false,
          "selected_target_types": [
            "web-service.endpoint"
          ],
          "use_criteria": {
            "choose_target_using_algorithm": "choose_first_with_matching_criteria",
            "conditions": [
              {
                "operator": "eqi",
                "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                "right_operand": "FortiGate_API"
              }
            ]
          }
        }
      }
    },
    "object_type": "definition_workflow",
    "actions": [
      {
        "unique_name": "definition_activity_01SE0N18KSEPS6pqP8aWNNj4jubz9h3jVZm",
        "name": "Replace String",
        "title": "Defang observable",
        "type": "core.replacestring",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Defang observable",
          "input_string": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWWV8OOA64LdyclajeziyBPSXN0JFIC$",
          "replace_list": [
            {
              "replaced_string": ".",
              "replacement_string": "[.]"
            },
            {
              "replaced_string": ":",
              "replacement_string": "[:]"
            },
            {
              "replaced_string": "http",
              "replacement_string": "hxxp"
            }
          ],
          "skip_execution": false
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_01QXHJIZ26FHZ423VHybsJPWguBGG9M7qlA",
        "name": "Condition Block",
        "title": "Policy Name Provided?",
        "type": "logic.if_else",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": true,
          "display_name": "Policy Name Provided?",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "blocks": [
          {
            "unique_name": "definition_activity_01SDARO8BEMGM6LjRedAHGSUpIpwe5PFZb6",
            "name": "Condition Branch",
            "title": "No",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QXHR8UGUKKV3PzLWDz5cd9wfGxZ0M0WBc$",
                "operator": "eq",
                "right_operand": ""
              },
              "continue_on_failure": false,
              "display_name": "No",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01SDZRY2Y8R5A1OLwZsxcXheWO1syizUJW6",
                "name": "Microsoft Teams - Post Message via Webhook",
                "title": "Microsoft Teams - Post Message via Webhook",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Microsoft Teams - Post Message via Webhook",
                  "input": {
                    "variable_workflow_01MRIK9PFIH9457K2ZY1x7rEJvOPzYOE6eO": "MESSAGE FROM Fortinet - FortiGate - Block URL, IP or Domain",
                    "variable_workflow_01MRIKICJKVS16L5nynmibtyxbFIqwxBhOV": "**\"$activity.definition_activity_01SE0N18KSEPS6pqP8aWNNj4jubz9h3jVZm.output.result_string$\" observable handling failed.**\n\u003cbr/\u003e\nA policy name to be updated was not provided. You must configure the workflow with the name of a policy.",
                    "variable_workflow_01MRIL2TKZ8FM1EvIZeO4VFV9ITFhG3vSlI": ""
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "override_workflow_target_group_criteria": true,
                    "target_group": {
                      "run_on_all_targets": false,
                      "use_criteria": {
                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                        "conditions": [
                          {
                            "left_operand": "$targetgroup.target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH.common.display_name$",
                            "operator": "eqi",
                            "right_operand": "Microsoft Teams Webhook"
                          }
                        ]
                      }
                    }
                  },
                  "workflow_id": "definition_workflow_01MRIE3B3DNNQ3cdFSoyGkg1RnVsYA9VdZr"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01SDZS42I4DQ25ud6SXIvyA13isETPCp03s",
                "name": "Completed",
                "title": "Failed",
                "type": "logic.completed",
                "base_type": "activity",
                "properties": {
                  "completion_type": "failed-completed",
                  "continue_on_failure": false,
                  "display_name": "Failed",
                  "result_message": "\"$activity.definition_activity_01SE0N18KSEPS6pqP8aWNNj4jubz9h3jVZm.output.result_string$\" observable handling failed.\n \nA policy name to be updated was not provided. You must configure the workflow with the name of a policy.",
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_01QXI1GGQNAGM5d6nsdblV5UELRhItEnps4",
        "name": "Execute Python Script",
        "title": "Generate timestamps to create unique names",
        "type": "python3.script",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "continue_on_failure": false,
          "display_name": "Generate timestamps to create unique names",
          "script": "import time\nfrom sys import argv\n\nprefix = argv[1]\n\naddress_name = f\"{prefix}-Address-{int(time.time())}\"\nurl_filter_name = f\"{prefix}-URLFilter-{int(time.time())}\"",
          "script_arguments": [
            "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QXI76U3FI367PUsYmsAFxcPCIQeY3UVws$"
          ],
          "script_queries": [
            {
              "script_query": "address_name",
              "script_query_name": "Address Name",
              "script_query_type": "string"
            },
            {
              "script_query": "url_filter_name",
              "script_query_name": "URL Filter Name",
              "script_query_type": "string"
            }
          ],
          "skip_execution": false
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_01QVND6FHZRGU6n8dHiDchlc7ZTfsYGLyqn",
        "name": "Condition Block",
        "title": "Which observable type provided?",
        "type": "logic.if_else",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Which observable type provided?",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "blocks": [
          {
            "unique_name": "definition_activity_01QVND6JB8RMQ12hwBW8jieIaneO0tmO3OA",
            "name": "Condition Branch",
            "title": "IP/Domain",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": {
                  "left_operand": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWPO1WE3738QmwiLwBJbXce3agNJ7Kk$",
                  "operator": "eq",
                  "right_operand": "ip"
                },
                "operator": "or",
                "right_operand": {
                  "left_operand": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWPO1WE3738QmwiLwBJbXce3agNJ7Kk$",
                  "operator": "eq",
                  "right_operand": "domain"
                }
              },
              "continue_on_failure": false,
              "display_name": "IP/Domain",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01QXESWS5MMM34TLZgndSuAWl7JX9q2ZOC8",
                "name": "Condition Block",
                "title": "Address Group Name provided?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Address Group Name provided?",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01QXESWW1NC9L4wwIjB6YF7n6aFq4w1VHeS",
                    "name": "Condition Branch",
                    "title": "Yes",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QENMB1Z1RQH358zoMEikzjGBvYRvrdvlA$",
                        "operator": "ne",
                        "right_operand": ""
                      },
                      "continue_on_failure": false,
                      "display_name": "Yes",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01QWIFJR9H1MD7kO2icg1PakEesM1SbQCM7",
                        "name": "Fortinet - FortiGate - Search for Address by Value",
                        "title": "Fortinet - FortiGate - Search for Address by Value",
                        "type": "workflow.atomic_workflow",
                        "base_type": "subworkflow",
                        "properties": {
                          "continue_on_failure": true,
                          "display_name": "Fortinet - FortiGate - Search for Address by Value",
                          "input": {
                            "variable_workflow_01QJMY7E7Z0IB2Ed7caVA90mExOvR277l2a": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWWV8OOA64LdyclajeziyBPSXN0JFIC$",
                            "variable_workflow_01QJMY7E7Z34Y31xJWhl8psuGJq9nSwAGQA": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QVNBNH9JTYK3NfHWwhAzXMl4rzC8QLGvm$",
                            "variable_workflow_01QJNP94KKPAD0OwFo8IB6b8carKE0VVqpl": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWPO1WE3738QmwiLwBJbXce3agNJ7Kk$",
                            "variable_workflow_01QJQEPSZM3BE1GcmTTNciS5QqSczLq11G7": "root"
                          },
                          "runtime_user": {
                            "target_default": true
                          },
                          "skip_execution": false,
                          "target": {
                            "use_workflow_target_group": true
                          },
                          "workflow_id": "definition_workflow_01QJMY7EFE9EB0dUuvozT00neDnloTNQN05"
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01QXEL2V5S0J54LwkxxJZhMznMjL8qMr98L",
                        "name": "Condition Block",
                        "title": "Address Found?",
                        "type": "logic.if_else",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Address Found?",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "blocks": [
                          {
                            "unique_name": "definition_activity_01QXEL30NNUL434Tma8iM7ebL42W0ytKMsL",
                            "name": "Condition Branch",
                            "title": "Yes",
                            "type": "logic.condition_block",
                            "base_type": "activity",
                            "properties": {
                              "condition": {
                                "left_operand": "$activity.definition_activity_01QWIFJR9H1MD7kO2icg1PakEesM1SbQCM7.output.succeeded$",
                                "operator": "eq",
                                "right_operand": true
                              },
                              "continue_on_failure": false,
                              "display_name": "Yes",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01QXEX9MZ18DV0TovkJV6wIHoBtmhoOI4EI",
                                "name": "Set Variables",
                                "title": "Set Variable Address Name",
                                "type": "core.set_multiple_variables",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Set Variable Address Name",
                                  "skip_execution": false,
                                  "variables_to_update": [
                                    {
                                      "variable_to_update": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QXEW7YBXKOA67nOxzUyeafXXO7sWUTTyr$",
                                      "variable_value_new": "$activity.definition_activity_01QWIFJR9H1MD7kO2icg1PakEesM1SbQCM7.output.variable_workflow_01QJMY7E7YVSH6zkv5YqG2E3Dy29Ng7fQJP$"
                                    }
                                  ]
                                },
                                "object_type": "definition_activity"
                              }
                            ]
                          },
                          {
                            "unique_name": "definition_activity_01QXEWVOTIA3V4j1xAh7og3kFTXjhadYteM",
                            "name": "Condition Branch",
                            "title": "No",
                            "type": "logic.condition_block",
                            "base_type": "activity",
                            "properties": {
                              "condition": {
                                "left_operand": "$activity.definition_activity_01QWIFJR9H1MD7kO2icg1PakEesM1SbQCM7.output.succeeded$",
                                "operator": "eq",
                                "right_operand": false
                              },
                              "continue_on_failure": false,
                              "display_name": "No",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01RHZQGMW7KDV3S5DnUarzwth9eF5uWDsXY",
                                "name": "Condition Block",
                                "title": "Critical Error Occurred?",
                                "type": "logic.if_else",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Critical Error Occurred?",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "blocks": [
                                  {
                                    "unique_name": "definition_activity_01RHZQGU9VCPU7Xu0f9bnx0l3qQCy4xLFVp",
                                    "name": "Condition Branch",
                                    "title": "Yes",
                                    "type": "logic.condition_block",
                                    "base_type": "activity",
                                    "properties": {
                                      "condition": {
                                        "left_operand": "$activity.definition_activity_01QWIFJR9H1MD7kO2icg1PakEesM1SbQCM7.output.error.message$",
                                        "operator": "mw",
                                        "right_operand": "Status code:"
                                      },
                                      "continue_on_failure": false,
                                      "display_name": "Yes",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "actions": [
                                      {
                                        "unique_name": "definition_activity_01RHZQGV5J7I25K3DwuwIRa4WuPYPRpkzJo",
                                        "name": "Microsoft Teams - Post Message via Webhook",
                                        "title": "Microsoft Teams - Post Message via Webhook",
                                        "type": "workflow.atomic_workflow",
                                        "base_type": "subworkflow",
                                        "properties": {
                                          "continue_on_failure": false,
                                          "display_name": "Microsoft Teams - Post Message via Webhook",
                                          "input": {
                                            "variable_workflow_01MRIK9PFIH9457K2ZY1x7rEJvOPzYOE6eO": "MESSAGE FROM Fortinet - FortiGate - Block URL, IP or Domain",
                                            "variable_workflow_01MRIKICJKVS16L5nynmibtyxbFIqwxBhOV": "**\"$activity.definition_activity_01SE0N18KSEPS6pqP8aWNNj4jubz9h3jVZm.output.result_string$\" observable handling failed.**\n\u003cbr/\u003e\n$activity.definition_activity_01QWIFJR9H1MD7kO2icg1PakEesM1SbQCM7.output.error.message$",
                                            "variable_workflow_01MRIL2TKZ8FM1EvIZeO4VFV9ITFhG3vSlI": ""
                                          },
                                          "runtime_user": {
                                            "target_default": true
                                          },
                                          "skip_execution": false,
                                          "target": {
                                            "override_workflow_target_group_criteria": true,
                                            "target_group": {
                                              "run_on_all_targets": false,
                                              "use_criteria": {
                                                "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                                "conditions": [
                                                  {
                                                    "left_operand": "$targetgroup.target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH.common.display_name$",
                                                    "operator": "eqi",
                                                    "right_operand": "Microsoft Teams Webhook"
                                                  }
                                                ]
                                              }
                                            }
                                          },
                                          "workflow_id": "definition_workflow_01MRIE3B3DNNQ3cdFSoyGkg1RnVsYA9VdZr"
                                        },
                                        "object_type": "definition_activity"
                                      },
                                      {
                                        "unique_name": "definition_activity_01RHZQH429Y3U4ov1TR3kLHXipBFCqxNSYr",
                                        "name": "Completed",
                                        "title": "Failed",
                                        "type": "logic.completed",
                                        "base_type": "activity",
                                        "properties": {
                                          "completion_type": "failed-completed",
                                          "continue_on_failure": false,
                                          "display_name": "Failed",
                                          "result_message": "\"$activity.definition_activity_01SE0N18KSEPS6pqP8aWNNj4jubz9h3jVZm.output.result_string$\" observable handling failed.\n\n$activity.definition_activity_01QWIFJR9H1MD7kO2icg1PakEesM1SbQCM7.output.error.message$",
                                          "skip_execution": false
                                        },
                                        "object_type": "definition_activity"
                                      }
                                    ]
                                  }
                                ]
                              },
                              {
                                "unique_name": "definition_activity_01QXEWVPSZFV76Fis7RxBKD2jtRhqhyYpic",
                                "name": "Fortinet - FortiGate - Create Address",
                                "title": "Fortinet - FortiGate - Create Address",
                                "type": "workflow.atomic_workflow",
                                "base_type": "subworkflow",
                                "properties": {
                                  "continue_on_failure": true,
                                  "display_name": "Fortinet - FortiGate - Create Address",
                                  "input": {
                                    "variable_workflow_01Q8Q3G8HFBBV4bCgPNxr8tNZAdaRIhTchP": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWPO1WE3738QmwiLwBJbXce3agNJ7Kk$",
                                    "variable_workflow_01Q8QAOJCFJFX2aDEaoWMl8JIaBJeUoywL6": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWWV8OOA64LdyclajeziyBPSXN0JFIC$",
                                    "variable_workflow_01QCRJI0NZEMB0Pm8zeCVQJSI6QGrjOyakn": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QVNBNH9JTYK3NfHWwhAzXMl4rzC8QLGvm$",
                                    "variable_workflow_01QYDQME2SLKW7lJPgDsK0aMFMMODvnejqs": "$activity.definition_activity_01QXI1GGQNAGM5d6nsdblV5UELRhItEnps4.output.script_queries.Address Name$",
                                    "variable_workflow_01QYE15IBF6Q74dRiYe9StNFoRQ1cIEul1M": "root"
                                  },
                                  "runtime_user": {
                                    "target_default": true
                                  },
                                  "skip_execution": false,
                                  "target": {
                                    "use_workflow_target_group": true
                                  },
                                  "workflow_id": "definition_workflow_01Q2H2423CNMQ55zxmxIlndVdm1FyYI9WvB"
                                },
                                "object_type": "definition_activity"
                              },
                              {
                                "unique_name": "definition_activity_01RHYPCG7PY3J2otR1hFvT63KliXca2sSof",
                                "name": "Condition Block",
                                "title": "Critical Error Occurred?",
                                "type": "logic.if_else",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Critical Error Occurred?",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "blocks": [
                                  {
                                    "unique_name": "definition_activity_01RHYPCMVF7EF5aKOOWYGwPjMWp5TsMD9EV",
                                    "name": "Condition Branch",
                                    "title": "Yes",
                                    "type": "logic.condition_block",
                                    "base_type": "activity",
                                    "properties": {
                                      "condition": {
                                        "left_operand": "$activity.definition_activity_01QXEWVPSZFV76Fis7RxBKD2jtRhqhyYpic.output.succeeded$",
                                        "operator": "eq",
                                        "right_operand": false
                                      },
                                      "continue_on_failure": false,
                                      "display_name": "Yes",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "actions": [
                                      {
                                        "unique_name": "definition_activity_01RHYPCNN9AYS1bR9LWGUB3vN5rrcnLJQCO",
                                        "name": "Microsoft Teams - Post Message via Webhook",
                                        "title": "Microsoft Teams - Post Message via Webhook",
                                        "type": "workflow.atomic_workflow",
                                        "base_type": "subworkflow",
                                        "properties": {
                                          "continue_on_failure": false,
                                          "display_name": "Microsoft Teams - Post Message via Webhook",
                                          "input": {
                                            "variable_workflow_01MRIK9PFIH9457K2ZY1x7rEJvOPzYOE6eO": "MESSAGE FROM Fortinet - FortiGate - Block URL, IP or Domain",
                                            "variable_workflow_01MRIKICJKVS16L5nynmibtyxbFIqwxBhOV": "**\"$activity.definition_activity_01SE0N18KSEPS6pqP8aWNNj4jubz9h3jVZm.output.result_string$\" observable handling failed.**\n\u003cbr/\u003e\n$activity.definition_activity_01QXEWVPSZFV76Fis7RxBKD2jtRhqhyYpic.output.error.message$",
                                            "variable_workflow_01MRIL2TKZ8FM1EvIZeO4VFV9ITFhG3vSlI": ""
                                          },
                                          "runtime_user": {
                                            "target_default": true
                                          },
                                          "skip_execution": false,
                                          "target": {
                                            "override_workflow_target_group_criteria": true,
                                            "target_group": {
                                              "run_on_all_targets": false,
                                              "use_criteria": {
                                                "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                                "conditions": [
                                                  {
                                                    "left_operand": "$targetgroup.target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH.common.display_name$",
                                                    "operator": "eqi",
                                                    "right_operand": "Microsoft Teams Webhook"
                                                  }
                                                ]
                                              }
                                            }
                                          },
                                          "workflow_id": "definition_workflow_01MRIE3B3DNNQ3cdFSoyGkg1RnVsYA9VdZr"
                                        },
                                        "object_type": "definition_activity"
                                      },
                                      {
                                        "unique_name": "definition_activity_01RHYPCTWVDZ46WzMBkFUILDmTCoNAFMplU",
                                        "name": "Completed",
                                        "title": "Failed",
                                        "type": "logic.completed",
                                        "base_type": "activity",
                                        "properties": {
                                          "completion_type": "failed-completed",
                                          "continue_on_failure": false,
                                          "display_name": "Failed",
                                          "result_message": "\"$activity.definition_activity_01SE0N18KSEPS6pqP8aWNNj4jubz9h3jVZm.output.result_string$\" observable handling failed.\n$activity.definition_activity_01QXEWVPSZFV76Fis7RxBKD2jtRhqhyYpic.output.error.message$",
                                          "skip_execution": false
                                        },
                                        "object_type": "definition_activity"
                                      }
                                    ]
                                  }
                                ]
                              },
                              {
                                "unique_name": "definition_activity_01RHOTSDSCNLE5JTIVnMUgktNV95FBfModC",
                                "name": "Set Variables",
                                "title": "Set Variable Address Name",
                                "type": "core.set_multiple_variables",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Set Variable Address Name",
                                  "skip_execution": false,
                                  "variables_to_update": [
                                    {
                                      "variable_to_update": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QXEW7YBXKOA67nOxzUyeafXXO7sWUTTyr$",
                                      "variable_value_new": "$activity.definition_activity_01QXEWVPSZFV76Fis7RxBKD2jtRhqhyYpic.output.variable_workflow_01QC9LIOV6YU17SrgFzUqifOESxFzg5ss7d$"
                                    }
                                  ]
                                },
                                "object_type": "definition_activity"
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "unique_name": "definition_activity_01QXEVAP1OYCX7SC8Rf3fXt0JpGTT0PVNl0",
                        "name": "Fortinet - FortiGate - Add Address to Group",
                        "title": "Fortinet - FortiGate - Add Address to Group",
                        "type": "workflow.atomic_workflow",
                        "base_type": "subworkflow",
                        "properties": {
                          "continue_on_failure": true,
                          "display_name": "Fortinet - FortiGate - Add Address to Group",
                          "input": {
                            "variable_workflow_01QKJSE0EFJ2W31BeDVMJrs1CFizp43DKQr": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QVNBNH9JTYK3NfHWwhAzXMl4rzC8QLGvm$",
                            "variable_workflow_01QKJSE0EFMPQ4ZousJqguiEM0z7cVkN0z4": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QXEW7YBXKOA67nOxzUyeafXXO7sWUTTyr$",
                            "variable_workflow_01QKJSE0EFQL61FRB1WLGyXTIRetH2ohsE4": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QENMB1Z1RQH358zoMEikzjGBvYRvrdvlA$",
                            "variable_workflow_01QKM1ZUG7X301PG75jm0VEKR1SrG6holTq": "root"
                          },
                          "runtime_user": {
                            "target_default": true
                          },
                          "skip_execution": false,
                          "target": {
                            "use_workflow_target_group": true
                          },
                          "workflow_id": "definition_workflow_01QKJSE0LURMP1XIO79isiyUAXKTDDZeCGV"
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01RHPVTIZADMW2fDt3QN3tT6TPh9bDHNIg9",
                        "name": "Condition Block",
                        "title": "Address group update successful?",
                        "type": "logic.if_else",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Address group update successful?",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "blocks": [
                          {
                            "unique_name": "definition_activity_01RHPVTMOKDM61T9L6CTYiPZEkh0tSAI2QO",
                            "name": "Condition Branch",
                            "title": "No",
                            "type": "logic.condition_block",
                            "base_type": "activity",
                            "properties": {
                              "condition": {
                                "left_operand": "$activity.definition_activity_01QXEVAP1OYCX7SC8Rf3fXt0JpGTT0PVNl0.output.succeeded$",
                                "operator": "eq",
                                "right_operand": false
                              },
                              "continue_on_failure": false,
                              "display_name": "No",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01RHYQZ1QJAZH03pAEuAF0uKtUFpJfPffwJ",
                                "name": "Microsoft Teams - Post Message via Webhook",
                                "title": "Microsoft Teams - Post Message via Webhook",
                                "type": "workflow.atomic_workflow",
                                "base_type": "subworkflow",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Microsoft Teams - Post Message via Webhook",
                                  "input": {
                                    "variable_workflow_01MRIK9PFIH9457K2ZY1x7rEJvOPzYOE6eO": "MESSAGE FROM Fortinet - FortiGate - Block URL, IP or Domain",
                                    "variable_workflow_01MRIKICJKVS16L5nynmibtyxbFIqwxBhOV": "**\"$activity.definition_activity_01SE0N18KSEPS6pqP8aWNNj4jubz9h3jVZm.output.result_string$\" observable handling failed.**\n\u003cbr/\u003e\n$activity.definition_activity_01QXEVAP1OYCX7SC8Rf3fXt0JpGTT0PVNl0.output.error.message$",
                                    "variable_workflow_01MRIL2TKZ8FM1EvIZeO4VFV9ITFhG3vSlI": ""
                                  },
                                  "runtime_user": {
                                    "target_default": true
                                  },
                                  "skip_execution": false,
                                  "target": {
                                    "override_workflow_target_group_criteria": true,
                                    "target_group": {
                                      "run_on_all_targets": false,
                                      "use_criteria": {
                                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                        "conditions": [
                                          {
                                            "left_operand": "$targetgroup.target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH.common.display_name$",
                                            "operator": "eqi",
                                            "right_operand": "Microsoft Teams Webhook"
                                          }
                                        ]
                                      }
                                    }
                                  },
                                  "workflow_id": "definition_workflow_01MRIE3B3DNNQ3cdFSoyGkg1RnVsYA9VdZr"
                                },
                                "object_type": "definition_activity"
                              },
                              {
                                "unique_name": "definition_activity_01RHYQZ7XTSOY54KheGyzWuXDI64d7L5emq",
                                "name": "Completed",
                                "title": "Failed",
                                "type": "logic.completed",
                                "base_type": "activity",
                                "properties": {
                                  "completion_type": "failed-completed",
                                  "continue_on_failure": false,
                                  "display_name": "Failed",
                                  "result_message": "\"$activity.definition_activity_01SE0N18KSEPS6pqP8aWNNj4jubz9h3jVZm.output.result_string$\" observable handling failed.\n$activity.definition_activity_01QWIFJR9H1MD7kO2icg1PakEesM1SbQCM7.output.error.message$",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity"
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "unique_name": "definition_activity_01SDZ7ID8R2OZ6B56AMxLwUwHFARq8GN78W",
                    "name": "Condition Branch",
                    "title": "No",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QENMB1Z1RQH358zoMEikzjGBvYRvrdvlA$",
                        "operator": "eq",
                        "right_operand": ""
                      },
                      "continue_on_failure": false,
                      "display_name": "No",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01SDZME11WI1G6ugO0bKdydq5emUDmW3XLz",
                        "name": "Microsoft Teams - Post Message via Webhook",
                        "title": "Microsoft Teams - Post Message via Webhook",
                        "type": "workflow.atomic_workflow",
                        "base_type": "subworkflow",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Microsoft Teams - Post Message via Webhook",
                          "input": {
                            "variable_workflow_01MRIK9PFIH9457K2ZY1x7rEJvOPzYOE6eO": "MESSAGE FROM Fortinet - FortiGate - Block URL, IP or Domain",
                            "variable_workflow_01MRIKICJKVS16L5nynmibtyxbFIqwxBhOV": "**\"$activity.definition_activity_01SE0N18KSEPS6pqP8aWNNj4jubz9h3jVZm.output.result_string$\" observable handling failed.**\n\u003cbr/\u003e\nAn address group to add addresses to was not provided. You must configure the workflow with the name of an address group.",
                            "variable_workflow_01MRIL2TKZ8FM1EvIZeO4VFV9ITFhG3vSlI": ""
                          },
                          "runtime_user": {
                            "target_default": true
                          },
                          "skip_execution": false,
                          "target": {
                            "override_workflow_target_group_criteria": true,
                            "target_group": {
                              "run_on_all_targets": false,
                              "use_criteria": {
                                "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                "conditions": [
                                  {
                                    "left_operand": "$targetgroup.target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH.common.display_name$",
                                    "operator": "eqi",
                                    "right_operand": "Microsoft Teams Webhook"
                                  }
                                ]
                              }
                            }
                          },
                          "workflow_id": "definition_workflow_01MRIE3B3DNNQ3cdFSoyGkg1RnVsYA9VdZr"
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01SDZHB26SS626RhwmzZaFA4EF84ubOf8VA",
                        "name": "Completed",
                        "title": "Failed",
                        "type": "logic.completed",
                        "base_type": "activity",
                        "properties": {
                          "completion_type": "failed-completed",
                          "continue_on_failure": false,
                          "display_name": "Failed",
                          "result_message": "\"$activity.definition_activity_01SE0N18KSEPS6pqP8aWNNj4jubz9h3jVZm.output.result_string$\" observable handling failed.\n\nAn address group to add addresses to was not provided. You must configure the workflow with the name of an address group.",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01QYE5WFSJBFT3hcwqqCKWmVU78Xlx38dIu",
                "name": "Set Variables",
                "title": "Clear extra inputs if present",
                "type": "core.set_multiple_variables",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Clear extra inputs if present",
                  "skip_execution": false,
                  "variables_to_update": [
                    {
                      "variable_to_update": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QENLZHPIVVI28kd2INwi2zuZncQeryxQr$",
                      "variable_value_new": ""
                    }
                  ]
                },
                "object_type": "definition_activity"
              }
            ]
          },
          {
            "unique_name": "definition_activity_01QVND6K0W0L66rdhyShNZEZPLZiJ1GB3vl",
            "name": "Condition Branch",
            "title": "URL",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWPO1WE3738QmwiLwBJbXce3agNJ7Kk$",
                "operator": "eq",
                "right_operand": "url"
              },
              "continue_on_failure": false,
              "display_name": "URL",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01QWIGB3XB54H5w0BTeaSAyUxRFbhI8DbGY",
                "name": "Condition Block",
                "title": "Web Filter Name Provided?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Web Filter Name Provided?",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01QWIGB8M10EQ6zDFI3u3V3UYEwDjCRy9Qc",
                    "name": "Condition Branch",
                    "title": "Yes",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QENLZHPIVVI28kd2INwi2zuZncQeryxQr$",
                        "operator": "ne",
                        "right_operand": ""
                      },
                      "continue_on_failure": false,
                      "display_name": "Yes",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01QWIR9KUPHWJ0ZeoGn1hYeCJM8evhCOPLK",
                        "name": "Fortinet - FortiGate - Search for Web Filter by Name",
                        "title": "Fortinet - FortiGate - Search for Web Filter by Name",
                        "type": "workflow.atomic_workflow",
                        "base_type": "subworkflow",
                        "properties": {
                          "continue_on_failure": true,
                          "display_name": "Fortinet - FortiGate - Search for Web Filter by Name",
                          "input": {
                            "variable_workflow_01QTSQI5AOIDP1UVa3tdeyCoxgF8uWnJoc4": "root",
                            "variable_workflow_01QTSQI5AOJY03c8ShvFxa6WGyMzlo9AxMo": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QENLZHPIVVI28kd2INwi2zuZncQeryxQr$",
                            "variable_workflow_01QTSQI5AOMZU4SbT4ozhFODZqKw3438YcU": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QVNBNH9JTYK3NfHWwhAzXMl4rzC8QLGvm$"
                          },
                          "runtime_user": {
                            "target_default": true
                          },
                          "skip_execution": false,
                          "target": {
                            "use_workflow_target_group": true
                          },
                          "workflow_id": "definition_workflow_01QTSQI5IY61E0eT05l4mbwyexR2rwtaSYl"
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01QWIZ6AGSDJP5f3BJAiaoLl9GgGjOIgBNQ",
                        "name": "Condition Block",
                        "title": "Web Filter Name found?",
                        "type": "logic.if_else",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Web Filter Name found?",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "blocks": [
                          {
                            "unique_name": "definition_activity_01QWIZ6EU4ZAW1XStWv7z7mPlMrOUn4ihdn",
                            "name": "Condition Branch",
                            "title": "Yes",
                            "type": "logic.condition_block",
                            "base_type": "activity",
                            "properties": {
                              "condition": {
                                "left_operand": "$activity.definition_activity_01QWIR9KUPHWJ0ZeoGn1hYeCJM8evhCOPLK.output.succeeded$",
                                "operator": "eq",
                                "right_operand": true
                              },
                              "continue_on_failure": false,
                              "display_name": "Yes",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01QWJ0PK7DA774YRtVZvBQ2nLrU9x721YTw",
                                "name": "JSONPath Query",
                                "title": "Extract  URL Filter MKey",
                                "type": "corejava.jsonpathquery",
                                "base_type": "activity",
                                "properties": {
                                  "action_timeout": 180,
                                  "continue_on_failure": true,
                                  "display_name": "Extract  URL Filter MKey",
                                  "input_json": "$activity.definition_activity_01QWIR9KUPHWJ0ZeoGn1hYeCJM8evhCOPLK.output.variable_workflow_01QTSQI5AOLGJ1ICiAZAvpDArlZk6MCG80B$",
                                  "jsonpath_queries": [
                                    {
                                      "jsonpath_query": ".web.urlfilter-table",
                                      "jsonpath_query_name": "URL Filter Table",
                                      "jsonpath_query_type": "string"
                                    }
                                  ],
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity"
                              },
                              {
                                "unique_name": "definition_activity_01QWJ2R4KUIKK1QVe1gdkN3Rau2Gw1jWgsv",
                                "name": "Condition Block",
                                "title": "Extraction sucessfull?",
                                "type": "logic.if_else",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Extraction sucessfull?",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "blocks": [
                                  {
                                    "unique_name": "definition_activity_01QWJ2R87BJEY4inzT6bv9EtJfZZSNwtzTk",
                                    "name": "Condition Branch",
                                    "title": "Yes",
                                    "type": "logic.condition_block",
                                    "base_type": "activity",
                                    "properties": {
                                      "condition": {
                                        "left_operand": {
                                          "left_operand": "$activity.definition_activity_01QWJ0PK7DA774YRtVZvBQ2nLrU9x721YTw.output.succeeded$",
                                          "operator": "eq",
                                          "right_operand": true
                                        },
                                        "operator": "and",
                                        "right_operand": {
                                          "left_operand": "$activity.definition_activity_01QWJ0PK7DA774YRtVZvBQ2nLrU9x721YTw.output.jsonpath_queries.URL Filter Table$",
                                          "operator": "ne",
                                          "right_operand": "0"
                                        }
                                      },
                                      "continue_on_failure": false,
                                      "display_name": "Yes",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "actions": [
                                      {
                                        "unique_name": "definition_activity_01QWJ3W5RLZ172bZzm6fnu5RtMfpU2Zk5rI",
                                        "name": "Fortinet - FortiGate - Add URL to URL Filter",
                                        "title": "Fortinet - FortiGate - Add URL to URL Filter",
                                        "type": "workflow.atomic_workflow",
                                        "base_type": "subworkflow",
                                        "properties": {
                                          "continue_on_failure": true,
                                          "display_name": "Fortinet - FortiGate - Add URL to URL Filter",
                                          "input": {
                                            "variable_workflow_01QTTUMDLM9KF4wEdIf0sL0kYyyPYNhFQI4": "$activity.definition_activity_01QWJ0PK7DA774YRtVZvBQ2nLrU9x721YTw.output.jsonpath_queries.URL Filter Table$",
                                            "variable_workflow_01QTTUMDLMGGS3YaRczu3vU0AVXA5kBFeQq": "root",
                                            "variable_workflow_01QTTUMDLMHVN0vYPl8F6KsDolGDcG4OWKI": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWWV8OOA64LdyclajeziyBPSXN0JFIC$",
                                            "variable_workflow_01QTTUMDLMJ2N4TMVxTti3VMk7rCcjjWHnc": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QVNBNH9JTYK3NfHWwhAzXMl4rzC8QLGvm$"
                                          },
                                          "runtime_user": {
                                            "target_default": true
                                          },
                                          "skip_execution": false,
                                          "target": {
                                            "use_workflow_target_group": true
                                          },
                                          "workflow_id": "definition_workflow_01QTTUMDSUU0L6hykgyzvov9DIbC8YZyISv"
                                        },
                                        "object_type": "definition_activity"
                                      },
                                      {
                                        "unique_name": "definition_activity_01RHZ9DRL7H6C78qFHTpVFSAFlbma77sIO2",
                                        "name": "Condition Block",
                                        "title": "Critical Error Occurred?",
                                        "type": "logic.if_else",
                                        "base_type": "activity",
                                        "properties": {
                                          "continue_on_failure": false,
                                          "display_name": "Critical Error Occurred?",
                                          "skip_execution": false
                                        },
                                        "object_type": "definition_activity",
                                        "blocks": [
                                          {
                                            "unique_name": "definition_activity_01RHZ9DXXH97N4tfQhpCZ8qnIhXSukVqbxT",
                                            "name": "Condition Branch",
                                            "title": "Yes",
                                            "type": "logic.condition_block",
                                            "base_type": "activity",
                                            "properties": {
                                              "condition": {
                                                "left_operand": "$activity.definition_activity_01QWJ3W5RLZ172bZzm6fnu5RtMfpU2Zk5rI.output.succeeded$",
                                                "operator": "eq",
                                                "right_operand": false
                                              },
                                              "continue_on_failure": false,
                                              "display_name": "Yes",
                                              "skip_execution": false
                                            },
                                            "object_type": "definition_activity",
                                            "actions": [
                                              {
                                                "unique_name": "definition_activity_01RHZ9DYNCQJQ4mXwdLzs6DRQb9qMfcsNhw",
                                                "name": "Microsoft Teams - Post Message via Webhook",
                                                "title": "Microsoft Teams - Post Message via Webhook",
                                                "type": "workflow.atomic_workflow",
                                                "base_type": "subworkflow",
                                                "properties": {
                                                  "continue_on_failure": false,
                                                  "display_name": "Microsoft Teams - Post Message via Webhook",
                                                  "input": {
                                                    "variable_workflow_01MRIK9PFIH9457K2ZY1x7rEJvOPzYOE6eO": "MESSAGE FROM Fortinet - FortiGate - Block URL, IP or Domain",
                                                    "variable_workflow_01MRIKICJKVS16L5nynmibtyxbFIqwxBhOV": "**\"$activity.definition_activity_01SE0N18KSEPS6pqP8aWNNj4jubz9h3jVZm.output.result_string$\" observable handling failed.**\n\u003cbr/\u003e\n$activity.definition_activity_01QWJ3W5RLZ172bZzm6fnu5RtMfpU2Zk5rI.output.error.message$",
                                                    "variable_workflow_01MRIL2TKZ8FM1EvIZeO4VFV9ITFhG3vSlI": ""
                                                  },
                                                  "runtime_user": {
                                                    "target_default": true
                                                  },
                                                  "skip_execution": false,
                                                  "target": {
                                                    "override_workflow_target_group_criteria": true,
                                                    "target_group": {
                                                      "run_on_all_targets": false,
                                                      "use_criteria": {
                                                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                                        "conditions": [
                                                          {
                                                            "left_operand": "$targetgroup.target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH.common.display_name$",
                                                            "operator": "eqi",
                                                            "right_operand": "Microsoft Teams Webhook"
                                                          }
                                                        ]
                                                      }
                                                    }
                                                  },
                                                  "workflow_id": "definition_workflow_01MRIE3B3DNNQ3cdFSoyGkg1RnVsYA9VdZr"
                                                },
                                                "object_type": "definition_activity"
                                              },
                                              {
                                                "unique_name": "definition_activity_01RHZ9E4S2GGM4n4PGCt3GPOlQqrCAqTBIs",
                                                "name": "Completed",
                                                "title": "Failed",
                                                "type": "logic.completed",
                                                "base_type": "activity",
                                                "properties": {
                                                  "completion_type": "failed-completed",
                                                  "continue_on_failure": false,
                                                  "display_name": "Failed",
                                                  "result_message": "\"$activity.definition_activity_01SE0N18KSEPS6pqP8aWNNj4jubz9h3jVZm.output.result_string$\" observable handling failed.\n \n$activity.definition_activity_01QWJ3W5RLZ172bZzm6fnu5RtMfpU2Zk5rI.output.error.message$",
                                                  "skip_execution": false
                                                },
                                                "object_type": "definition_activity"
                                              }
                                            ]
                                          }
                                        ]
                                      }
                                    ]
                                  },
                                  {
                                    "unique_name": "definition_activity_01QZM89Z2XBTK7bttaq590MQ6EbLhxFjDbT",
                                    "name": "Condition Branch",
                                    "title": "No",
                                    "type": "logic.condition_block",
                                    "base_type": "activity",
                                    "properties": {
                                      "condition": {
                                        "left_operand": {
                                          "left_operand": "$activity.definition_activity_01QWJ0PK7DA774YRtVZvBQ2nLrU9x721YTw.output.succeeded$",
                                          "operator": "eq",
                                          "right_operand": false
                                        },
                                        "operator": "or",
                                        "right_operand": {
                                          "left_operand": "$activity.definition_activity_01QWJ0PK7DA774YRtVZvBQ2nLrU9x721YTw.output.jsonpath_queries.URL Filter Table$",
                                          "operator": "eq",
                                          "right_operand": "0"
                                        }
                                      },
                                      "continue_on_failure": false,
                                      "display_name": "No",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "actions": [
                                      {
                                        "unique_name": "definition_activity_01QZM9AV6ZLA01eBcuPkP0dGeQLQqFOeafS",
                                        "name": "Fortinet - FortiGate - Create URL Filter",
                                        "title": "Fortinet - FortiGate - Create URL Filter",
                                        "type": "workflow.atomic_workflow",
                                        "base_type": "subworkflow",
                                        "properties": {
                                          "continue_on_failure": true,
                                          "display_name": "Fortinet - FortiGate - Create URL Filter",
                                          "input": {
                                            "variable_workflow_01QPJN9OQP82D67vM88JbpApXHH2HruIR44": "root",
                                            "variable_workflow_01QPJN9OQP9XZ7FTwvYnhHFIa5MA8hboqMm": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QVNBNH9JTYK3NfHWwhAzXMl4rzC8QLGvm$",
                                            "variable_workflow_01QPJN9OQPBZ41CQ3IjmqYxxy7u0ltmYktz": "$activity.definition_activity_01QXI1GGQNAGM5d6nsdblV5UELRhItEnps4.output.script_queries.URL Filter Name$",
                                            "variable_workflow_01QPKTY4TNQW91qT9tlWoF4rRvNteWdZJHD": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWWV8OOA64LdyclajeziyBPSXN0JFIC$"
                                          },
                                          "runtime_user": {
                                            "target_default": true
                                          },
                                          "skip_execution": false,
                                          "target": {
                                            "use_workflow_target_group": true
                                          },
                                          "workflow_id": "definition_workflow_01QPJN9P092ZK4B1nv7D0yaTHqYWenXdVIb"
                                        },
                                        "object_type": "definition_activity"
                                      },
                                      {
                                        "unique_name": "definition_activity_01RHZE20V3IVU1O5dwqr7hwjRDUpwId8jIt",
                                        "name": "Condition Block",
                                        "title": "Critical Error Occurred?",
                                        "type": "logic.if_else",
                                        "base_type": "activity",
                                        "properties": {
                                          "continue_on_failure": false,
                                          "display_name": "Critical Error Occurred?",
                                          "skip_execution": false
                                        },
                                        "object_type": "definition_activity",
                                        "blocks": [
                                          {
                                            "unique_name": "definition_activity_01RHZE24EO2FY2oHOl28QGFsOXgM0PXPKS0",
                                            "name": "Condition Branch",
                                            "title": "Yes",
                                            "type": "logic.condition_block",
                                            "base_type": "activity",
                                            "properties": {
                                              "condition": {
                                                "left_operand": "$activity.definition_activity_01QZM9AV6ZLA01eBcuPkP0dGeQLQqFOeafS.output.succeeded$",
                                                "operator": "eq",
                                                "right_operand": false
                                              },
                                              "continue_on_failure": false,
                                              "display_name": "Yes",
                                              "skip_execution": false
                                            },
                                            "object_type": "definition_activity",
                                            "actions": [
                                              {
                                                "unique_name": "definition_activity_01RHZE2553IFE5hMLuFsziMfum442U42L6b",
                                                "name": "Microsoft Teams - Post Message via Webhook",
                                                "title": "Microsoft Teams - Post Message via Webhook",
                                                "type": "workflow.atomic_workflow",
                                                "base_type": "subworkflow",
                                                "properties": {
                                                  "continue_on_failure": false,
                                                  "display_name": "Microsoft Teams - Post Message via Webhook",
                                                  "input": {
                                                    "variable_workflow_01MRIK9PFIH9457K2ZY1x7rEJvOPzYOE6eO": "MESSAGE FROM Fortinet - FortiGate - Block URL, IP or Domain",
                                                    "variable_workflow_01MRIKICJKVS16L5nynmibtyxbFIqwxBhOV": "**\"$activity.definition_activity_01SE0N18KSEPS6pqP8aWNNj4jubz9h3jVZm.output.result_string$\" observable handling failed.**\n\u003cbr/\u003e\n$activity.definition_activity_01QZM9AV6ZLA01eBcuPkP0dGeQLQqFOeafS.output.error.message$\n",
                                                    "variable_workflow_01MRIL2TKZ8FM1EvIZeO4VFV9ITFhG3vSlI": ""
                                                  },
                                                  "runtime_user": {
                                                    "target_default": true
                                                  },
                                                  "skip_execution": false,
                                                  "target": {
                                                    "override_workflow_target_group_criteria": true,
                                                    "target_group": {
                                                      "run_on_all_targets": false,
                                                      "use_criteria": {
                                                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                                        "conditions": [
                                                          {
                                                            "left_operand": "$targetgroup.target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH.common.display_name$",
                                                            "operator": "eqi",
                                                            "right_operand": "Microsoft Teams Webhook"
                                                          }
                                                        ]
                                                      }
                                                    }
                                                  },
                                                  "workflow_id": "definition_workflow_01MRIE3B3DNNQ3cdFSoyGkg1RnVsYA9VdZr"
                                                },
                                                "object_type": "definition_activity"
                                              },
                                              {
                                                "unique_name": "definition_activity_01RHZE2BGAWX36PQhC3mwEr0LNKe8H6bn3k",
                                                "name": "Completed",
                                                "title": "Failed",
                                                "type": "logic.completed",
                                                "base_type": "activity",
                                                "properties": {
                                                  "completion_type": "failed-completed",
                                                  "continue_on_failure": false,
                                                  "display_name": "Failed",
                                                  "result_message": "\"$activity.01SDAA1AR7FKH6hyNdmjKPHWsCJFT1hozLz.output.script_queries.observable_value$\" observable handling failed.\n \n$activity.definition_activity_01QZM9AV6ZLA01eBcuPkP0dGeQLQqFOeafS.output.error.message$",
                                                  "skip_execution": false
                                                },
                                                "object_type": "definition_activity"
                                              }
                                            ]
                                          }
                                        ]
                                      },
                                      {
                                        "unique_name": "definition_activity_01QXHGUDKGHUO1qYFB6ijbv97rqNEqV71FL",
                                        "name": "Fortinet - FortiGate - Add Entry to Web Filter",
                                        "title": "Fortinet - FortiGate - Add Entry to Web Filter",
                                        "type": "workflow.atomic_workflow",
                                        "base_type": "subworkflow",
                                        "properties": {
                                          "continue_on_failure": true,
                                          "display_name": "Fortinet - FortiGate - Add Entry to Web Filter",
                                          "input": {
                                            "variable_workflow_01QDU1FYPFRCK220HdGrQT5E8q5rHtzPQn2": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QVNBNH9JTYK3NfHWwhAzXMl4rzC8QLGvm$",
                                            "variable_workflow_01QDU3BHG0FYX1YM6UUwzdhIYZFTDSLi8At": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QENLZHPIVVI28kd2INwi2zuZncQeryxQr$",
                                            "variable_workflow_01QDUQU3ZBY9N7jboIgNoKcZdgUAQi1BtCD": "$activity.definition_activity_01QZM9AV6ZLA01eBcuPkP0dGeQLQqFOeafS.output.variable_workflow_01QPJN9OQP3VF5AvZlRFEVyXuoNnuHRGrTI$"
                                          },
                                          "runtime_user": {
                                            "target_default": true
                                          },
                                          "skip_execution": false,
                                          "target": {
                                            "use_workflow_target_group": true
                                          },
                                          "workflow_id": "definition_workflow_01QDU1FYX531C0rakrXzq8h6BHdjcTDqqu6"
                                        },
                                        "object_type": "definition_activity"
                                      },
                                      {
                                        "unique_name": "definition_activity_01RHZJVIZ46K27NpAS97mSK9jPtmVpqxzAO",
                                        "name": "Condition Block",
                                        "title": "Critical Error Occurred?",
                                        "type": "logic.if_else",
                                        "base_type": "activity",
                                        "properties": {
                                          "continue_on_failure": false,
                                          "display_name": "Critical Error Occurred?",
                                          "skip_execution": false
                                        },
                                        "object_type": "definition_activity",
                                        "blocks": [
                                          {
                                            "unique_name": "definition_activity_01RHZJVMJ4I9C01eztKVym0Y0gQRy5pjjqP",
                                            "name": "Condition Branch",
                                            "title": "Yes",
                                            "type": "logic.condition_block",
                                            "base_type": "activity",
                                            "properties": {
                                              "condition": {
                                                "left_operand": "$activity.definition_activity_01QXHGUDKGHUO1qYFB6ijbv97rqNEqV71FL.output.succeeded$",
                                                "operator": "eq",
                                                "right_operand": false
                                              },
                                              "continue_on_failure": false,
                                              "display_name": "Yes",
                                              "skip_execution": false
                                            },
                                            "object_type": "definition_activity",
                                            "actions": [
                                              {
                                                "unique_name": "definition_activity_01RHZJVNG6H270T4fHnblpre7W4TGRtJb4E",
                                                "name": "Microsoft Teams - Post Message via Webhook",
                                                "title": "Microsoft Teams - Post Message via Webhook",
                                                "type": "workflow.atomic_workflow",
                                                "base_type": "subworkflow",
                                                "properties": {
                                                  "continue_on_failure": false,
                                                  "display_name": "Microsoft Teams - Post Message via Webhook",
                                                  "input": {
                                                    "variable_workflow_01MRIK9PFIH9457K2ZY1x7rEJvOPzYOE6eO": "MESSAGE FROM Fortinet - FortiGate - Block URL, IP or Domain",
                                                    "variable_workflow_01MRIKICJKVS16L5nynmibtyxbFIqwxBhOV": "**\"$activity.definition_activity_01SE0N18KSEPS6pqP8aWNNj4jubz9h3jVZm.output.result_string$\" observable handling failed.**\n\u003cbr/\u003e\n$activity.definition_activity_01QXHGUDKGHUO1qYFB6ijbv97rqNEqV71FL.output.error.message$",
                                                    "variable_workflow_01MRIL2TKZ8FM1EvIZeO4VFV9ITFhG3vSlI": ""
                                                  },
                                                  "runtime_user": {
                                                    "target_default": true
                                                  },
                                                  "skip_execution": false,
                                                  "target": {
                                                    "override_workflow_target_group_criteria": true,
                                                    "target_group": {
                                                      "run_on_all_targets": false,
                                                      "use_criteria": {
                                                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                                        "conditions": [
                                                          {
                                                            "left_operand": "$targetgroup.target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH.common.display_name$",
                                                            "operator": "eqi",
                                                            "right_operand": "Microsoft Teams Webhook"
                                                          }
                                                        ]
                                                      }
                                                    }
                                                  },
                                                  "workflow_id": "definition_workflow_01MRIE3B3DNNQ3cdFSoyGkg1RnVsYA9VdZr"
                                                },
                                                "object_type": "definition_activity"
                                              },
                                              {
                                                "unique_name": "definition_activity_01RHZJVTOD2LY1RC3WPzRXyzdvWeiQ9sdNK",
                                                "name": "Completed",
                                                "title": "Failed",
                                                "type": "logic.completed",
                                                "base_type": "activity",
                                                "properties": {
                                                  "completion_type": "failed-completed",
                                                  "continue_on_failure": false,
                                                  "display_name": "Failed",
                                                  "result_message": "\"$activity.definition_activity_01SE0N18KSEPS6pqP8aWNNj4jubz9h3jVZm.output.result_string$\" observable handling failed.\n$activity.definition_activity_01QXHGUDKGHUO1qYFB6ijbv97rqNEqV71FL.output.error.message$",
                                                  "skip_execution": false
                                                },
                                                "object_type": "definition_activity"
                                              }
                                            ]
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "unique_name": "definition_activity_01RHQ456D2SVT4CjPHB2TJTweTfiKIMLs8j",
                            "name": "Condition Branch",
                            "title": "No",
                            "type": "logic.condition_block",
                            "base_type": "activity",
                            "properties": {
                              "condition": {
                                "left_operand": "$activity.definition_activity_01QWIR9KUPHWJ0ZeoGn1hYeCJM8evhCOPLK.output.succeeded$",
                                "operator": "eq",
                                "right_operand": false
                              },
                              "continue_on_failure": false,
                              "display_name": "No",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01RHYLCEBZ40F4YTvfF5m1JC14MkmZCf0Fb",
                                "name": "Microsoft Teams - Post Message via Webhook",
                                "title": "Microsoft Teams - Post Message via Webhook",
                                "type": "workflow.atomic_workflow",
                                "base_type": "subworkflow",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Microsoft Teams - Post Message via Webhook",
                                  "input": {
                                    "variable_workflow_01MRIK9PFIH9457K2ZY1x7rEJvOPzYOE6eO": "MESSAGE FROM Fortinet - FortiGate - Block URL, IP or Domain",
                                    "variable_workflow_01MRIKICJKVS16L5nynmibtyxbFIqwxBhOV": "**\"$activity.definition_activity_01SE0N18KSEPS6pqP8aWNNj4jubz9h3jVZm.output.result_string$\" observable handling failed.**\n\u003cbr/\u003e\n$activity.definition_activity_01QWIR9KUPHWJ0ZeoGn1hYeCJM8evhCOPLK.output.error.message$",
                                    "variable_workflow_01MRIL2TKZ8FM1EvIZeO4VFV9ITFhG3vSlI": ""
                                  },
                                  "runtime_user": {
                                    "target_default": true
                                  },
                                  "skip_execution": false,
                                  "target": {
                                    "override_workflow_target_group_criteria": true,
                                    "target_group": {
                                      "run_on_all_targets": false,
                                      "use_criteria": {
                                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                        "conditions": [
                                          {
                                            "left_operand": "$targetgroup.target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH.common.display_name$",
                                            "operator": "eqi",
                                            "right_operand": "Microsoft Teams Webhook"
                                          }
                                        ]
                                      }
                                    }
                                  },
                                  "workflow_id": "definition_workflow_01MRIE3B3DNNQ3cdFSoyGkg1RnVsYA9VdZr"
                                },
                                "object_type": "definition_activity"
                              },
                              {
                                "unique_name": "definition_activity_01RHYD1TLN3YI1xCHVW2UNumK4MgvyKiddQ",
                                "name": "Completed",
                                "title": "Failed",
                                "type": "logic.completed",
                                "base_type": "activity",
                                "properties": {
                                  "completion_type": "failed-completed",
                                  "continue_on_failure": false,
                                  "display_name": "Failed",
                                  "result_message": "\"$activity.definition_activity_01SE0N18KSEPS6pqP8aWNNj4jubz9h3jVZm.output.result_string$\" observable handling failed.\n \n$activity.definition_activity_01QWIR9KUPHWJ0ZeoGn1hYeCJM8evhCOPLK.output.error.message$",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity"
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "unique_name": "definition_activity_01SDZGEPDYZEB0lmP3qBQ0Rjk5wE5WarjuK",
                    "name": "Condition Branch",
                    "title": "No",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QENLZHPIVVI28kd2INwi2zuZncQeryxQr$",
                        "operator": "eq",
                        "right_operand": ""
                      },
                      "continue_on_failure": false,
                      "display_name": "No",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01SDZWN5O6KNS6394QEW4dGXyi9Y43NBKet",
                        "name": "Microsoft Teams - Post Message via Webhook",
                        "title": "Microsoft Teams - Post Message via Webhook",
                        "type": "workflow.atomic_workflow",
                        "base_type": "subworkflow",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Microsoft Teams - Post Message via Webhook",
                          "input": {
                            "variable_workflow_01MRIK9PFIH9457K2ZY1x7rEJvOPzYOE6eO": "MESSAGE FROM Fortinet - FortiGate - Block URL, IP or Domain",
                            "variable_workflow_01MRIKICJKVS16L5nynmibtyxbFIqwxBhOV": "**\"$activity.definition_activity_01SE0N18KSEPS6pqP8aWNNj4jubz9h3jVZm.output.result_string$\" observable handling failed.**\n\u003cbr/\u003e\nA web filter to add url filter to was not provided. You must configure the workflow with the name of a web filter.",
                            "variable_workflow_01MRIL2TKZ8FM1EvIZeO4VFV9ITFhG3vSlI": ""
                          },
                          "runtime_user": {
                            "target_default": true
                          },
                          "skip_execution": false,
                          "target": {
                            "override_workflow_target_group_criteria": true,
                            "target_group": {
                              "run_on_all_targets": false,
                              "use_criteria": {
                                "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                "conditions": [
                                  {
                                    "left_operand": "$targetgroup.target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH.common.display_name$",
                                    "operator": "eqi",
                                    "right_operand": "Microsoft Teams Webhook"
                                  }
                                ]
                              }
                            }
                          },
                          "workflow_id": "definition_workflow_01MRIE3B3DNNQ3cdFSoyGkg1RnVsYA9VdZr"
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01SDZWPNWX7CX11hCAxy5IRigN3KWfwbGc7",
                        "name": "Completed",
                        "title": "Failed",
                        "type": "logic.completed",
                        "base_type": "activity",
                        "properties": {
                          "completion_type": "failed-completed",
                          "continue_on_failure": false,
                          "display_name": "Failed",
                          "result_message": "\"$activity.definition_activity_01SE0N18KSEPS6pqP8aWNNj4jubz9h3jVZm.output.result_string$\" observable handling failed.\n \nA web filter to add url filter to was not provided. You must configure the workflow with the name of a web filter.",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01QYE7616RGZY1VsDZhccONoTGbEOhoLYd4",
                "name": "Set Variables",
                "title": "Clear extra inputs if present",
                "type": "core.set_multiple_variables",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "description": "Clear Address Group if it was set as it not needed",
                  "display_name": "Clear extra inputs if present",
                  "skip_execution": false,
                  "variables_to_update": [
                    {
                      "variable_to_update": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QENMB1Z1RQH358zoMEikzjGBvYRvrdvlA$",
                      "variable_value_new": ""
                    }
                  ]
                },
                "object_type": "definition_activity"
              }
            ]
          },
          {
            "unique_name": "definition_activity_01QWI5VPNMUJW108a33gEJz8JDNDV9ltm0K",
            "name": "Condition Branch",
            "title": "Anything Else",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": {
                  "left_operand": {
                    "left_operand": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWPO1WE3738QmwiLwBJbXce3agNJ7Kk$",
                    "operator": "ne",
                    "right_operand": "ip"
                  },
                  "operator": "and",
                  "right_operand": {
                    "left_operand": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWPO1WE3738QmwiLwBJbXce3agNJ7Kk$",
                    "operator": "ne",
                    "right_operand": "domain"
                  }
                },
                "operator": "or",
                "right_operand": {
                  "left_operand": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWPO1WE3738QmwiLwBJbXce3agNJ7Kk$",
                  "operator": "eq",
                  "right_operand": "url"
                }
              },
              "continue_on_failure": false,
              "display_name": "Anything Else",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01RHW19TFZ6Z65qLxohRX3VLxoznwpEZRZx",
                "name": "Microsoft Teams - Post Message via Webhook",
                "title": "Microsoft Teams - Post Message via Webhook",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Microsoft Teams - Post Message via Webhook",
                  "input": {
                    "variable_workflow_01MRIK9PFIH9457K2ZY1x7rEJvOPzYOE6eO": "MESSAGE FROM Fortinet - FortiGate - Block URL, IP or Domain",
                    "variable_workflow_01MRIKICJKVS16L5nynmibtyxbFIqwxBhOV": "**\"$activity.definition_activity_01SE0N18KSEPS6pqP8aWNNj4jubz9h3jVZm.output.result_string$\" observable handling failed.**\n\u003cbr/\u003e\nThe observable_type \"$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWPO1WE3738QmwiLwBJbXce3agNJ7Kk$\" is not supported by this workflow.",
                    "variable_workflow_01MRIL2TKZ8FM1EvIZeO4VFV9ITFhG3vSlI": ""
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "override_workflow_target_group_criteria": true,
                    "target_group": {
                      "run_on_all_targets": false,
                      "use_criteria": {
                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                        "conditions": [
                          {
                            "left_operand": "$targetgroup.target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH.common.display_name$",
                            "operator": "eqi",
                            "right_operand": "Microsoft Teams Webhook"
                          }
                        ]
                      }
                    }
                  },
                  "workflow_id": "definition_workflow_01MRIE3B3DNNQ3cdFSoyGkg1RnVsYA9VdZr"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01QWIIX8P941C4J5Xibf1d0MkXo5UImzdBz",
                "name": "Completed",
                "title": "Failed",
                "type": "logic.completed",
                "base_type": "activity",
                "properties": {
                  "completion_type": "failed-completed",
                  "continue_on_failure": false,
                  "display_name": "Failed",
                  "result_message": " \"$activity.01SDAA1AR7FKH6hyNdmjKPHWsCJFT1hozLz.output.script_queries.observable_value$\" observable handling failed.\n \nThis observable_type  $workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWPO1WE3738QmwiLwBJbXce3agNJ7Kk$ is not supported by this workflow.",
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_01QYE8SSQ2M3K4OcaSjkO4WDxih52IlGdQz",
        "name": "Execute Python Script",
        "title": "Define Policy Action",
        "type": "python3.script",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "continue_on_failure": false,
          "display_name": "Define Policy Action",
          "script": "from sys import argv\nobservable_type = argv[1]\naction = \"deny\"\nif observable_type == \"url\":\n   action = \"accept\"\n",
          "script_arguments": [
            "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWPO1WE3738QmwiLwBJbXce3agNJ7Kk$"
          ],
          "script_queries": [
            {
              "script_query": "action",
              "script_query_name": "Action",
              "script_query_type": "string"
            }
          ],
          "skip_execution": false
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_01QXHTNT61F0A5WCqSPHjDsKbfuiX1WenlJ",
        "name": "Fortinet - FortiGate - Search for Policy by Name",
        "title": "Fortinet - FortiGate - Search for Policy by Name",
        "type": "workflow.atomic_workflow",
        "base_type": "subworkflow",
        "properties": {
          "continue_on_failure": true,
          "display_name": "Fortinet - FortiGate - Search for Policy by Name",
          "input": {
            "variable_workflow_01QIUK02DI1IF4L5JSfJ1dW6v53vUb5sKrd": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QVNBNH9JTYK3NfHWwhAzXMl4rzC8QLGvm$",
            "variable_workflow_01QIUK02DI2PR41Jf3FNKjTlsvabn7pRwAJ": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QXHR8UGUKKV3PzLWDz5cd9wfGxZ0M0WBc$",
            "variable_workflow_01QZ7S20AIWUG4syV8kHuL1uInjCRVDLDJs": "root"
          },
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "use_workflow_target_group": true
          },
          "workflow_id": "definition_workflow_01QIUK02LX1IV6JwzN4GYkZHhcTIw3RRTzf"
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_01QXHU2KX5ZBA6zhgKIkyPjsRilD3A7D5Xv",
        "name": "Condition Block",
        "title": "Policy Name found?",
        "type": "logic.if_else",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Policy Name found?",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "blocks": [
          {
            "unique_name": "definition_activity_01QXHU2RE0NWY7ffYrem1923BGy0UOcZpkm",
            "name": "Condition Branch",
            "title": "Yes",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$activity.definition_activity_01QXHTNT61F0A5WCqSPHjDsKbfuiX1WenlJ.output.succeeded$",
                "operator": "eq",
                "right_operand": true
              },
              "continue_on_failure": false,
              "display_name": "Yes",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01QXHTIHWWDL40UqaZ9D05Hdb9KzR7V7FaA",
                "name": "Fortinet - FortiGate - Update Firewall Policy",
                "title": "Fortinet - FortiGate - Update Firewall Policy",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": true,
                  "display_name": "Fortinet - FortiGate - Update Firewall Policy",
                  "input": {
                    "variable_workflow_01QNX6UNA0R2440XMUMiAAL1zqP9YwBrOUC": "$activity.definition_activity_01QXHTNT61F0A5WCqSPHjDsKbfuiX1WenlJ.output.variable_workflow_01QIUK02DI7JL4sgSk2xE8cVHVvCv30Hgas$",
                    "variable_workflow_01QNX6UNA0WA022tb2ooU9vbzpN6TovSCiC": "$activity.definition_activity_01QXHTNT61F0A5WCqSPHjDsKbfuiX1WenlJ.output.variable_workflow_01QIUK02DHUFV5m3AAJ9VSfPBXcC36ZMSTB$",
                    "variable_workflow_01QNX6UNA0ZY73OjTb7JSXIDO1uivd13tDq": "",
                    "variable_workflow_01QNX6UNA15056jt8u1hL24BzMRo5ZSzL25": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QVNBNH9JTYK3NfHWwhAzXMl4rzC8QLGvm$",
                    "variable_workflow_01QNX6UNA16KB5NHApxJFEu93dlrxEdD7DK": "root",
                    "variable_workflow_01QNZNYDZ0G953p4PSo6QbYK3xG0Mhhoymi": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QENMB1Z1RQH358zoMEikzjGBvYRvrdvlA$",
                    "variable_workflow_01QNZPXCL0G923vude6JTUJukZjKxAnKpRB": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QENLZHPIVVI28kd2INwi2zuZncQeryxQr$",
                    "variable_workflow_01SC5UIX4394S0BFx3u5HrikFwZD76XlD9t": "",
                    "variable_workflow_01SCGJL7SAVBC2MbaQ50VOUIDZMQYw9t76n": "$activity.definition_activity_01QYE8SSQ2M3K4OcaSjkO4WDxih52IlGdQz.output.script_queries.Action$"
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "use_workflow_target_group": true
                  },
                  "workflow_id": "definition_workflow_01QNX6UNITCLT5hFo0PqHo1Ajkua15WaSmO"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01RHWB6TEOH2N6jsJFjjv6zUL6epYlktdgw",
                "name": "Condition Block",
                "title": "Critical Error Occurred?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Critical Error Occurred?",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01RHWB6X72SYM28PcD2AKPcnju9sMUegA70",
                    "name": "Condition Branch",
                    "title": "No",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01QXHTIHWWDL40UqaZ9D05Hdb9KzR7V7FaA.output.succeeded$",
                        "operator": "eq",
                        "right_operand": false
                      },
                      "continue_on_failure": false,
                      "display_name": "No",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01RHWDE3W3SGA3LKj9HLiIAugUBujmdaHXI",
                        "name": "Microsoft Teams - Post Message via Webhook",
                        "title": "Microsoft Teams - Post Message via Webhook",
                        "type": "workflow.atomic_workflow",
                        "base_type": "subworkflow",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Microsoft Teams - Post Message via Webhook",
                          "input": {
                            "variable_workflow_01MRIK9PFIH9457K2ZY1x7rEJvOPzYOE6eO": "MESSAGE FROM Fortinet - FortiGate - Block URL, IP or Domain",
                            "variable_workflow_01MRIKICJKVS16L5nynmibtyxbFIqwxBhOV": "**\"$activity.definition_activity_01SE0N18KSEPS6pqP8aWNNj4jubz9h3jVZm.output.result_string$\" observable handling failed.**\n\u003cbr/\u003e\n$activity.definition_activity_01QXHTIHWWDL40UqaZ9D05Hdb9KzR7V7FaA.output.error.message$",
                            "variable_workflow_01MRIL2TKZ8FM1EvIZeO4VFV9ITFhG3vSlI": ""
                          },
                          "runtime_user": {
                            "target_default": true
                          },
                          "skip_execution": false,
                          "target": {
                            "override_workflow_target_group_criteria": true,
                            "target_group": {
                              "run_on_all_targets": false,
                              "use_criteria": {
                                "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                "conditions": [
                                  {
                                    "left_operand": "$targetgroup.target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH.common.display_name$",
                                    "operator": "eqi",
                                    "right_operand": "Microsoft Teams Webhook"
                                  }
                                ]
                              }
                            }
                          },
                          "workflow_id": "definition_workflow_01MRIE3B3DNNQ3cdFSoyGkg1RnVsYA9VdZr"
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01RHWFNRDQAJP7Rq8A0yeRaP2WDvKB67Gqw",
                        "name": "Completed",
                        "title": "Failed",
                        "type": "logic.completed",
                        "base_type": "activity",
                        "properties": {
                          "completion_type": "failed-completed",
                          "continue_on_failure": false,
                          "display_name": "Failed",
                          "result_message": "\"$activity.definition_activity_01SE0N18KSEPS6pqP8aWNNj4jubz9h3jVZm.output.result_string$\" observable handling failed.\n$activity.definition_activity_01QXHTIHWWDL40UqaZ9D05Hdb9KzR7V7FaA.output.error.message$",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              }
            ]
          },
          {
            "unique_name": "definition_activity_01RHUY007S6VH5IUz6MrOkPcChdUtTJiZLA",
            "name": "Condition Branch",
            "title": "No",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$activity.definition_activity_01QXHTNT61F0A5WCqSPHjDsKbfuiX1WenlJ.output.succeeded$",
                "operator": "eq",
                "right_operand": false
              },
              "continue_on_failure": false,
              "display_name": "No",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01RICTHEGNTA651ooZK7oaxlw03Qs51CuMD",
                "name": "Microsoft Teams - Post Message via Webhook",
                "title": "Microsoft Teams - Post Message via Webhook",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Microsoft Teams - Post Message via Webhook",
                  "input": {
                    "variable_workflow_01MRIK9PFIH9457K2ZY1x7rEJvOPzYOE6eO": "MESSAGE FROM Fortinet - FortiGate - Block URL, IP or Domain",
                    "variable_workflow_01MRIKICJKVS16L5nynmibtyxbFIqwxBhOV": "**\"$activity.definition_activity_01SE0N18KSEPS6pqP8aWNNj4jubz9h3jVZm.output.result_string$\" observable handling failed.**\n\u003cbr/\u003e\n$activity.definition_activity_01QXHTNT61F0A5WCqSPHjDsKbfuiX1WenlJ.output.error.message$",
                    "variable_workflow_01MRIL2TKZ8FM1EvIZeO4VFV9ITFhG3vSlI": ""
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "override_workflow_target_group_criteria": true,
                    "target_group": {
                      "run_on_all_targets": false,
                      "use_criteria": {
                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                        "conditions": [
                          {
                            "left_operand": "$targetgroup.target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH.common.display_name$",
                            "operator": "eqi",
                            "right_operand": "Microsoft Teams Webhook"
                          }
                        ]
                      }
                    }
                  },
                  "workflow_id": "definition_workflow_01MRIE3B3DNNQ3cdFSoyGkg1RnVsYA9VdZr"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01RICTHL15VEX17zkceVhIBX5FeVKBraizn",
                "name": "Completed",
                "title": "Failed",
                "type": "logic.completed",
                "base_type": "activity",
                "properties": {
                  "completion_type": "failed-completed",
                  "continue_on_failure": false,
                  "display_name": "Failed",
                  "result_message": "\"$activity.definition_activity_01SE0N18KSEPS6pqP8aWNNj4jubz9h3jVZm.output.result_string$\" observable handling failed.\n \n$activity.definition_activity_01QXHTNT61F0A5WCqSPHjDsKbfuiX1WenlJ.output.error.message$",
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_01RQZ9810JZ6E4ani1c6ILDi23iH7iuiG9f",
        "name": "Fortinet - FortiGate - Move Policy on Top of the Policies List",
        "title": "Fortinet - FortiGate - Move Policy on Top of the Policies List",
        "type": "workflow.atomic_workflow",
        "base_type": "subworkflow",
        "properties": {
          "continue_on_failure": true,
          "display_name": "Fortinet - FortiGate - Move Policy on Top of the Policies List",
          "input": {
            "variable_workflow_01RL0ZYDSSTEA1H5YdUxbC5WZf3PGU31zBk": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QXHR8UGUKKV3PzLWDz5cd9wfGxZ0M0WBc$",
            "variable_workflow_01RL0ZYDST2F13RUNFmIaNqBBtT4MtsXvlX": "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QVNBNH9JTYK3NfHWwhAzXMl4rzC8QLGvm$",
            "variable_workflow_01RL0ZYDST3YY33jZNgUsLBKnkFoRa7Vgcs": "root"
          },
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "use_workflow_target_group": true
          },
          "workflow_id": "definition_workflow_01RL0ZYE7UHXO0nAMEa55KHOiiLLvVzSQwX"
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_01RQZBGJDELEO7KQSv8NcaPr60gWqAPN50k",
        "name": "Condition Block",
        "title": "Critical Error Occurred?",
        "type": "logic.if_else",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Critical Error Occurred?",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "blocks": [
          {
            "unique_name": "definition_activity_01RQZBGJDF5YT6CkZbn0ffYd6n43p7zmlEi",
            "name": "Condition Branch",
            "title": "Yes",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$activity.definition_activity_01RQZ9810JZ6E4ani1c6ILDi23iH7iuiG9f.output.succeeded$",
                "operator": "eq",
                "right_operand": false
              },
              "continue_on_failure": false,
              "display_name": "Yes",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01RQZBGJDIQQZ5lzNcBtt3myJdQyTr4U1cW",
                "name": "Microsoft Teams - Post Message via Webhook",
                "title": "Microsoft Teams - Post Message via Webhook",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Microsoft Teams - Post Message via Webhook",
                  "input": {
                    "variable_workflow_01MRIK9PFIH9457K2ZY1x7rEJvOPzYOE6eO": "MESSAGE FROM Fortinet - FortiGate - Block URL, IP or Domain",
                    "variable_workflow_01MRIKICJKVS16L5nynmibtyxbFIqwxBhOV": "**\"$activity.definition_activity_01SE0N18KSEPS6pqP8aWNNj4jubz9h3jVZm.output.result_string$\" observable handling failed.**\n\u003cbr/\u003e\n$activity.definition_activity_01RQZ9810JZ6E4ani1c6ILDi23iH7iuiG9f.output.error.message$",
                    "variable_workflow_01MRIL2TKZ8FM1EvIZeO4VFV9ITFhG3vSlI": ""
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "override_workflow_target_group_criteria": true,
                    "target_group": {
                      "run_on_all_targets": false,
                      "use_criteria": {
                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                        "conditions": [
                          {
                            "left_operand": "$targetgroup.target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH.common.display_name$",
                            "operator": "eqi",
                            "right_operand": "Microsoft Teams Webhook"
                          }
                        ]
                      }
                    }
                  },
                  "workflow_id": "definition_workflow_01MRIE3B3DNNQ3cdFSoyGkg1RnVsYA9VdZr"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01RQZBGJDKPCD60Ud1mM8sovTg4grm3z9pS",
                "name": "Completed",
                "title": "Failed",
                "type": "logic.completed",
                "base_type": "activity",
                "properties": {
                  "completion_type": "failed-completed",
                  "continue_on_failure": false,
                  "display_name": "Failed",
                  "result_message": "\"$activity.01SDAA1AR7FKH6hyNdmjKPHWsCJFT1hozLz.output.script_queries.observable_value$\" observable handling failed.\n \n$activity.definition_activity_01RQZ9810JZ6E4ani1c6ILDi23iH7iuiG9f.output.error.message$",
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_01QYED09JUF4607UQWwkS6Sr9Z42wQk3eSy",
        "name": "Execute Python Script",
        "title": "Create Message",
        "type": "python3.script",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "continue_on_failure": false,
          "display_name": "Create Message",
          "script": "import sys\nimport json\nobservable_type = sys.argv[1]\nobservable_value = sys.argv[6]\nresult_message = None\ntitle = ''\nif observable_type == \"domain\":\n    title = f'## {observable_type.capitalize()} \"{observable_value}\" handled successfully.'\nelse:\n    title = f'## {observable_type.upper()} \"{observable_value}\" handled successfully.'\nentities = [(\"Policy Name\", sys.argv[5])]\nif observable_type == \"url\":\n    entities.append(\n        (\"Web Filter Name\", sys.argv[4])\n    )\nelse:\n    entities += [(\"Address Name\", sys.argv[2]), (\"Address Group Name\", sys.argv[3])]\nsuccess_message = [title]\nfor entity in entities:\n        success_message.append(\n        f\"**{entity[0]}:** {entity[1]}\"\n        )\nresult_message = '\\n\\n'.join(success_message)",
          "script_arguments": [
            "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.input.variable_workflow_01QDUWPO1WE3738QmwiLwBJbXce3agNJ7Kk$",
            "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QXEW7YBXKOA67nOxzUyeafXXO7sWUTTyr$",
            "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QENMB1Z1RQH358zoMEikzjGBvYRvrdvlA$",
            "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QENLZHPIVVI28kd2INwi2zuZncQeryxQr$",
            "$workflow.definition_workflow_01QDUJPTX5MFZ4xHLGKnkEw8EzTffvFPy7W.local.variable_workflow_01QXHR8UGUKKV3PzLWDz5cd9wfGxZ0M0WBc$",
            "$activity.definition_activity_01SE0N18KSEPS6pqP8aWNNj4jubz9h3jVZm.output.result_string$"
          ],
          "script_queries": [
            {
              "script_query": "result_message",
              "script_query_name": "Result  Message",
              "script_query_type": "string"
            }
          ],
          "skip_execution": false
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_01QZLP0NPIBNF4hqpFbSW9ThQ99eStbUnHU",
        "name": "Microsoft Teams - Post Message via Webhook",
        "title": "Microsoft Teams - Post Message via Webhook",
        "type": "workflow.atomic_workflow",
        "base_type": "subworkflow",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Microsoft Teams - Post Message via Webhook",
          "input": {
            "variable_workflow_01MRIK9PFIH9457K2ZY1x7rEJvOPzYOE6eO": "MESSAGE FROM Fortinet - FortiGate - Block URL, IP or Domain",
            "variable_workflow_01MRIKICJKVS16L5nynmibtyxbFIqwxBhOV": "$activity.definition_activity_01QYED09JUF4607UQWwkS6Sr9Z42wQk3eSy.output.script_queries.Result  Message$",
            "variable_workflow_01MRIL2TKZ8FM1EvIZeO4VFV9ITFhG3vSlI": ""
          },
          "runtime_user": {
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "override_workflow_target_group_criteria": true,
            "target_group": {
              "run_on_all_targets": false,
              "use_criteria": {
                "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                "conditions": [
                  {
                    "left_operand": "$targetgroup.target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH.common.display_name$",
                    "operator": "eqi",
                    "right_operand": "Microsoft Teams Webhook"
                  }
                ]
              }
            }
          },
          "workflow_id": "definition_workflow_01MRIE3B3DNNQ3cdFSoyGkg1RnVsYA9VdZr"
        },
        "object_type": "definition_activity"
      }
    ],
    "categories": [
      "category_01FM7CGPZZCMY0KcvgiGjVH5UaB4y4aDJ7m",
      "category_01QKFKSJE1EJI1NoiNr1VfmBDywTaAMKWSH"
    ]
  },
  "categories": {
    "category_01FM7CGPZZCMY0KcvgiGjVH5UaB4y4aDJ7m": {
      "unique_name": "category_01FM7CGPZZCMY0KcvgiGjVH5UaB4y4aDJ7m",
      "name": "response",
      "title": "response",
      "type": "basic.category",
      "base_type": "category",
      "category_type": "custom",
      "object_type": "category"
    },
    "category_01QKFKSJE1EJI1NoiNr1VfmBDywTaAMKWSH": {
      "unique_name": "category_01QKFKSJE1EJI1NoiNr1VfmBDywTaAMKWSH",
      "name": "FortiGate",
      "title": "FortiGate",
      "type": "basic.category",
      "base_type": "category",
      "category_type": "custom",
      "object_type": "category"
    }
  },
  "target_groups": {
    "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH": {
      "unique_name": "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH",
      "name": "Default TargetGroup",
      "title": "Default TargetGroup",
      "type": "generic.target_group",
      "base_type": "target_group",
      "version": "1.0.0",
      "targets": [
        {
          "data_target_type": "web-service.endpoint",
          "view_target_type": "web-service.endpoint",
          "include_all_targets": true
        },
        {
          "data_target_type": "email.smtp_endpoint",
          "view_target_type": "email.smtp_endpoint",
          "include_all_targets": true
        }
      ],
      "object_type": "target_group"
    }
  },
  "atomic_workflows": [
    "definition_workflow_01MRIE3B3DNNQ3cdFSoyGkg1RnVsYA9VdZr",
    "definition_workflow_01Q2H2423CNMQ55zxmxIlndVdm1FyYI9WvB",
    "definition_workflow_01QIUK02LX1IV6JwzN4GYkZHhcTIw3RRTzf",
    "definition_workflow_01RL0ZYE7UHXO0nAMEa55KHOiiLLvVzSQwX",
    "definition_workflow_01QNX6UNITCLT5hFo0PqHo1Ajkua15WaSmO",
    "definition_workflow_01QTSQI5IY61E0eT05l4mbwyexR2rwtaSYl",
    "definition_workflow_01QKJSE0LURMP1XIO79isiyUAXKTDDZeCGV",
    "definition_workflow_01QDU1FYX531C0rakrXzq8h6BHdjcTDqqu6",
    "definition_workflow_01QPJN9P092ZK4B1nv7D0yaTHqYWenXdVIb",
    "definition_workflow_01QTTUMDSUU0L6hykgyzvov9DIbC8YZyISv",
    "definition_workflow_01QJMY7EFE9EB0dUuvozT00neDnloTNQN05"
  ]
}